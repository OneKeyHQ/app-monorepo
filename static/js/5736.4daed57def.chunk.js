"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[5736],{605736:(e,t,n)=>{n.r(t),n.d(t,{default:()=>BatchCreateAccountForm});var r=n(586330),a=n(514041),o=n(908867),s=n(490343),l=n(610421),i=n(325809),c=n(498356),u=n(162616),d=n(625931),f=n(334439),m=n(392097),g=n(553083),h=n(584186),w=n(714191),v=n(15159),p=n(98807),b=n(107442),A=n(831085);function BatchCreateAccountFormPage({walletId:e,networkId:t}){var n,{activeAccount:i}=(0,u.LH)({num:0}),w=(0,c.A)(),y=(0,o.A)(),C=(0,a.useRef)(void 0),k=(0,a.useCallback)((n=(0,r.A)((function*({replace:t}){var n=C?.current?.getValues();n&&w[t?"replace":"push"](m.v3.BatchCreateAccountPreview,{walletId:e,networkId:n.networkId})})),function(e){return n.apply(this,arguments)}),[w,e]),x=(0,a.useRef)(!1);return(0,A.jsxs)(s.Page,{scrollEnabled:!0,safeAreaEnabled:!0,children:[(0,A.jsx)(s.Page.Header,{title:y.formatMessage({id:f.ETranslations.global_bulk_add_accounts})}),(0,A.jsxs)(s.Page.Body,{p:"$4",children:[(0,A.jsx)(p.N,{alwaysShowAdvancedSettings:!0,defaultNetworkId:t||(0,d.V)().onekeyall,defaultDeriveType:void 0,defaultFrom:"1",defaultCount:String(p.Bc),onNetworkChanged:function({isAllNetwork:e}){e||k({replace:!0})},formRef:C}),null]}),(0,A.jsx)(s.Page.Footer,{confirmButtonProps:{disabled:!1},onConfirm:(0,r.A)((function*(){try{var t;if(x.current)return;if(x.current=!0,Object.keys(null!=(t=C?.current?.formState?.errors)?t:{}).length)return void(x.current=!1);yield C.current?.handleSubmit((n=(0,r.A)((function*(t){var n=t?.networkId;if(g.Ay.isAllNetwork({networkId:n})){var r,a;yield l.A.servicePassword.promptPasswordVerifyByWallet({walletId:e,reason:v.a.CreateOrRemoveWallet});var o=null!=(r=t?.from)?r:"1",s=null!=(a=t?.count)?a:String(p.Bc),i=parseInt(o,10),c=parseInt(s,10),u=i-1,d=u+c-1;(0,b.g)({navigation:w,allNetworkInfo:{count:c}}),yield h.A.wait(600),yield l.A.serviceBatchCreateAccount.startBatchCreateAccountsFlowForAllNetwork({walletId:e,fromIndex:u,toIndex:d,excludedIndexes:{},saveToDb:!0,hideCheckingDeviceLoading:!0})}else yield k({replace:!1})})),function(e){return n.apply(this,arguments)}))()}finally{x.current=!1}var n}))})]})}function BatchCreateAccountForm({route:e}){var t,{walletId:n,networkId:r}=null!=(t=e.params)?t:{};return(0,A.jsx)(i.b8,{enabledNum:[0],config:{sceneName:w.Zs.home,sceneUrl:""},children:(0,A.jsx)(BatchCreateAccountFormPage,{walletId:n,networkId:r})})}},98807:(e,t,n)=>{n.d(t,{Bc:()=>u,N:()=>BatchCreateAccountFormBase});var r=n(514041),a=n(241440),o=n(908867),s=n(490343),l=n(334439),i=n(553083),c=n(831085),u=15,d=100,f=2**31,m=f+1-15;function AdvancedSettingsFormField({form:e,isAllNetwork:t,alwaysShowAdvancedSettings:n}){var i=(0,o.A)(),u=(0,s.useMedia)(),[d,f]=(0,r.useState)(!n),g=(0,r.useCallback)((function(){f((function(e){return!e}))}),[]),h=e.watch("from"),w=e.watch("count"),v=e.formState.errors.from,p=(0,r.useMemo)((function(){if(!h||!w)return"";var e=parseInt(h,10),t=e+parseInt(w,10)-1;return`${i.formatMessage({id:l.ETranslations.global_serial_number_start_desc},{from:e,to:t})}`}),[w,h,i]);return(0,c.jsxs)(s.Stack,{children:[n?null:(0,c.jsxs)(s.XStack,{gap:"$3",py:"$2",ai:"center",onPress:g,children:[(0,c.jsx)(s.Stack,{children:(0,c.jsx)(s.SizableText,{size:"$bodyMdMedium",color:"$textSubdued",children:i.formatMessage({id:l.ETranslations.global_advantage_settings})})}),(0,c.jsx)(s.IconButton,{icon:d?"ChevronDownSmallOutline":"ChevronTopSmallOutline",variant:"tertiary",onPress:g})]}),(0,c.jsx)(s.Stack,{width:d?0:void 0,height:d?0:void 0,opacity:d?0:void 0,overflow:d?"hidden":void 0,children:(0,c.jsx)(s.Stack,{mt:n?void 0:"$4",children:(0,c.jsxs)(s.Form.Field,{label:i.formatMessage({id:l.ETranslations.global_serial_number_start}),name:"from",rules:{required:!0,validate:function(e){var t=new a.A(e);return!e||t.isNaN()?i.formatMessage({id:l.ETranslations.global_bulk_accounts_page_number_error}):!t.isLessThan(1)||"The minimum number of accounts is 1"},onChange:function(t){var n=(t?.target?.value||"").replace(/\D/g,""),r=new a.A(parseInt(n,10));n&&!r.isNaN()?r.isLessThan(1)?e.setValue("from","1"):r.isGreaterThanOrEqualTo(m)?e.setValue("from",m.toString()):e.setValue("from",r.toFixed()):e.setValue("from","")}},children:[(0,c.jsx)(s.Input,{secureTextEntry:!1,placeholder:i.formatMessage({id:l.ETranslations.global_serial_number_start}),size:u.gtMd?"medium":"large"}),v?null:(0,c.jsx)(s.Form.FieldDescription,{children:p})]})})})]})}function BatchCreateAccountFormBase({alwaysShowAdvancedSettings:e,networkReadyOnly:t,defaultCount:n,defaultDeriveType:m,defaultFrom:g,defaultNetworkId:h,onNetworkChanged:w,formRef:v}){var p=(0,o.A)(),b=(0,s.useMedia)(),A=(0,s.useForm)({values:{networkId:h,deriveType:m,from:g,count:n},mode:"onChange",reValidateMode:"onChange"});v&&(v.current=A);var y=A.watch("networkId"),C=(0,r.useMemo)((function(){return i.Ay.isAllNetwork({networkId:y})}),[y]);return(0,r.useEffect)((function(){w?.({networkId:y,isAllNetwork:C})}),[C,y,w]),(0,c.jsxs)(s.Form,{form:A,children:[(0,c.jsx)(s.Form.Field,{label:p.formatMessage({id:l.ETranslations.global_generate_amount}),name:"count",rules:{required:!0,validate:function(e,t){var n=new a.A(e);if(!e||n.isNaN())return p.formatMessage({id:l.ETranslations.global_bulk_accounts_page_number_error});var r=C?u:d;if(t.from){var o=new a.A(t.from);if(!o.isNaN()){var s=f+1-o.toNumber();r=Math.min(r,s)}}return n.isGreaterThan(r)?p.formatMessage({id:l.ETranslations.global_generate_amount_information},{max:r}):!n.isLessThan(1)||"The minimum number of accounts is 1"},onChange:function(e){var t=(e?.target?.value||"").replace(/\D/g,""),n=new a.A(parseInt(t,10));t&&!n.isNaN()?n.isLessThan(1)?A.setValue("count","1"):A.setValue("count",n.toFixed()):A.setValue("count","")}},children:(0,c.jsx)(s.Input,{secureTextEntry:!1,testID:"account-generate-amount-input",placeholder:p.formatMessage({id:l.ETranslations.global_generate_amount}),size:b.gtMd?"medium":"large"})}),(0,c.jsx)(AdvancedSettingsFormField,{form:A,alwaysShowAdvancedSettings:e,isAllNetwork:C})]})}},107442:(e,t,n)=>{n.d(t,{g:()=>showBatchCreateAccountProcessingDialog});var r=n(324586),a=n(839850),o=n(586330),s=n(514041),l=n(908867),i=n(490343),c=n(610421),u=n(318822),d=n(334439),f=(n(663522),n(831085)),m=["navigation","allNetworkInfo"];function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ProcessingDialogContent({navigation:e,allNetworkInfo:t}){var n,r,a,m,g=(0,l.A)(),[h,w]=(0,s.useState)(void 0),v=(0,s.useMemo)((function(){return Boolean(h&&h?.progressCurrent===h?.progressTotal)}),[h]),p=(0,s.useMemo)((function(){return Boolean(h&&!!h?.error)}),[h]),[b,A]=(0,s.useState)(!1);(0,s.useEffect)((function(){var cb=function(e){w(e)};return u.iL.on(u.Tu.BatchCreateAccount,cb),function(){u.iL.off(u.Tu.BatchCreateAccount,cb)}}),[]);var y,C=v||b||p;return(0,f.jsxs)(i.Stack,{children:[(0,f.jsx)(i.Stack,{py:"$2.5",px:"$5",gap:"$5",flex:1,alignItems:"center",justifyContent:"center",children:(0,f.jsxs)(i.Stack,{flex:1,alignItems:"center",justifyContent:"center",alignSelf:"center",w:"100%",maxWidth:"$80",children:[v?(0,f.jsx)(i.Icon,{name:"CheckRadioSolid",size:"$12",color:"$iconSuccess"}):null,!b&&!p||v?null:(0,f.jsx)(i.Icon,{name:"XCircleSolid",size:"$12",color:"$iconCritical"}),C?null:(0,f.jsx)(i.Progress,{mt:"$4",w:"100%",size:"medium",value:Math.ceil((null!=(n=h?.progressCurrent)?n:0)/(null!=(r=h?.progressTotal)?r:1)*100)}),(0,f.jsx)(i.SizableText,{mt:"$5",size:"$bodyLg",textAlign:"center",children:g.formatMessage({id:d.ETranslations.global_bulk_accounts_loading},{amount:null!=(a=h?.progressCurrent)?a:0})}),t?(0,f.jsx)(i.SizableText,{size:"$bodyLg",textAlign:"center",children:g.formatMessage({id:d.ETranslations.global_bulk_accounts_loading_subtitle},{amount:null!=(m=t.count)?m:0})}):null,null]})}),(0,f.jsx)(i.Dialog.Footer,{showCancelButton:!1,showConfirmButton:!0,confirmButtonProps:{variant:C?"primary":"secondary",testID:"process-dialog-confirm-button"},onConfirmText:C?g.formatMessage({id:d.ETranslations.global_done}):g.formatMessage({id:d.ETranslations.global_cancel}),onConfirm:C?(0,o.A)((function*(){b||e?.popStack(),yield c.A.serviceBatchCreateAccount.cancelBatchCreateAccountsFlow()})):(y=(0,o.A)((function*({preventClose:e}){e(),A(!0),yield c.A.serviceBatchCreateAccount.cancelBatchCreateAccountsFlow()})),function(e){return y.apply(this,arguments)})})]})}function showBatchCreateAccountProcessingDialog(e){var{navigation:t,allNetworkInfo:n}=e,o=(0,a.A)(e,m);i.Dialog.show(function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({showExitButton:!1,dismissOnOverlayPress:!1,onCancel(){c.A.serviceBatchCreateAccount.cancelBatchCreateAccountsFlow()},onClose(){c.A.serviceBatchCreateAccount.cancelBatchCreateAccountsFlow()},renderContent:(0,f.jsx)(ProcessingDialogContent,{allNetworkInfo:n,navigation:t})},o))}}}]);