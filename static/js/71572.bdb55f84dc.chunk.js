"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[71572],{326745:(e,n,t)=>{t.d(n,{u:()=>useAppRoute});var a=t(654266);function useAppRoute(){return(0,a.lq)()}},925771:(e,n,t)=>{t.d(n,{$:()=>CalculationListItem,k:()=>CalculationList});var a=t(324586),r=t(839850),i=t(490343),o=t(831085),s=["children"],l=["children"],c=["children"];function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach((function(n){(0,a.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function CalculationList({children:e}){return(0,o.jsx)(i.YStack,{gap:"$4",children:e})}function CalculationListItem(e){var{children:n}=e,t=(0,r.A)(e,s);return(0,o.jsx)(i.XStack,_objectSpread(_objectSpread({animation:"quick",enterStyle:{opacity:0},justifyContent:"space-between",alignItems:"center"},t),{},{children:n}))}CalculationList.Item=CalculationListItem,CalculationListItem.Label=function CalculationListItemLabel(e){var{children:n}=e,t=(0,r.A)(e,l);return(0,o.jsx)(i.SizableText,_objectSpread(_objectSpread({color:"$textSubdued"},t),{},{children:n}))},CalculationListItem.Value=function CalculationListItemValue(e){var{children:n}=e,t=(0,r.A)(e,c);return(0,o.jsx)(i.SizableText,_objectSpread(_objectSpread({size:"$bodyLgMedium"},t),{},{children:n}))}},713989:(e,n,t)=>{t.d(n,{G:()=>StakeShouldUnderstand,a:()=>WithdrawShouldUnderstand});var a=t(908867),r=t(490343),i=t(334439),o=t(831085),ShouldUnderstandListItemListItem=function({title:e,description:n,index:t}){return(0,o.jsxs)(r.YStack,{children:[(0,o.jsxs)(r.XStack,{children:[(0,o.jsx)(r.Stack,{w:"$5",children:(0,o.jsxs)(r.SizableText,{children:[t,"."]})}),(0,o.jsx)(r.Stack,{flex:1,children:(0,o.jsx)(r.SizableText,{children:e})})]}),n?(0,o.jsx)(r.XStack,{pl:"$5",children:(0,o.jsx)(r.SizableText,{children:n})}):null]})},ShouldUnderstand=function({items:e}){return(0,o.jsx)(r.YStack,{flex:1,children:(0,o.jsx)(r.ScrollView,{maxHeight:560,children:(0,o.jsx)(r.YStack,{gap:"$5",children:e.map((function(e,n){return(0,o.jsx)(ShouldUnderstandListItemListItem,{index:n+1,title:e.title,description:e.description},n)}))})})})},createTypography=function(e,n){return n?e:""},StakeShouldUnderstand=function({provider:e,symbol:n,apr:t,updateFrequency:s,receiveSymbol:l,unstakingPeriod:c}){var u=(0,a.A)(),d=[];return d="everstake"===e&&["sol","eth","apt"].includes(n)?[createTypography(u.formatMessage({id:i.ETranslations.earn_earn_up_to_number_per_year},{number:(0,o.jsxs)(r.SizableText,{color:"$textSuccess",children:[t,"%"]})}),t),createTypography(u.formatMessage({id:i.ETranslations.earn_rewards_updated_around_time},{time:(0,o.jsx)(r.SizableText,{color:"$textSuccess",children:s})}),s),createTypography(u.formatMessage({id:i.ETranslations.earn_rewards_automatically_restaked},{automatically:(0,o.jsx)(r.SizableText,{color:"$textSuccess",children:u.formatMessage({id:i.ETranslations.earn_automatically})})}),!0),createTypography(u.formatMessage({id:i.ETranslations.earn_withdrawal_up_to_number_days},{number:c}),c)]:"everstake"===e&&["atom","matic"].includes(n)?[createTypography(u.formatMessage({id:i.ETranslations.earn_earn_up_to_number_per_year},{number:(0,o.jsxs)(r.SizableText,{color:"$textSuccess",children:[t,"%"]})}),{number:t}),createTypography(u.formatMessage({id:i.ETranslations.earn_rewards_updated_around_time},{time:(0,o.jsx)(r.SizableText,{color:"$textSuccess",children:s})}),s),createTypography(u.formatMessage({id:i.ETranslations.earn_rewards_manually_restaked},{manually:(0,o.jsx)(r.SizableText,{color:"$textSuccess",children:u.formatMessage({id:i.ETranslations.earn_manually})})}),!0),createTypography(u.formatMessage({id:i.ETranslations.earn_withdrawal_up_to_number_days},{number:c}),c)]:"lido"===e&&["eth","matic"].includes(n)?[createTypography(u.formatMessage({id:i.ETranslations.earn_earn_up_to_number_per_year},{number:(0,o.jsxs)(r.SizableText,{color:"$textSuccess",children:[t,"%"]})}),t),createTypography(u.formatMessage({id:i.ETranslations.earn_receive_token_trade_anytime},{token:(0,o.jsx)(r.SizableText,{color:"$textSuccess",children:l})}),l),createTypography(u.formatMessage({id:i.ETranslations.earn_rewards_updated_around_time},{time:(0,o.jsx)(r.SizableText,{color:"$textSuccess",children:s})}),s),createTypography(u.formatMessage({id:i.ETranslations.earn_rewards_automatically_restaked},{automatically:(0,o.jsx)(r.SizableText,{color:"$textSuccess",children:u.formatMessage({id:i.ETranslations.earn_automatically})})}),!0),createTypography(u.formatMessage({id:i.ETranslations.earn_withdrawal_up_to_number_days},{number:c}),c)]:"babylon"===e?[u.formatMessage({id:i.ETranslations.earn_stake_through_onekey_earn_points}),u.formatMessage({id:i.ETranslations.earn_check_staking_results_overflow}),createTypography(u.formatMessage({id:i.ETranslations.earn_early_withdraw_stake_unstaking_period},{number:c}),c)]:[createTypography(u.formatMessage({id:i.ETranslations.earn_earn_up_to_number_per_year},{number:(0,o.jsx)(r.SizableText,{color:"$textSuccess",children:null!=t?t:4})}),!0)],(0,o.jsx)(ShouldUnderstand,{items:d.filter((function(e){return!!e})).map((function(e){return{title:e}}))})},WithdrawShouldUnderstand=function({withdrawalPeriod:e}){var n=(0,a.A)();return(0,o.jsx)(ShouldUnderstand,{items:[{title:n.formatMessage({id:i.ETranslations.earn_withdrawal_take_up_to_number_days},{number:e})},{title:n.formatMessage({id:i.ETranslations.earn_claim_assets_after_processing})}]})}},286192:(e,n,t)=>{t.d(n,{BA:()=>EstimateNetworkFee,QL:()=>useShowClaimEstimateGasAlert,fH:()=>calcDaysSpent,sM:()=>useShowStakeEstimateGasAlert});var a=t(514041),r=t(241440),i=t(908867),o=t(490343),s=t(259227),l=t(334439),c=t(925771),u=t(831085),useShowStakeEstimateGasAlert=function(){var e=(0,i.A)(),[{currencyInfo:{symbol:n}}]=(0,s.useSettingsPersistAtom)();return(0,a.useCallback)((function({daysConsumed:t,estFiatValue:a,onConfirm:r}){var i=t?e.formatMessage({id:l.ETranslations.earn_transaction_loss_when_stake},{number:(0,u.jsx)(o.SizableText,{size:"$bodyLgMedium",color:"$textCaution",children:t})}):void 0;o.Dialog.show({title:e.formatMessage({id:l.ETranslations.earn_transaction_loss}),icon:"InfoCircleOutline",description:i,renderContent:(0,u.jsxs)(o.XStack,{children:[(0,u.jsxs)(o.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.global_est_network_fee}),":"]}),(0,u.jsx)(o.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:a})]}),onConfirm:r})}),[e,n])},useShowClaimEstimateGasAlert=function(){var e=(0,i.A)(),[{currencyInfo:{symbol:n}}]=(0,s.useSettingsPersistAtom)();return(0,a.useCallback)((function({claimTokenFiatValue:t,estFiatValue:a,onConfirm:i}){var s=(0,r.A)(t).minus(a).absoluteValue().toFixed(),c=e.formatMessage({id:l.ETranslations.earn_transaction_loss_when_claim},{number:(0,u.jsx)(o.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",color:"$textCaution",formatterOptions:{currency:n},children:s})});o.Dialog.show({title:e.formatMessage({id:l.ETranslations.earn_transaction_loss}),icon:"InfoCircleOutline",description:c,renderContent:(0,u.jsxs)(o.YStack,{children:[(0,u.jsxs)(o.XStack,{children:[(0,u.jsxs)(o.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.global_est_network_fee}),":"]}),(0,u.jsx)(o.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:a})]}),(0,u.jsxs)(o.XStack,{children:[(0,u.jsxs)(o.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.earn_reward_value}),":"]}),(0,u.jsx)(o.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:t})]})]}),onConfirm:i})}),[e,n])},EstimateNetworkFeeListItem=function({estFiatValue:e,onPress:n}){var t=(0,i.A)(),[{currencyInfo:{symbol:a}}]=(0,s.useSettingsPersistAtom)();return Number(e)>0?(0,u.jsxs)(c.$,{onPress:n,children:[(0,u.jsx)(c.$.Label,{children:t.formatMessage({id:l.ETranslations.global_est_network_fee})}),(0,u.jsxs)(o.XStack,{alignItems:"center",cursor:n?"pointer":void 0,mr:n?-6:void 0,children:[(0,u.jsx)(o.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:a},children:e}),n?(0,u.jsx)(o.Icon,{name:"ChevronRightSmallOutline",size:24}):null]})]}):null},calcDaysSpent=function(e,n){var t=(0,r.A)(n).div(e).multipliedBy(365);return t.isNaN()?void 0:Math.ceil(t.toNumber())},EstimateNetworkFee=function({estimateFeeResp:e,onPress:n,isVisible:t}){return e&&t?(0,u.jsx)(EstimateNetworkFeeListItem,{estFiatValue:e.feeFiatValue,onPress:n}):null}},87474:(e,n,t)=>{t.d(n,{A:()=>StakingFormWrapper});var a=t(324586),r=t(839850),i=t(490343),o=t(831085),s=["children"];function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach((function(n){(0,a.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function StakingFormWrapper(e){var{children:n}=e,t=(0,r.A)(e,s);return(0,o.jsx)(i.YStack,_objectSpread(_objectSpread({p:"$5",gap:"$5"},t),{},{children:n}))}},939799:(e,n,t)=>{t.d(n,{A:()=>ValuePriceListItem});var a=t(490343),r=t(831085),ValuePriceListItem=function({amount:e,tokenSymbol:n,fiatSymbol:t,fiatValue:i}){return(0,r.jsxs)(a.XStack,{gap:"$1",maxWidth:"$56",justifyContent:"flex-end",flexWrap:"wrap",children:[(0,r.jsx)(a.XStack,{children:(0,r.jsx)(a.NumberSizeableText,{size:"$bodyLgMedium",formatter:"balance",formatterOptions:{tokenSymbol:n},children:e})}),(0,r.jsx)(a.XStack,{maxWidth:"$56",children:i?(0,r.jsxs)(a.SizableText,{children:["(",(0,r.jsx)(a.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:t},children:i}),")"]}):null})]})}},90393:(e,n,t)=>{t.d(n,{Z:()=>useProviderLabel});var a=t(908867),r=t(334439),useProviderLabel=function(e){var n=(0,a.A)(),t=n.formatMessage({id:r.ETranslations.global_protocol});return"everstake"===e.toLowerCase()?t=n.formatMessage({id:r.ETranslations.earn_validator}):"babylogn"===e.toLowerCase()&&(t=n.formatMessage({id:r.ETranslations.earn_finality_provider})),t}},653913:(e,n,t)=>{t.d(n,{B8:()=>useUniversalStake,D0:()=>useUniversalClaim,Pg:()=>useUniversalWithdraw});var a=t(586330),r=t(514041),i=t(241440),o=t(610421),s=t(927799),l=t(553083),c=t(161024),u=t(286192);function useUniversalStake({networkId:e,accountId:n}){var t,{navigationToSendConfirm:i}=(0,s.E)({accountId:n,networkId:e});return(0,r.useCallback)((t=(0,a.A)((function*({amount:t,symbol:a,term:r,feeRate:s,provider:c,stakingInfo:u,onSuccess:d,onFail:m}){var f,p,b=yield o.A.serviceStaking.buildStakeTransaction({amount:t,networkId:e,accountId:n,symbol:a,term:r,provider:c,feeRate:s}),g=yield o.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:b});l.Ay.isBTCNetwork(e)&&g.fee&&(f=!0,p=!1),yield i({encodedTx:g,stakingInfo:u,onSuccess:d,onFail:m,useFeeInTx:f,feeInfoEditable:p})})),function(e){return t.apply(this,arguments)}),[i,n,e])}function useUniversalWithdraw({networkId:e,accountId:n}){var t,{navigationToSendConfirm:i}=(0,s.E)({accountId:n,networkId:e});return(0,r.useCallback)((t=(0,a.A)((function*({amount:t,symbol:r,provider:s,identity:u,stakingInfo:d,onSuccess:m,onFail:f}){var p,b=yield o.A.serviceStaking.getStakingConfigs({networkId:e,symbol:r,provider:s});if(!b)throw new Error("Staking config not found");if(b?.unstakeWithSignMessage){var g=yield o.A.serviceAccount.getAccount({accountId:n,networkId:e}),{message:y,deadline:k}=yield o.A.serviceStaking.buildLidoEthPermitMessageData({accountId:n,networkId:e,amount:t}),x=yield o.A.serviceDApp.openSignMessageModal({accountId:n,networkId:e,request:{origin:"https://lido.fi/",scope:"ethereum"},unsignedMessage:{type:c.$.TYPED_DATA_V4,message:y,payload:[g.address,y]},walletInternalSign:!0});p=yield o.A.serviceStaking.buildUnstakeTransaction({amount:t,networkId:e,accountId:n,symbol:r,provider:s,signature:x,deadline:k})}else p=yield o.A.serviceStaking.buildUnstakeTransaction({amount:t,identity:u,networkId:e,accountId:n,symbol:r,provider:s});var v,h,_,S=yield o.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:p});l.Ay.isBTCNetwork(e)&&S.fee&&(v=!0,h=!1),yield i({encodedTx:S,stakingInfo:d,signOnly:b?.withdrawSignOnly,useFeeInTx:v,feeInfoEditable:h,onSuccess:(_=(0,a.A)((function*(t){if(b?.withdrawSignOnly){var a=t[0].signedTx.finalizedPsbtHex;a&&u&&(yield o.A.serviceStaking.unstakePush({txId:u,networkId:e,accountId:n,symbol:r,provider:s,unstakeTxHex:a}),m?.(t))}else m?.(t)})),function onSuccess(e){return _.apply(this,arguments)}),onFail:f})})),function(e){return t.apply(this,arguments)}),[n,e,i])}function useUniversalClaim({networkId:e,accountId:n}){var t,{navigationToSendConfirm:c}=(0,s.E)({accountId:n,networkId:e}),d=(0,u.QL)();return(0,r.useCallback)((t=(0,a.A)((function*({identity:t,amount:r,provider:s,symbol:u,stakingInfo:m,onSuccess:f,onFail:p}){var b,g=(b=(0,a.A)((function*(){var a,i,d=yield o.A.serviceStaking.buildClaimTransaction({networkId:e,accountId:n,symbol:u,provider:s,amount:r,identity:t}),b=yield o.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:d});l.Ay.isBTCNetwork(e)&&b.fee&&(a=!0,i=!1),yield c({encodedTx:b,stakingInfo:m,onSuccess:f,onFail:p,useFeeInTx:a,feeInfoEditable:i})})),function continueClaim(){return b.apply(this,arguments)});if(Number(r)>0){var y=yield o.A.serviceStaking.estimateFee({networkId:e,provider:s,symbol:u,action:"claim",amount:r}),k=(0,i.A)(y.token.price).multipliedBy(r);if(k.lt(y.feeFiatValue))return void d({claimTokenFiatValue:k.toFixed(),estFiatValue:y.feeFiatValue,onConfirm:g})}yield g()})),function(e){return t.apply(this,arguments)}),[c,n,e,d])}},671572:(e,n,t)=>{t.r(n),t.d(n,{default:()=>pages_ApproveBaseStake});var a=t(586330),r=t(514041),i=t(908867),o=t(490343),s=t(610421),l=t(498356),c=t(326745),u=t(911998),d=t(334439),m=t(948675),f=t(550082),p=t(241440),b=t(88803),g=t(927799),y=t(259227),k=t(584186),x=t(369387);function useTrackTokenAllowance({networkId:e,accountId:n,initialValue:t,tokenAddress:i,spenderAddress:o}){var[l,c]=(0,r.useState)(t),[u,d]=(0,r.useState)(""),[m,f]=(0,r.useState)(),p=function useTxTrack({trackTxId:e,accountId:n,networkId:t,timeout:i=k.A.getTimeDurationMs({minute:60}),interval:o=k.A.getTimeDurationMs({seconds:30})}){var[l,c]=(0,r.useState)(null),u=(0,r.useRef)();return(0,r.useEffect)((function(){if(e){var r,l=Date.now(),d=(r=(0,a.A)((function*(e){var a=yield s.A.serviceHistory.fetchTxDetails({networkId:t,accountId:n,txid:e});a&&a.data&&a.data.status!==x.uU.Pending?c(a):Date.now()-l<i?u.current=setTimeout((function(){return d(e)}),o):c(null)})),function checkTxDetails(e){return r.apply(this,arguments)});return u.current=setTimeout((function(){return d(e)}),0),function(){return clearTimeout(u.current)}}}),[e,t,n,i,o]),l}({accountId:n,networkId:e,trackTxId:u});return(0,r.useEffect)((function(){function _fetchAllowance(){return(_fetchAllowance=(0,a.A)((function*(){if(p)try{var t=yield s.A.serviceStaking.fetchTokenAllowance({networkId:e,accountId:n,tokenAddress:i,spenderAddress:o});t&&c(t.allowanceParsed)}finally{f(!1)}else f(!1)}))).apply(this,arguments)}!function fetchAllowance(){return _fetchAllowance.apply(this,arguments)}()}),[p,e,n,o,i]),{allowance:l,trackAllowance:(0,r.useCallback)((function(e){d(e),f(!0)}),[d]),loading:m}}var v=t(905817),h=t(925771),_=t(713989),S=t(286192),w=t(87474),T=t(939799),j=t(831085),ApproveBaseStake=function({details:e,price:n,balance:t,token:l,apr:c,decimals:u,minAmount:m="0",currentAllowance:f="0",providerName:k,providerLogo:x,onConfirm:I,approveTarget:A,providerLabel:C,estimateFeeResp:M,showEstReceive:$,estReceiveToken:E,estReceiveTokenRate:O="1"}){var P=(0,i.A)(),z=(0,S.sM)(),{navigationToSendConfirm:F}=(0,g.E)({accountId:A.accountId,networkId:A.networkId}),[L,V]=(0,r.useState)(!1),[N,D]=(0,r.useState)(!1),{allowance:R,loading:U,trackAllowance:B}=useTrackTokenAllowance({accountId:A.accountId,networkId:A.networkId,tokenAddress:A.token.address,spenderAddress:A.spenderAddress,initialValue:f}),[X,Y]=(0,r.useState)(""),[{currencyInfo:{symbol:H}}]=(0,y.useSettingsPersistAtom)(),W=(0,r.useCallback)((function(e){if(new p.A(e).isNaN())""===e&&Y("");else{var n=Boolean(u&&Number(u)>0&&(0,v.FZ)(e)>u);Y(n?function(e){return e}:e)}}),[u]),q=(0,r.useMemo)((function(){var e=new p.A(X);if(!e.isNaN())return e.multipliedBy(n).toFixed()}),[X,n]),K=(0,r.useMemo)((function(){return new p.A(X).gt(t)}),[X,t]),G=(0,r.useMemo)((function(){var e=new p.A(m),n=new p.A(X);return!(!e.isGreaterThan(0)||!n.isGreaterThan(0))&&n.isLessThan(e)}),[m,X]),Z=(0,r.useMemo)((function(){var e=(0,p.A)(X);return e.isNaN()||e.lte(0)||K||G}),[X,K,G]),Q=(0,r.useMemo)((function(){var e=(0,p.A)(X),n=new p.A(R);return!e.isNaN()&&n.lt(X)}),[X,R]),J=(0,r.useMemo)((function(){return Q?P.formatMessage({id:d.ETranslations.form__approve_str},{amount:X,symbol:l.symbol.toUpperCase()}):P.formatMessage({id:d.ETranslations.earn_stake})}),[Q,l,X,P]),ee=(0,r.useCallback)((0,a.A)((function*(){D(!0);var e=yield s.A.serviceAccount.getAccount({accountId:A.accountId,networkId:A.networkId});yield F({approvesInfo:[{owner:e.address,spender:A.spenderAddress,amount:X,tokenInfo:A.token}],onSuccess(e){B(e[0].decodedTx.txid),D(!1)},onFail(){D(!1)},onCancel(){D(!1)}})})),[X,A,F,B]),ne=(0,r.useCallback)((function(){W(t)}),[W,t]),te=(0,r.useMemo)((function(){if(Number(X)>0&&Number(c)>0){var e=(0,p.A)(X).multipliedBy(null!=c?c:0).dividedBy(100);return{amount:e.toFixed(),fiatValue:Number(n)>0?e.multipliedBy(n).toFixed():void 0}}}),[X,c,n]),ae=(0,r.useMemo)((function(){if(te?.fiatValue&&M?.feeFiatValue)return(0,S.fH)(te?.fiatValue,M.feeFiatValue)}),[M?.feeFiatValue,te?.fiatValue]),re=(0,r.useCallback)((0,a.A)((function*(){var showDialog=function(){var n;o.Dialog.show({renderIcon:(0,j.jsx)(o.Image,{width:"$14",height:"$14",src:e.token.info.logoURI}),title:P.formatMessage({id:d.ETranslations.earn_provider_asset_staking},{provider:(0,v.c)(e.provider.name.toLowerCase()),asset:e.token.info.symbol.toUpperCase()}),renderContent:(0,j.jsx)(_.G,{provider:e.provider.name.toLowerCase(),symbol:e.token.info.symbol.toLowerCase(),apr:e.provider.apr,updateFrequency:e.updateFrequency,unstakingPeriod:e.unstakingPeriod,receiveSymbol:e.rewardToken}),onConfirm:(n=(0,a.A)((function*(e){try{V(!0),yield e.close(),yield I?.(X)}finally{V(!1)}})),function onConfirm(e){return n.apply(this,arguments)}),onConfirmText:P.formatMessage({id:d.ETranslations.earn_stake}),showCancelButton:!1})};if(te?.fiatValue&&M){var n=(0,S.fH)(te.fiatValue,M.feeFiatValue);if(n&&n>5)return void z({daysConsumed:n,estFiatValue:M.feeFiatValue,onConfirm:showDialog})}showDialog()})),[I,X,te,M,z,e,P]);return(0,j.jsxs)(w.A,{children:[(0,j.jsx)(b.J,{hasError:K||G,value:X,onChange:W,tokenSelectorTriggerProps:{selectedTokenImageUri:l.logoURI,selectedTokenSymbol:l.symbol.toUpperCase()},balanceProps:{value:t,onPress:ne},inputProps:{placeholder:"0"},valueProps:{value:q,currency:q?H:void 0},enableMaxAmount:!0}),G?(0,j.jsx)(o.Alert,{icon:"InfoCircleOutline",type:"critical",title:P.formatMessage({id:d.ETranslations.earn_minimum_amount},{number:`${m} ${l.symbol}`})}):null,K?(0,j.jsx)(o.Alert,{icon:"InfoCircleOutline",type:"critical",title:P.formatMessage({id:d.ETranslations.earn_insufficient_balance})}):null,(0,j.jsxs)(h.k,{children:[te?(0,j.jsxs)(h.$,{children:[(0,j.jsx)(h.$.Label,{children:P.formatMessage({id:d.ETranslations.earn_est_annual_rewards})}),(0,j.jsx)(h.$.Value,{children:(0,j.jsx)(T.A,{tokenSymbol:l.symbol,fiatSymbol:H,amount:te.amount,fiatValue:te.fiatValue})})]}):null,$&&E&&Number(X)>0?(0,j.jsxs)(h.$,{children:[(0,j.jsx)(h.$.Label,{children:P.formatMessage({id:d.ETranslations.earn_est_receive})}),(0,j.jsx)(h.$.Value,{children:(0,j.jsx)(o.SizableText,{children:(0,j.jsx)(o.NumberSizeableText,{formatter:"balance",size:"$bodyLgMedium",formatterOptions:{tokenSymbol:E},children:(0,p.A)(X).multipliedBy(O).toFixed()})})})]}):null,c&&Number(c)>0?(0,j.jsxs)(h.$,{children:[(0,j.jsx)(h.$.Label,{children:P.formatMessage({id:d.ETranslations.global_apr})}),(0,j.jsx)(h.$.Value,{color:"$textSuccess",children:`${c}%`})]}):null,k&&x?(0,j.jsxs)(h.$,{children:[(0,j.jsx)(h.$.Label,{children:null!=C?C:P.formatMessage({id:d.ETranslations.global_protocol})}),(0,j.jsx)(h.$.Value,{children:(0,j.jsxs)(o.XStack,{gap:"$2",alignItems:"center",children:[(0,j.jsx)(o.Image,{width:"$5",height:"$5",src:x,borderRadius:"$2"}),(0,j.jsx)(o.SizableText,{size:"$bodyLgMedium",children:(0,v.c)(k)})]})})]}):null,M?(0,j.jsx)(S.BA,{estimateFeeResp:M,isVisible:!!te?.fiatValue,onPress:function(){z({daysConsumed:ae,estFiatValue:M.feeFiatValue})}}):null]}),(0,j.jsx)(o.Page.Footer,{onConfirmText:J,confirmButtonProps:{onPress:Q?ee:re,loading:L||U||N,disabled:Z}})]})},I=t(90393),A=t(653913);const pages_ApproveBaseStake=function(){var e,n,t=(0,c.u)(),{networkId:p,accountId:b,details:g,currentAllowance:y}=t.params,{token:k,provider:x}=g,{balanceParsed:h,price:_}=k,S=(0,l.A)(),w=(0,v.Y)(g),T=(0,A.B8)({accountId:b,networkId:p}),C=(0,r.useCallback)((n=(0,a.A)((function*(e){yield T({amount:e,stakingInfo:{label:f.D.Unknown,protocol:x.name,protocolLogoURI:x.logoURI,send:{token:k.info,amount:e},tags:[w]},symbol:k.info.symbol.toUpperCase(),provider:x.name,onSuccess:function(){S.pop(),m.U.staking.page.staking({token:k.info,stakingProtocol:x.name})}})})),function(e){return n.apply(this,arguments)}),[k,S,T,x,w]),M=(0,i.A)(),$=(0,r.useMemo)((function(){return"lido"===x.name.toLowerCase()}),[x]),E=(0,I.Z)(x.name),{result:O}=(0,u.yk)((0,a.A)((function*(){return yield s.A.serviceStaking.estimateFee({networkId:p,provider:x.name,symbol:k.info.symbol,action:"stake",amount:"1"})})),[p,x.name,k.info.symbol]);return(0,j.jsxs)(o.Page,{children:[(0,j.jsx)(o.Page.Header,{title:M.formatMessage({id:d.ETranslations.earn_stake_token},{token:k.info.symbol})}),(0,j.jsx)(o.Page.Body,{children:(0,j.jsx)(ApproveBaseStake,{details:g,price:_,balance:h,token:k.info,minAmount:x.minStakeAmount,decimals:k.info.decimals,onConfirm:C,apr:Number(x.apr)>0?x.apr:void 0,currentAllowance:y,providerLogo:g.provider.logoURI,providerName:g.provider.name,providerLabel:E,showEstReceive:$,estReceiveToken:g.rewardToken,estReceiveTokenRate:x.lidoStTokenRate,approveTarget:{accountId:b,networkId:p,spenderAddress:null!=(e=g.approveTarget)?e:"",token:k.info},estimateFeeResp:O})})]})}},905817:(e,n,t)=>{t.d(n,{FZ:()=>countDecimalPlaces,Y:()=>buildLocalTxStatusSyncId,c:()=>capitalizeString});var a=t(241440),buildLocalTxStatusSyncId=function(e){return`${e.provider.name.toLowerCase()}-${e.token.info.symbol.toLowerCase()}`};function capitalizeString(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function countDecimalPlaces(e){var n="string"==typeof e?Number(e):e;if(Number.isNaN(n))return 0;var t="string"==typeof e?e:(0,a.A)(e).toFixed(),r=t.indexOf(".");return-1===r?0:t.length-r-1}}}]);