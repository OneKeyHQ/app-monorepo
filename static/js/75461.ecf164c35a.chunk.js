"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[75461],{175461:(e,t,n)=>{n.r(t),n.d(t,{V4MigrationProcess:()=>V4MigrationProcess,default:()=>A});var r=n(586330),i=n(514041),o=n(654266),a=n(908867),s=n(490343),c=n(610421),u=n(498356),l=n(615111),d=n(334439),f=n(392097),g=n(584186),p=n(774614),v=n(883085),b=n(60406),y=n(831085);function V4MigrationProgressBar(){var e,t=(0,a.A)(),[n]=(0,l.Z9)(),r=null!=(e=n?.progress)?e:0;return(0,y.jsxs)(s.Stack,{flex:1,alignItems:"center",justifyContent:"center",alignSelf:"center",w:"100%",maxWidth:"$80",children:[(0,y.jsx)(s.Progress,{w:"100%",size:"medium",value:r}),(0,y.jsx)(s.SizableText,{mt:"$5",size:"$bodyLg",textAlign:"center",children:t.formatMessage({id:d.ETranslations.global_pct_complete},{ptc:r})})]})}function V4MigrationProcess({route:e}){var t=(0,u.A)(),n=(0,a.A)(),[l,A]=(0,i.useState)(!1),{serviceV4Migration:m}=c.A,[w,x]=(0,i.useState)(!0),j=(0,i.useCallback)((0,r.A)((function*(){if(!l)try{A(!0);yield m.startV4MigrationFlow();x(!1),yield g.A.wait(300),t.dispatch(o.y9.replace(f.xl.V4MigrationDone,void 0))}finally{A(!1)}})),[l,t,m]);return(0,y.jsxs)(v.l,{scrollEnabled:!1,exitPreventMode:w?b.yN.always:b.yN.disabled,onMounted:j,children:[(0,y.jsx)(s.Page.Header,{headerBackTitle:void 0,headerBackVisible:!1,headerRight:p.h,headerTitle:n.formatMessage({id:d.ETranslations.v4_migration_update_in_progress}),disableClose:!0}),(0,y.jsxs)(s.Page.Body,{py:"$2.5",px:"$5",gap:"$5",flex:1,alignItems:"center",justifyContent:"center",children:[(0,y.jsx)(p.U,{alignSelf:"stretch",children:(0,y.jsx)(s.Alert,{type:"warning",title:n.formatMessage({id:d.ETranslations.v4_migration_update_in_progress_alert_title}),description:n.formatMessage({id:d.ETranslations.v4_migration_update_in_progress_alert_description})})}),(0,y.jsx)(V4MigrationProgressBar,{})]})]})}const A=V4MigrationProcess},774614:(e,t,n)=>{n.d(t,{U:()=>V4MigrationLogCopy,h:()=>V4MigrationLogCopyHeaderRight});var r=n(324586),i=n(839850),o=n(490343),a=n(518736),s=(n(663522),n(621591)),c=n(831085),u=["children"];function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V4MigrationLogCopy(e){var{children:t}=e,n=(0,i.A)(e,u),r=(0,s.D)();return(0,c.jsx)(a.P,_objectSpread(_objectSpread({},n),{},{onPress:function(){r.copyV4MigrationLogs()},children:t}))}function V4MigrationLogCopyHeaderRight(){return(0,c.jsx)(V4MigrationLogCopy,{children:(0,c.jsx)(o.Stack,{w:"$8",h:"$8",backgroundColor:void 0})})}},883085:(e,t,n)=>{n.d(t,{l:()=>V4MigrationModalPage});var r=n(324586),i=n(586330),o=n(839850),a=n(514041),s=n(490343),c=n(153763),u=n(259227),l=n(60406),d=n(831085),f=["children","onMounted","exitPreventMode","isAutoStartOnMount"];function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V4MigrationModalPage(e){var{children:t,onMounted:n,exitPreventMode:r=l.yN.confirm,isAutoStartOnMount:g}=e,p=(0,o.A)(e,f),v=(0,a.useRef)(null),b=(0,c.E)();return(0,l.ek)({exitPreventMode:r,isAutoStartOnMount:g}),(0,a.useEffect)((function(){b&&clearTimeout(v.current)}),[b]),(0,d.jsx)(s.Page,_objectSpread(_objectSpread({scrollEnabled:!0,onMounted:(0,i.A)((function*(){yield u.v4migrationAtom.set((function(e){return _objectSpread(_objectSpread({},e),{},{isMigrationModalOpen:!0})})),n?.()})),onUnmounted:function(){},onClose:function(){}},p),{},{children:t}))}},60406:(e,t,n)=>{n.d(t,{EE:()=>useIsV4MigrationAutoStartFirstTime,ek:()=>useV4MigrationExitPrevent,yN:()=>A});var r=n(324586),i=n(514041),o=n(334025),a=n(908867),s=n(355931),c=n(493360),u=n(490343),l=n(498356),d=n(153763),f=n(259227),g=n(334439),p=n(663522),v=n(621591),b=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=!1,A=function(e){return e.always="always",e.confirm="confirm",e.disabled="disabled",e}({});function ModalExitPreventDialogContent({message:e,onCancelText:t,onConfirmText:n,preventRemoveData:r,isAutoStartOnMount:o}){var s=(0,a.A)(),c=(0,l.A)(),[d,p]=(0,f.useV4migrationPersistAtom)(),[v,y]=(0,i.useState)(!1);return(0,b.jsxs)(u.Stack,{children:[(0,b.jsx)(u.SizableText,{children:e}),o&&(d?.v4migrationAutoStartCount||0)>=3?(0,b.jsx)(u.Stack,{children:(0,b.jsx)(u.Checkbox,{value:v,onChange:function(){return y(!v)},label:s.formatMessage({id:g.ETranslations.v4_migration_exit_migration_checkbox_label})})}):null,(0,b.jsx)(u.Dialog.Footer,{onConfirmText:n,onConfirm:function(){c.dispatch(r.action),v&&p((function(e){return _objectSpread(_objectSpread({},e),{},{v4migrationAutoStartDisabled:!0})}))},onCancelText:t})]})}function useIsV4MigrationAutoStartFirstTime(){var[e]=(0,f.useV4migrationPersistAtom)();return!e.v4migrationAutoStartDisabled&&(!e?.v4migrationAutoStartCount||e?.v4migrationAutoStartCount<=1)}function useV4MigrationExitPrevent({exitPreventMode:e,isAutoStartOnMount:t}){var n=(0,a.A)(),r=n.formatMessage({id:g.ETranslations.confirm_exit_dialog_title}),l=n.formatMessage({id:g.ETranslations.confirm_exit_dialog_desc}),f=n.formatMessage({id:g.ETranslations.global_exit}),m=n.formatMessage({id:g.ETranslations.global_cancel}),w=useIsV4MigrationAutoStartFirstTime();(0,o.Wg)(),function useModalExitPrevent({exitPreventMode:e,isAutoStartOnMount:t,title:n,message:r,onConfirmText:o,onCancelText:a}){var s=(0,d.E)(),c=(0,i.useCallback)((function({data:e}){y||(y=!0,u.Dialog.show({title:n,renderContent:(0,b.jsx)(ModalExitPreventDialogContent,{onCancelText:a,onConfirmText:o,preventRemoveData:e,message:r,isAutoStartOnMount:t}),onClose:function(){y=!1}}))}),[t,r,a,o,n]),l=e!==A.disabled&&s,f=e===A.confirm?c:function(){return null};(0,u.usePreventRemove)(l,f)}({exitPreventMode:w&&e===A.confirm?A.always:e,isAutoStartOnMount:t,title:r,message:l,onConfirmText:f,onCancelText:m}),function useAppExitPrevent({message:e,title:t}){var n=(0,a.A)();(0,i.useEffect)((function(){if(p.Ay.isRuntimeBrowser&&!p.Ay.isExtensionUiPopup){var fn=function(t){return t.preventDefault(),t.returnValue=!0,e};return window.addEventListener("beforeunload",fn),function(){window.removeEventListener("beforeunload",fn)}}}),[e]),(0,i.useEffect)((function(){var r=c.A.addEventListener("hardwareBackPress",(function(){return s.A.alert(t,e,[{text:n.formatMessage({id:g.ETranslations.global_cancel}),onPress:function(){},style:"cancel"},{text:n.formatMessage({id:g.ETranslations.global_quit}),onPress:function(){return c.A.exitApp()}}],{cancelable:!1}),!0}));return function(){return r.remove()}}),[e,t,n])}({title:r,message:l}),function useExtensionV4MigrationFromExpandTab(){var e=(0,v.D)();(0,i.useEffect)((function(){p.Ay.isExtensionUiPopup&&(e.openV4MigrationOfExtension(),window.close())}),[e])}()}},334025:(e,t,n)=>{n.d(t,{Wg:()=>useKeepAwake});var r,i=n(586330),o=n(72631),a=n(514041),s=n(683180),c=n(34546);!function(e){e.RELEASE="release"}(r||(r={}));var u={};const l={isAvailableAsync:()=>(0,i.A)((function*(){return!!s.A.isDOMAvailable&&"wakeLock"in navigator}))(),activate:e=>(0,i.A)((function*(){if(s.A.isDOMAvailable){var t=yield navigator.wakeLock.request("screen");u[e]=t}}))(),deactivate:e=>(0,i.A)((function*(){if(s.A.isDOMAvailable){if(!u[e])throw new c.A("ERR_KEEP_AWAKE_TAG_INVALID",`The wake lock with tag ${e} has not activated yet`);u[e].release?.(),delete u[e]}}))(),addListenerForTag(e,t){var eventListener=function(){t({state:r.RELEASE})},n=u[e];return n&&("addEventListener"in n?n.addEventListener?.("release",eventListener):n.onrelease=eventListener),{remove:function(){var t=u[e];t&&(t.removeEventListener?t.removeEventListener("release",eventListener):t.onrelease=null)}}}};var d="ExpoKeepAwakeDefaultTag";function useKeepAwake(e=d,t){(0,a.useEffect)((function(){var n=!0;return activateKeepAwakeAsync(e).then((function(){n&&l.addListenerForTag&&t?.listener&&function addListener(e,t){if(!l.addListenerForTag)throw new o.V("ExpoKeepAwake","addListenerForTag");var n="string"==typeof e?e:d,r="function"==typeof e?e:t;return l.addListenerForTag(n,r)}(e,t.listener)})),function(){n=!1,t?.suppressDeactivateWarnings?deactivateKeepAwake(e).catch((function(){})):deactivateKeepAwake(e)}}),[e])}function activateKeepAwakeAsync(){return _activateKeepAwakeAsync.apply(this,arguments)}function _activateKeepAwakeAsync(){return(_activateKeepAwakeAsync=(0,i.A)((function*(e=d){yield l.activate?.(e)}))).apply(this,arguments)}function deactivateKeepAwake(){return _deactivateKeepAwake.apply(this,arguments)}function _deactivateKeepAwake(){return(_deactivateKeepAwake=(0,i.A)((function*(e=d){yield l.deactivate?.(e)}))).apply(this,arguments)}}}]);