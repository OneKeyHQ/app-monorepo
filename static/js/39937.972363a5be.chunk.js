"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[39937],{20322:(e,r,t)=>{t.d(r,{Gr:()=>useSwapRecipientAddressInfo,jA:()=>useSwapFromAccountNetworkSync,zf:()=>useSwapAddressInfo});var n=t(324586),o=t(586330),c=t(712784),a=t.n(c),d=t(514041),s=t(490343),u=t(153763),i=t(259227),l=t(392097),f=t(491180),p=t(619390),w=t(610421),b=t(317522),j=t(911998),A=t(162616),S=t(325529);function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,n.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function useSwapFromAccountNetworkSync(){var{updateSelectedAccountNetwork:e}=(0,A.z$)().current,[r]=(0,S.NE)(),{activeAccount:t}=(0,A.LH)({num:1}),{activeAccount:n}=(0,A.LH)({num:0}),[c,f]=(0,S.rv)(),[p]=(0,S.dF)(),[,w]=(0,i.useSettingsAtom)(),[j]=(0,S.Q8)(),m=(0,d.useRef)(),k=(0,d.useRef)(),O=(0,d.useRef)(),y=(0,d.useRef)(c),I=(0,d.useRef)(t),g=(0,d.useRef)(n);I.current!==t&&(I.current=t),g.current!==n&&(g.current=n),m.current!==r&&(m.current=r),k.current!==j&&(k.current=j),y.current!==c&&(y.current=c),O.current!==p&&(O.current=p);var v,h=(0,d.useCallback)(a()((0,o.A)((function*(){m.current&&(yield e({num:0,networkId:m.current?.networkId})),k.current&&(yield e({num:1,networkId:k.current?.networkId})),m.current&&k.current&&(y.current?.networkId&&k.current?.networkId!==y.current?.networkId||!y.current?.networkId&&!I.current?.account&&I.current?.wallet||!1===O.current||!y.current.address&&I.current.account?.id!==g.current.account?.id)&&(w((function(e){return _objectSpread(_objectSpread({},e),{},{swapToAnotherAccountSwitchOn:!1})})),f((function(e){return _objectSpread(_objectSpread({},e),{},{address:void 0})})),setTimeout((function(){k.current?.networkId&&I.current.network?.id&&k.current?.networkId!==I.current.network.id&&e({num:1,networkId:k.current?.networkId})}),500))})),100),[w,e]),_=(0,s.usePageType)();(0,b.A)(l.V4.Swap,(v=(0,o.A)((function*(e,r){if(_!==s.EPageType.modal){if(r)return;e&&(yield h())}})),function(e,r){return v.apply(this,arguments)})),(0,d.useEffect)((function(){_!==s.EPageType.modal&&(0,o.A)((function*(){yield h()}))()}),[h,r?.networkId,r?.contractAddress,j?.networkId,j?.contractAddress,p,_]);var x=(0,u.E)();(0,d.useEffect)((function(){_===s.EPageType.modal&&x&&(0,o.A)((function*(){yield h()}))()}),[h,x,_,r?.networkId,r?.contractAddress,j?.networkId,j?.contractAddress,p])}function useSwapAddressInfo(e){var{activeAccount:r}=(0,A.LH)({num:e===p.En.FROM?0:1}),[{swapToAnotherAccountSwitchOn:t}]=(0,i.useSettingsAtom)(),[n]=(0,S.rv)();return(0,d.useMemo)((function(){var o={networkId:void 0,address:void 0,accountInfo:void 0,activeAccount:void 0};return e===p.En.TO&&t&&n.address&&n.networkId&&r&&r.network?.id===n.networkId?_objectSpread(_objectSpread({},o),{},{address:n.address,networkId:n.networkId,accountInfo:n.accountInfo,activeAccount:_objectSpread({},r)}):r?_objectSpread(_objectSpread({},o),{},{address:r.account?.address,networkId:r.network?.id,accountInfo:_objectSpread({},r),activeAccount:_objectSpread({},r)}):o}),[e,t,n,r])}function useSwapRecipientAddressInfo(e){var r=useSwapAddressInfo(p.En.FROM),t=useSwapAddressInfo(p.En.TO),[n]=(0,S.Zr)(),[{swapToAnotherAccountSwitchOn:c}]=(0,i.useSettingsAtom)(),[a]=(0,S.rv)(),d=(0,j.yk)((0,o.A)((function*(){return e?t.networkId&&r.accountInfo?.account?.id&&r.accountInfo?.indexedAccount?.id?yield w.A.serviceStaking.getEarnAccount({accountId:r.accountInfo?.account?.id,networkId:t.networkId,indexedAccountId:r.accountInfo?.indexedAccount?.id}):void 0:null})),[e,t.networkId,r.accountInfo?.account?.id,r.accountInfo?.indexedAccount?.id],{}),s=(0,j.yk)((0,o.A)((function*(){if(a.networkId&&a.address){var e=yield w.A.serviceAccount.getAccountNameFromAddress({networkId:a.networkId,address:a.address});if(e.length>0)return e[0]}})),[a.address,a.networkId],{});if(t.address===a.address&&c&&d?.result?.accountAddress&&d?.result?.accountAddress!==a.address&&a.networkId===n?.toTokenInfo.networkId)return{accountInfo:a.accountInfo?.account?.address===a.address?{walletName:a.accountInfo?.wallet?.name,accountName:a.accountInfo?.accountName,accountId:a.accountInfo?.account?.id}:s.result,showAddress:f.A.shortenAddress({address:a.address,leadingLength:6,trailingLength:6}),isExtAccount:a.accountInfo?.account?.address!==a.address&&!s.result}}},309008:(e,r,t)=>{t.d(r,{o:()=>i});var n=t(324586),o=t(514041),c=t(325529),a=t(2577),d=t(597102),s=t(829561),u=t(831085);function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,n.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var i=(0,o.memo)((function(e){var{children:r,storeName:t}=e,n=(0,s.x6)(t),o=a.A.getOrCreateStore(n);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.H,_objectSpread({},n)),(0,u.jsx)(c.BY,{store:o,children:r})]})}));i.displayName="SwapProviderMirror"},639937:(e,r,t)=>{t.r(r),t.d(r,{default:()=>SwapToAnotherAddressPageModal});var n=t(324586),o=t(514041),c=t(654266),a=t(908867),d=t(490343),s=t(325809),u=t(370968),i=t(498356),l=t(325529),f=t(259227),p=t(334439),w=t(714191),b=t(619390),j=t(20322),A=t(309008),S=t(831085);function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,n.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var SwapToAnotherAddressPage=function(){var e=(0,i.A)(),r=(0,c.lq)(),t=r.params?.address,{accountInfo:n,address:s,activeAccount:w}=(0,j.zf)(b.En.TO),[,A]=(0,f.useSettingsAtom)(),[,m]=(0,l.rv)(),k=(0,a.A)(),O=(0,d.useForm)({defaultValues:{address:{raw:""}},mode:"onChange",reValidateMode:"onBlur"});(0,o.useEffect)((function(){s&&n?.account?.address===s?O.setValue("address",{raw:s}):t&&O.setValue("address",{raw:t})}),[n?.account?.address,s,O,t]);var y=(0,o.useCallback)((function(){A((function(e){return _objectSpread(_objectSpread({},e),{},{swapToAnotherAccountSwitchOn:!0})}))}),[A]),I=(0,o.useCallback)((function(r){var t=r.address.resolved;t&&(A((function(e){return _objectSpread(_objectSpread({},e),{},{swapToAnotherAccountSwitchOn:!0})})),m((function(e){return _objectSpread(_objectSpread({},e),{},{address:t,networkId:w?.network?.id,accountInfo:w})})),e.pop())}),[w,e,A,m]),g=(0,o.useCallback)((function(){A((function(e){return _objectSpread(_objectSpread({},e),{},{swapToAnotherAccountSwitchOn:!1})})),m((function(e){return _objectSpread(_objectSpread({},e),{},{address:void 0})}))}),[m,A]),v=(0,o.useMemo)((function(){return{num:1,onBeforeAccountSelectorOpen:y}}),[y]);return n&&n?.network?.id?(0,S.jsxs)(d.Page,{scrollEnabled:!0,children:[(0,S.jsxs)(d.Page.Body,{px:"$5",gap:"$6",children:[(0,S.jsx)(d.Form,{form:O,children:(0,S.jsx)(d.Form.Field,{label:k.formatMessage({id:p.ETranslations.global_recipient}),name:"address",rules:{required:!0,validate:function(e){var r;if(!e.pending&&!e.resolved)return null!=(r=e.validateError?.message)?r:k.formatMessage({id:p.ETranslations.send_address_invalid})}},children:(0,S.jsx)(u.N,{networkId:n?.network?.id,enableAddressBook:!0,enableWalletName:!0,accountId:n?.account?.id,contacts:!0,accountSelector:v})})}),(0,S.jsxs)(d.Stack,{gap:"$4",children:[(0,S.jsxs)(d.XStack,{children:[(0,S.jsx)(d.Stack,{$md:{pt:"$0.5"},children:(0,S.jsx)(d.Icon,{name:"CheckRadioOutline",size:"$5",color:"$iconSuccess"})}),(0,S.jsx)(d.SizableText,{flex:1,pl:"$2",size:"$bodyLg",color:"$textSubdued",$gtMd:{size:"$bodyMd"},children:k.formatMessage({id:p.ETranslations.swap_page_recipient_modal_verify})})]}),(0,S.jsxs)(d.XStack,{children:[(0,S.jsx)(d.Stack,{$md:{pt:"$0.5"},children:(0,S.jsx)(d.Icon,{name:"BlockOutline",size:"$5",color:"$iconCritical"})}),(0,S.jsx)(d.SizableText,{flex:1,pl:"$2",size:"$bodyLg",color:"$textSubdued",$gtMd:{size:"$bodyMd"},children:k.formatMessage({id:p.ETranslations.swap_page_recipient_modal_do_not})})]})]})]}),(0,S.jsx)(d.Page.Footer,{onConfirm:function(){return O.handleSubmit(I)()},onConfirmText:k.formatMessage({id:p.ETranslations.global_confirm}),onCancelText:k.formatMessage({id:p.ETranslations.swap_account_to_address_edit_button}),onCancel:g})]}):null},SwapToAnotherAddressPageWithProvider=function(){var e=(0,c.lq)(),{storeName:r}=e.params;return(0,S.jsx)(A.o,{storeName:r,children:(0,S.jsx)(SwapToAnotherAddressPage,{})})};function SwapToAnotherAddressPageModal(){return(0,S.jsx)(s.b8,{config:{sceneName:w.Zs.swap},enabledNum:[0,1],children:(0,S.jsx)(SwapToAnotherAddressPageWithProvider,{})})}}}]);