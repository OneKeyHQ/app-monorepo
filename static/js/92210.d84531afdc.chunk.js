"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[92210],{326745:(e,n,t)=>{t.d(n,{u:()=>useAppRoute});var i=t(654266);function useAppRoute(){return(0,i.lq)()}},925771:(e,n,t)=>{t.d(n,{$:()=>CalculationListItem,k:()=>CalculationList});var i=t(324586),r=t(839850),a=t(490343),o=t(831085),s=["children"],l=["children"],c=["children"];function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach((function(n){(0,i.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function CalculationList({children:e}){return(0,o.jsx)(a.YStack,{gap:"$4",children:e})}function CalculationListItem(e){var{children:n}=e,t=(0,r.A)(e,s);return(0,o.jsx)(a.XStack,_objectSpread(_objectSpread({animation:"quick",enterStyle:{opacity:0},justifyContent:"space-between",alignItems:"center"},t),{},{children:n}))}CalculationList.Item=CalculationListItem,CalculationListItem.Label=function CalculationListItemLabel(e){var{children:n}=e,t=(0,r.A)(e,l);return(0,o.jsx)(a.SizableText,_objectSpread(_objectSpread({color:"$textSubdued"},t),{},{children:n}))},CalculationListItem.Value=function CalculationListItemValue(e){var{children:n}=e,t=(0,r.A)(e,c);return(0,o.jsx)(a.SizableText,_objectSpread(_objectSpread({size:"$bodyLgMedium"},t),{},{children:n}))}},286192:(e,n,t)=>{t.d(n,{BA:()=>EstimateNetworkFee,QL:()=>useShowClaimEstimateGasAlert,fH:()=>calcDaysSpent,sM:()=>useShowStakeEstimateGasAlert});var i=t(514041),r=t(241440),a=t(908867),o=t(490343),s=t(259227),l=t(334439),c=t(925771),u=t(831085),useShowStakeEstimateGasAlert=function(){var e=(0,a.A)(),[{currencyInfo:{symbol:n}}]=(0,s.useSettingsPersistAtom)();return(0,i.useCallback)((function({daysConsumed:t,estFiatValue:i,onConfirm:r}){var a=t?e.formatMessage({id:l.ETranslations.earn_transaction_loss_when_stake},{number:(0,u.jsx)(o.SizableText,{size:"$bodyLgMedium",color:"$textCaution",children:t})}):void 0;o.Dialog.show({title:e.formatMessage({id:l.ETranslations.earn_transaction_loss}),icon:"InfoCircleOutline",description:a,renderContent:(0,u.jsxs)(o.XStack,{children:[(0,u.jsxs)(o.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.global_est_network_fee}),":"]}),(0,u.jsx)(o.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:i})]}),onConfirm:r})}),[e,n])},useShowClaimEstimateGasAlert=function(){var e=(0,a.A)(),[{currencyInfo:{symbol:n}}]=(0,s.useSettingsPersistAtom)();return(0,i.useCallback)((function({claimTokenFiatValue:t,estFiatValue:i,onConfirm:a}){var s=(0,r.A)(t).minus(i).absoluteValue().toFixed(),c=e.formatMessage({id:l.ETranslations.earn_transaction_loss_when_claim},{number:(0,u.jsx)(o.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",color:"$textCaution",formatterOptions:{currency:n},children:s})});o.Dialog.show({title:e.formatMessage({id:l.ETranslations.earn_transaction_loss}),icon:"InfoCircleOutline",description:c,renderContent:(0,u.jsxs)(o.YStack,{children:[(0,u.jsxs)(o.XStack,{children:[(0,u.jsxs)(o.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.global_est_network_fee}),":"]}),(0,u.jsx)(o.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:i})]}),(0,u.jsxs)(o.XStack,{children:[(0,u.jsxs)(o.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.earn_reward_value}),":"]}),(0,u.jsx)(o.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:t})]})]}),onConfirm:a})}),[e,n])},EstimateNetworkFeeListItem=function({estFiatValue:e,onPress:n}){var t=(0,a.A)(),[{currencyInfo:{symbol:i}}]=(0,s.useSettingsPersistAtom)();return Number(e)>0?(0,u.jsxs)(c.$,{onPress:n,children:[(0,u.jsx)(c.$.Label,{children:t.formatMessage({id:l.ETranslations.global_est_network_fee})}),(0,u.jsxs)(o.XStack,{alignItems:"center",cursor:n?"pointer":void 0,mr:n?-6:void 0,children:[(0,u.jsx)(o.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:i},children:e}),n?(0,u.jsx)(o.Icon,{name:"ChevronRightSmallOutline",size:24}):null]})]}):null},calcDaysSpent=function(e,n){var t=(0,r.A)(n).div(e).multipliedBy(365);return t.isNaN()?void 0:Math.ceil(t.toNumber())},EstimateNetworkFee=function({estimateFeeResp:e,onPress:n,isVisible:t}){return e&&t?(0,u.jsx)(EstimateNetworkFeeListItem,{estFiatValue:e.feeFiatValue,onPress:n}):null}},87474:(e,n,t)=>{t.d(n,{A:()=>StakingFormWrapper});var i=t(324586),r=t(839850),a=t(490343),o=t(831085),s=["children"];function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach((function(n){(0,i.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function StakingFormWrapper(e){var{children:n}=e,t=(0,r.A)(e,s);return(0,o.jsx)(a.YStack,_objectSpread(_objectSpread({p:"$5",gap:"$5"},t),{},{children:n}))}},939799:(e,n,t)=>{t.d(n,{A:()=>ValuePriceListItem});var i=t(490343),r=t(831085),ValuePriceListItem=function({amount:e,tokenSymbol:n,fiatSymbol:t,fiatValue:a}){return(0,r.jsxs)(i.XStack,{gap:"$1",maxWidth:"$56",justifyContent:"flex-end",flexWrap:"wrap",children:[(0,r.jsx)(i.XStack,{children:(0,r.jsx)(i.NumberSizeableText,{size:"$bodyLgMedium",formatter:"balance",formatterOptions:{tokenSymbol:n},children:e})}),(0,r.jsx)(i.XStack,{maxWidth:"$56",children:a?(0,r.jsxs)(i.SizableText,{children:["(",(0,r.jsx)(i.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:t},children:a}),")"]}):null})]})}},90393:(e,n,t)=>{t.d(n,{Z:()=>useProviderLabel});var i=t(908867),r=t(334439),useProviderLabel=function(e){var n=(0,i.A)(),t=n.formatMessage({id:r.ETranslations.global_protocol});return"everstake"===e.toLowerCase()?t=n.formatMessage({id:r.ETranslations.earn_validator}):"babylogn"===e.toLowerCase()&&(t=n.formatMessage({id:r.ETranslations.earn_finality_provider})),t}},653913:(e,n,t)=>{t.d(n,{B8:()=>useUniversalStake,D0:()=>useUniversalClaim,Pg:()=>useUniversalWithdraw});var i=t(586330),r=t(514041),a=t(241440),o=t(610421),s=t(927799),l=t(553083),c=t(161024),u=t(286192);function useUniversalStake({networkId:e,accountId:n}){var t,{navigationToSendConfirm:a}=(0,s.E)({accountId:n,networkId:e});return(0,r.useCallback)((t=(0,i.A)((function*({amount:t,symbol:i,term:r,feeRate:s,provider:c,stakingInfo:u,onSuccess:d,onFail:m}){var f,b,p=yield o.A.serviceStaking.buildStakeTransaction({amount:t,networkId:e,accountId:n,symbol:i,term:r,provider:c,feeRate:s}),g=yield o.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:p});l.Ay.isBTCNetwork(e)&&g.fee&&(f=!0,b=!1),yield a({encodedTx:g,stakingInfo:u,onSuccess:d,onFail:m,useFeeInTx:f,feeInfoEditable:b})})),function(e){return t.apply(this,arguments)}),[a,n,e])}function useUniversalWithdraw({networkId:e,accountId:n}){var t,{navigationToSendConfirm:a}=(0,s.E)({accountId:n,networkId:e});return(0,r.useCallback)((t=(0,i.A)((function*({amount:t,symbol:r,provider:s,identity:u,stakingInfo:d,onSuccess:m,onFail:f}){var b,p=yield o.A.serviceStaking.getStakingConfigs({networkId:e,symbol:r,provider:s});if(!p)throw new Error("Staking config not found");if(p?.unstakeWithSignMessage){var g=yield o.A.serviceAccount.getAccount({accountId:n,networkId:e}),{message:y,deadline:v}=yield o.A.serviceStaking.buildLidoEthPermitMessageData({accountId:n,networkId:e,amount:t}),k=yield o.A.serviceDApp.openSignMessageModal({accountId:n,networkId:e,request:{origin:"https://lido.fi/",scope:"ethereum"},unsignedMessage:{type:c.$.TYPED_DATA_V4,message:y,payload:[g.address,y]},walletInternalSign:!0});b=yield o.A.serviceStaking.buildUnstakeTransaction({amount:t,networkId:e,accountId:n,symbol:r,provider:s,signature:k,deadline:v})}else b=yield o.A.serviceStaking.buildUnstakeTransaction({amount:t,identity:u,networkId:e,accountId:n,symbol:r,provider:s});var x,S,h,j=yield o.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:b});l.Ay.isBTCNetwork(e)&&j.fee&&(x=!0,S=!1),yield a({encodedTx:j,stakingInfo:d,signOnly:p?.withdrawSignOnly,useFeeInTx:x,feeInfoEditable:S,onSuccess:(h=(0,i.A)((function*(t){if(p?.withdrawSignOnly){var i=t[0].signedTx.finalizedPsbtHex;i&&u&&(yield o.A.serviceStaking.unstakePush({txId:u,networkId:e,accountId:n,symbol:r,provider:s,unstakeTxHex:i}),m?.(t))}else m?.(t)})),function onSuccess(e){return h.apply(this,arguments)}),onFail:f})})),function(e){return t.apply(this,arguments)}),[n,e,a])}function useUniversalClaim({networkId:e,accountId:n}){var t,{navigationToSendConfirm:c}=(0,s.E)({accountId:n,networkId:e}),d=(0,u.QL)();return(0,r.useCallback)((t=(0,i.A)((function*({identity:t,amount:r,provider:s,symbol:u,stakingInfo:m,onSuccess:f,onFail:b}){var p,g=(p=(0,i.A)((function*(){var i,a,d=yield o.A.serviceStaking.buildClaimTransaction({networkId:e,accountId:n,symbol:u,provider:s,amount:r,identity:t}),p=yield o.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:d});l.Ay.isBTCNetwork(e)&&p.fee&&(i=!0,a=!1),yield c({encodedTx:p,stakingInfo:m,onSuccess:f,onFail:b,useFeeInTx:i,feeInfoEditable:a})})),function continueClaim(){return p.apply(this,arguments)});if(Number(r)>0){var y=yield o.A.serviceStaking.estimateFee({networkId:e,provider:s,symbol:u,action:"claim",amount:r}),v=(0,a.A)(y.token.price).multipliedBy(r);if(v.lt(y.feeFiatValue))return void d({claimTokenFiatValue:v.toFixed(),estFiatValue:y.feeFiatValue,onConfirm:g})}yield g()})),function(e){return t.apply(this,arguments)}),[c,n,e,d])}},992210:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Claim});var i=t(586330),r=t(514041),a=t(908867),o=t(490343),s=t(610421),l=t(498356),c=t(326745),u=t(911998),d=t(334439),m=t(948675),f=t(550082),b=t(241440),p=t(88803),g=t(259227),y=t(905817),v=t(925771),k=t(286192),x=t(87474),S=t(939799),h=t(831085),UniversalClaim=function({balance:e,price:n,tokenImageUri:t,tokenSymbol:s,providerLogo:l,providerName:c,providerLabel:u,initialAmount:m,minAmount:f="0",rate:j="1",decimals:I,estimateFeeResp:w,onConfirm:A}){var T=Number(n)>0?n:"0",[C,O]=(0,r.useState)(!1),[_,$]=(0,r.useState)(null!=m?m:""),[{currencyInfo:{symbol:P}}]=(0,g.useSettingsPersistAtom)(),L=(0,r.useCallback)((0,i.A)((function*(){try{O(!0),yield A?.(_)}finally{O(!1)}})),[_,A]),M=(0,r.useCallback)((function(e){if(new b.A(e).isNaN())""===e&&$("");else{var n=Boolean(I&&Number(I)>0&&(0,y.FZ)(e)>I);$(n?function(e){return e}:e)}}),[I]),F=(0,r.useMemo)((function(){var e=new b.A(_);if(!e.isNaN())return e.multipliedBy(T).toFixed()}),[_,T]),E=(0,r.useMemo)((function(){return new b.A(_).gt(e)}),[_,e]),z=(0,r.useMemo)((function(){var e=new b.A(f),n=new b.A(_);return!(!e.isGreaterThan(0)||!n.isGreaterThan(0))&&n.isLessThan(e)}),[f,_]),N=(0,r.useCallback)((function(){M(e)}),[M,e]),D=(0,r.useMemo)((function(){return(0,b.A)(_).isNaN()||(0,b.A)(_).isLessThanOrEqualTo(0)||E||z}),[_,E,z]),V=(0,r.useMemo)((function(){if(Number(_)>0){var e=(0,b.A)(_).dividedBy(j);return(0,h.jsx)(S.A,{amount:e.toFixed(),fiatSymbol:P,fiatValue:Number(T)>0?e.multipliedBy(T).dividedBy(j).toFixed():void 0,tokenSymbol:null!=s?s:""})}return null}),[_,T,s,j,P]),U=(0,a.A)(),B=void 0===m;return(0,h.jsxs)(x.A,{children:[(0,h.jsxs)(o.Stack,{position:"relative",opacity:B?1:.7,children:[(0,h.jsx)(p.J,{bg:B?"$bgApp":"$bgDisabled",hasError:E||z,value:_,onChange:M,tokenSelectorTriggerProps:{selectedTokenImageUri:t,selectedTokenSymbol:s},inputProps:{placeholder:"0",autoFocus:B},balanceProps:{value:e,onPress:N},valueProps:{value:F,currency:F?P:void 0}}),B?null:(0,h.jsx)(o.Stack,{position:"absolute",w:"100%",h:"100%",zIndex:1})]}),z?(0,h.jsx)(o.Alert,{icon:"InfoCircleOutline",type:"critical",title:U.formatMessage({id:d.ETranslations.earn_minimum_amount},{number:`${f} ${null!=s?s:""}`})}):null,E?(0,h.jsx)(o.Alert,{icon:"InfoCircleOutline",type:"critical",title:U.formatMessage({id:d.ETranslations.earn_insufficient_claimable_balance})}):null,(0,h.jsxs)(v.k,{children:[V?(0,h.jsxs)(v.$,{children:[(0,h.jsx)(v.$.Label,{children:U.formatMessage({id:d.ETranslations.earn_receive})}),(0,h.jsx)(v.$.Value,{children:V})]}):null,c&&l?(0,h.jsxs)(v.$,{children:[(0,h.jsx)(v.$.Label,{children:null!=u?u:U.formatMessage({id:d.ETranslations.global_protocol})}),(0,h.jsx)(v.$.Value,{children:(0,h.jsxs)(o.XStack,{gap:"$2",alignItems:"center",children:[(0,h.jsx)(o.Image,{width:"$5",height:"$5",src:l,borderRadius:"$2"}),(0,h.jsx)(o.SizableText,{size:"$bodyLgMedium",children:(0,y.c)(c)})]})})]}):null,w?(0,h.jsx)(k.BA,{estimateFeeResp:w,isVisible:Number(_)>0}):null]}),(0,h.jsx)(o.Page.Footer,{onConfirmText:U.formatMessage({id:d.ETranslations.earn_claim}),confirmButtonProps:{onPress:L,loading:C,disabled:D}})]})},j=t(90393),I=t(653913);const Claim=function(){var e,n,t=(0,a.A)(),b=(0,c.u)(),{accountId:p,networkId:g,details:v,amount:k,identity:x,onSuccess:S}=b.params,{token:w,provider:A}=v,{price:T,info:C}=w,O=(0,y.Y)(v),_=(0,l.A)(),$=(0,I.D0)({accountId:p,networkId:g}),P=(0,r.useCallback)((n=(0,i.A)((function*(e){yield $({amount:e,identity:x,symbol:C.symbol,provider:A.name,stakingInfo:{label:f.D.Claim,protocol:A.name,protocolLogoURI:A.logoURI,receive:{token:C,amount:e},tags:[O]},onSuccess:function(){_.pop(),m.U.staking.page.unstaking({token:C,stakingProtocol:A.name}),S?.()}})})),function(e){return n.apply(this,arguments)}),[$,C,_,A,O,x,S]),L=(0,j.Z)(A.name),{result:M}=(0,u.yk)((0,i.A)((function*(){return yield s.A.serviceStaking.estimateFee({networkId:g,provider:A.name,symbol:C.symbol,action:"claim",amount:"1"})})),[g,A.name,C.symbol]);return(0,h.jsxs)(o.Page,{children:[(0,h.jsx)(o.Page.Header,{title:t.formatMessage({id:d.ETranslations.earn_claim_token},{token:w.info.symbol})}),(0,h.jsx)(o.Page.Body,{children:(0,h.jsx)(UniversalClaim,{price:T,decimals:v.token.info.decimals,initialAmount:k,balance:null!=(e=v.claimable)?e:"0",tokenSymbol:C.symbol,tokenImageUri:C.logoURI,providerLogo:A.logoURI,providerName:A.name,providerLabel:L,onConfirm:P,estimateFeeResp:M})})]})}},905817:(e,n,t)=>{t.d(n,{FZ:()=>countDecimalPlaces,Y:()=>buildLocalTxStatusSyncId,c:()=>capitalizeString});var i=t(241440),buildLocalTxStatusSyncId=function(e){return`${e.provider.name.toLowerCase()}-${e.token.info.symbol.toLowerCase()}`};function capitalizeString(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function countDecimalPlaces(e){var n="string"==typeof e?Number(e):e;if(Number.isNaN(n))return 0;var t="string"==typeof e?e:(0,i.A)(e).toFixed(),r=t.indexOf(".");return-1===r?0:t.length-r-1}}}]);