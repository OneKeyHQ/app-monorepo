"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[60848],{980342:(e,r,t)=>{t.d(r,{A:()=>s,z:()=>useDappCloseHandler});var o=t(490343),a=t(42484),n=t(831085);function useDappCloseHandler(e,r){return function(t){t?.flag!==a.nd.Confirmed&&e.reject(),"function"==typeof r&&r(t)}}const s=function DappOpenModalPage({children:e,onClose:r,dappApprove:t}){var a=useDappCloseHandler(t,r);return(0,n.jsxs)(o.Page,{scrollEnabled:!0,onClose:a,children:[(0,n.jsx)(o.Page.Header,{headerShown:!1}),e]})}},660848:(e,r,t)=>{t.r(r),t.d(r,{default:()=>w});var o=t(324586),a=t(586330),n=t(514041),s=t(654266),i=t(908867),l=t(490343),d=t(610421),c=t(498356),u=t(796895),m=t(24284),f=t(334439),_=t(948675),p=t(491180),g=t(796151),b=t(980342),k=t(831085);function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,o.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var parseChainId=function(e){return"number"==typeof e?e.toString():"string"==typeof e?e.startsWith("0x")?parseInt(e,16).toString():e:""};const w=function AddCustomNetwork(){var e,r,t,o,w,h,v,y,x=(0,i.A)(),E=(0,c.A)(),T=(0,s.lq)(),{state:j,networkId:C,onSuccess:M,onDeleteSuccess:I,networkName:A,rpcUrl:O,chainId:P,symbol:U,blockExplorerUrl:S}=null!=(e=T.params)?e:{},{$sourceInfo:N,networkInfo:D}=(0,m.A)(),F=(0,u.A)({id:null!=(r=N?.id)?r:"",closeWindowAfterResolved:!0}),z=(0,l.useForm)({mode:"onBlur",defaultValues:{networkName:null!=(t=null!=A?A:D?.chainName)?t:"",rpcUrl:null!=(o=null!=O?O:D?.rpcUrls?.[0])?o:"",chainId:P?String(P):D?.chainId?parseChainId(D.chainId):"",symbol:null!=(w=null!=U?U:D?.nativeCurrency?.symbol)?w:"",blockExplorerUrl:null!=(h=null!=S?S:D?.blockExplorerUrls?.[0])?h:""}}),[q,$]=(0,n.useState)(!1),R=(0,n.useCallback)((v=(0,a.A)((function*(e){try{$(!0);var{chainId:r}=yield d.A.serviceCustomRpc.getChainIdByRpcUrl({rpcUrl:e});return r&&z.setValue("chainId",parseChainId(r)),r}catch(e){throw z.setValue("chainId",""),e}finally{$(!1)}})),function(e){return v.apply(this,arguments)}),[z]),[B,H]=(0,n.useState)(!1),V=(0,n.useCallback)((0,a.A)((function*(){try{if(H(!0),!(yield z.trigger()))return;var{networkName:e,rpcUrl:r,chainId:t,symbol:o,blockExplorerUrl:a}=z.getValues(),n=parseInt(t,10);try{if(!n){var s=yield R(r);s&&(n=s)}if(!n)return void l.Toast.error({title:x.formatMessage({id:f.ETranslations.form_rpc_url_invalid})})}catch(e){return void l.Toast.error({title:x.formatMessage({id:f.ETranslations.form_rpc_url_invalid})})}var i=p.A.buildCustomEvmNetworkId({chainId:n.toString()}),c=yield d.A.serviceNetwork.getNetworkSafe({networkId:i});if(c&&!c.isCustomNetwork)return void l.Toast.error({title:x.formatMessage({id:f.ETranslations.custom_network_network_exists_feedback_text})});var u={networkName:e,rpcUrl:r,chainId:n,symbol:o,blockExplorerUrl:a};yield d.A.serviceCustomRpc.upsertCustomNetwork(u);var m=yield d.A.serviceNetwork.getNetwork({networkId:i});F.resolve({result:m}),setTimeout((function(){M?.(m),_.U.account.wallet.customNetworkAdded({chainID:String(n)})}),500),l.Toast.success({title:x.formatMessage({id:f.ETranslations.custom_network_add_custom_network_successfully_toast_text})}),E.pop()}catch(e){l.Toast.error({title:x.formatMessage({id:f.ETranslations.custom_network_add_custom_network_failed_toast_text})})}finally{H(!1)}})),[z,F,x,E,R,M]),W=(0,n.useCallback)((0,a.A)((function*(){var e;C&&l.Dialog.show({title:x.formatMessage({id:f.ETranslations.custom_network_remove_network_dialog_title}),description:x.formatMessage({id:f.ETranslations.custom_network_remove_network_dialog_description}),showCancelButton:!0,onConfirmText:x.formatMessage({id:f.ETranslations.global_remove}),confirmButtonProps:{variant:"destructive"},onConfirm:(e=(0,a.A)((function*({close:e}){yield d.A.serviceCustomRpc.deleteCustomNetwork({networkId:C}),l.Toast.success({title:x.formatMessage({id:f.ETranslations.explore_removed_success})}),E.pop(),I?.(),yield e()})),function onConfirm(r){return e.apply(this,arguments)})})})),[C,x,E,I]),K=(0,n.useCallback)((function(){return"edit"!==j?null:(0,k.jsx)(l.IconButton,{title:x.formatMessage({id:f.ETranslations.global_remove}),icon:"DeleteOutline",variant:"tertiary",iconColor:"$iconSubdued",onPress:function(){return W()}})}),[j,x,W]),L=(0,b.z)(F);return(0,k.jsxs)(l.Page,{scrollEnabled:!0,onClose:L,children:[(0,k.jsx)(l.Page.Header,{title:x.formatMessage({id:f.ETranslations.custom_network_add_network_action_text}),headerRight:K}),(0,k.jsxs)(l.Page.Body,{px:"$5",gap:"$5",children:[(0,k.jsx)(l.Alert,{icon:"ErrorOutline",type:"warning",title:x.formatMessage({id:f.ETranslations.custom_network_form_alert_text})}),(0,k.jsxs)(l.Form,{form:z,children:[(0,k.jsx)(l.Form.Field,{name:"networkName",label:x.formatMessage({id:f.ETranslations.form_network_name_label}),rules:{required:{value:!0,message:x.formatMessage({id:f.ETranslations.address_book_add_address_name_required})}},children:(0,k.jsx)(l.Input,{size:"large",$gtMd:{size:"medium"}})}),(0,k.jsx)(l.Form.Field,{name:"rpcUrl",label:"RPC URL",rules:{required:{value:!0,message:x.formatMessage({id:f.ETranslations.address_book_add_address_name_required})},validate:(y=(0,a.A)((function*(e){if(e){if(!g.Ay.parseUrl(e))return x.formatMessage({id:f.ETranslations.form_rpc_url_invalid});if(!e.startsWith("http"))return x.formatMessage({id:f.ETranslations.form_rpc_url_prefix_required});try{if(!(yield R(e)))return x.formatMessage({id:f.ETranslations.form_rpc_url_invalid})}catch(e){return x.formatMessage({id:f.ETranslations.form_rpc_url_invalid})}}})),function validate(e){return y.apply(this,arguments)})},children:(0,k.jsx)(l.Input,_objectSpread({size:"large",$gtMd:{size:"medium"}},q&&{addOns:[{loading:!0}]}))}),(0,k.jsx)(l.Form.Field,{name:"chainId",label:"Chain ID",disabled:!0,children:(0,k.jsx)(l.Input,{size:"large",$gtMd:{size:"medium"},editable:!1})}),(0,k.jsx)(l.Form.Field,{name:"symbol",label:x.formatMessage({id:f.ETranslations.manage_token_custom_token_symbol}),rules:{required:{value:!0,message:x.formatMessage({id:f.ETranslations.address_book_add_address_name_required})}},children:(0,k.jsx)(l.Input,{size:"large",$gtMd:{size:"medium"}})}),(0,k.jsx)(l.Form.Field,{name:"blockExplorerUrl",label:x.formatMessage({id:f.ETranslations.form_block_explorer_url_label}),optional:!0,rules:{validate:function(e){if(e)return g.Ay.parseUrl(e)?e.startsWith("http")?void 0:x.formatMessage({id:f.ETranslations.form_rpc_url_prefix_required}):x.formatMessage({id:f.ETranslations.form_rpc_url_invalid})}},children:(0,k.jsx)(l.Input,{size:"large",$gtMd:{size:"medium"}})})]})]}),(0,k.jsx)(l.Page.Footer,{onConfirmText:x.formatMessage({id:f.ETranslations.action_save}),onCancelText:x.formatMessage({id:f.ETranslations.global_cancel}),confirmButtonProps:{loading:B},onConfirm:function(){return z.handleSubmit(V)()},onCancel:function(){return F.reject()}})]})}}}]);