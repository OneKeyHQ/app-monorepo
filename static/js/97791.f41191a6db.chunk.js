"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[97791],{583354:(e,t,n)=>{n.d(t,{D:()=>o,U:()=>r});var r=function(e){return e.hd="hd",e.qr="qr",e.hardware="hardware",e.imported="imported",e.watching="watching",e.external="external",e}({}),o=function(e){return e.DEPOSIT="deposit",e.WITHDRAW="withdraw",e}({})},82506:(e,t,n)=>{n.d(t,{d:()=>useDebounce});var r=n(578104);function useDebounce(e,t,n){var[o]=(0,r.d7)(e,t,n);return o}},20322:(e,t,n)=>{n.d(t,{Gr:()=>useSwapRecipientAddressInfo,jA:()=>useSwapFromAccountNetworkSync,zf:()=>useSwapAddressInfo});var r=n(324586),o=n(586330),a=n(712784),s=n.n(a),i=n(514041),c=n(490343),u=n(153763),d=n(259227),l=n(392097),p=n(491180),f=n(619390),w=n(610421),m=n(317522),g=n(911998),S=n(162616),b=n(325529);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function useSwapFromAccountNetworkSync(){var{updateSelectedAccountNetwork:e}=(0,S.z$)().current,[t]=(0,b.NE)(),{activeAccount:n}=(0,S.LH)({num:1}),{activeAccount:r}=(0,S.LH)({num:0}),[a,p]=(0,b.rv)(),[f]=(0,b.dF)(),[,w]=(0,d.useSettingsAtom)(),[g]=(0,b.Q8)(),k=(0,i.useRef)(),v=(0,i.useRef)(),A=(0,i.useRef)(),I=(0,i.useRef)(a),y=(0,i.useRef)(n),T=(0,i.useRef)(r);y.current!==n&&(y.current=n),T.current!==r&&(T.current=r),k.current!==t&&(k.current=t),v.current!==g&&(v.current=g),I.current!==a&&(I.current=a),A.current!==f&&(A.current=f);var h,j=(0,i.useCallback)(s()((0,o.A)((function*(){k.current&&(yield e({num:0,networkId:k.current?.networkId})),v.current&&(yield e({num:1,networkId:v.current?.networkId})),k.current&&v.current&&(I.current?.networkId&&v.current?.networkId!==I.current?.networkId||!I.current?.networkId&&!y.current?.account&&y.current?.wallet||!1===A.current||!I.current.address&&y.current.account?.id!==T.current.account?.id)&&(w((function(e){return _objectSpread(_objectSpread({},e),{},{swapToAnotherAccountSwitchOn:!1})})),p((function(e){return _objectSpread(_objectSpread({},e),{},{address:void 0})})),setTimeout((function(){v.current?.networkId&&y.current.network?.id&&v.current?.networkId!==y.current.network.id&&e({num:1,networkId:v.current?.networkId})}),500))})),100),[w,e]),x=(0,c.usePageType)();(0,m.A)(l.V4.Swap,(h=(0,o.A)((function*(e,t){if(x!==c.EPageType.modal){if(t)return;e&&(yield j())}})),function(e,t){return h.apply(this,arguments)})),(0,i.useEffect)((function(){x!==c.EPageType.modal&&(0,o.A)((function*(){yield j()}))()}),[j,t?.networkId,t?.contractAddress,g?.networkId,g?.contractAddress,f,x]);var _=(0,u.E)();(0,i.useEffect)((function(){x===c.EPageType.modal&&_&&(0,o.A)((function*(){yield j()}))()}),[j,_,x,t?.networkId,t?.contractAddress,g?.networkId,g?.contractAddress,f])}function useSwapAddressInfo(e){var{activeAccount:t}=(0,S.LH)({num:e===f.En.FROM?0:1}),[{swapToAnotherAccountSwitchOn:n}]=(0,d.useSettingsAtom)(),[r]=(0,b.rv)();return(0,i.useMemo)((function(){var o={networkId:void 0,address:void 0,accountInfo:void 0,activeAccount:void 0};return e===f.En.TO&&n&&r.address&&r.networkId&&t&&t.network?.id===r.networkId?_objectSpread(_objectSpread({},o),{},{address:r.address,networkId:r.networkId,accountInfo:r.accountInfo,activeAccount:_objectSpread({},t)}):t?_objectSpread(_objectSpread({},o),{},{address:t.account?.address,networkId:t.network?.id,accountInfo:_objectSpread({},t),activeAccount:_objectSpread({},t)}):o}),[e,n,r,t])}function useSwapRecipientAddressInfo(e){var t=useSwapAddressInfo(f.En.FROM),n=useSwapAddressInfo(f.En.TO),[r]=(0,b.Zr)(),[{swapToAnotherAccountSwitchOn:a}]=(0,d.useSettingsAtom)(),[s]=(0,b.rv)(),i=(0,g.yk)((0,o.A)((function*(){return e?n.networkId&&t.accountInfo?.account?.id&&t.accountInfo?.indexedAccount?.id?yield w.A.serviceStaking.getEarnAccount({accountId:t.accountInfo?.account?.id,networkId:n.networkId,indexedAccountId:t.accountInfo?.indexedAccount?.id}):void 0:null})),[e,n.networkId,t.accountInfo?.account?.id,t.accountInfo?.indexedAccount?.id],{}),c=(0,g.yk)((0,o.A)((function*(){if(s.networkId&&s.address){var e=yield w.A.serviceAccount.getAccountNameFromAddress({networkId:s.networkId,address:s.address});if(e.length>0)return e[0]}})),[s.address,s.networkId],{});if(n.address===s.address&&a&&i?.result?.accountAddress&&i?.result?.accountAddress!==s.address&&s.networkId===r?.toTokenInfo.networkId)return{accountInfo:s.accountInfo?.account?.address===s.address?{walletName:s.accountInfo?.wallet?.name,accountName:s.accountInfo?.accountName,accountId:s.accountInfo?.account?.id}:c.result,showAddress:p.A.shortenAddress({address:s.address,leadingLength:6,trailingLength:6}),isExtAccount:s.accountInfo?.account?.address!==s.address&&!c.result}}},866063:(e,t,n)=>{n.d(t,{FI:()=>useSwapInit,GM:()=>useSwapTokenList,ZF:()=>useSwapSelectedTokenInfo});var r=n(324586),o=n(503668),a=n.n(o),s=n(586330),i=n(514041),c=n(241440),u=n(490343),d=n(153763),l=n(259227),p=n(625931),f=n(22937),w=n(392097),m=n(553083),g=n(734818),S=n(58546),b=n(619390),k=n(610421),v=n(317522),A=n(162616),I=n(325529),y=n(20322);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function useSwapInit(e){var[t,n]=(0,I.ZM)(),[r,o]=(0,I.NE)(),[c,d]=(0,I.Q8)(),[,f]=(0,l.useInAppNotificationAtom)(),{syncNetworksSort:g}=(0,I.eR)().current,T=(0,y.zf)(b.En.FROM),{updateSelectedAccountNetwork:h}=(0,A.z$)().current,[j,x]=(0,i.useState)(!0),[_,O]=(0,i.useState)(!1),E=(0,i.useRef)(),[C]=(0,I.sK)(),{swapTypeSwitchAction:M}=(0,I.eR)().current;E.current!==T&&(E.current=T);var P=(0,i.useRef)([]);P.current!==t&&(P.current=t);var R=(0,i.useRef)();R.current!==r&&(R.current=r);var $=(0,i.useRef)();$.current!==c&&($.current=c);var N=(0,i.useCallback)((0,s.A)((function*(){if(t.length)x(!1);else{var e=yield k.A.simpleDb.swapNetworksSort.getRawData();if(e?.data?.length){var r=e?.data.every((function(e){return a()(e.supportCrossChainSwap)&&a()(e.supportSingleSwap)}));r?(e=null,k.A.simpleDb.swapNetworksSort.setRawData({data:[]})):(n(e.data),x(!1))}var o=[],s=yield k.A.serviceSwap.fetchSwapNetworks();if(o=[...s],e?.data?.length&&s?.length){var i=e.data;o=i.filter((function(e){return s.find((function(t){return t.networkId===e.networkId}))})).map((function(e){var t=s.find((function(t){return t.networkId===e.networkId}));return _objectSpread(_objectSpread({},e),t)})).concat(s.filter((function(e){return!i.find((function(t){return t.networkId===e.networkId}))})))}o.length&&(yield k.A.simpleDb.swapNetworksSort.setRawData({data:o}),e?.data?.length&&e?.data?.length===o.length||(n(o),x(!1)))}})),[n,t.length]),D=(0,i.useCallback)((function(n,r){var o=t.find((function(e){return e.networkId===n.networkId})),a=[];if(o&&(o.supportSingleSwap&&(a=[...a,b.qX.SWAP]),o.supportCrossChainSwap&&(a=[...a,b.qX.BRIDGE])),!e?.swapTabSwitchType&&r&&a.length>0&&!a.includes(C)){var s,i=a.find((function(e){return e!==C}));if(i)M(i,null!=(s=E.current?.networkId)?s:R.current?.networkId)}return a}),[e?.swapTabSwitchType,t,C,M]),z=(0,i.useCallback)((0,s.A)((function*(){if(!R.current&&!$.current)if(e?.importFromToken&&P.current.find((function(t){return t.networkId===e?.importFromToken?.networkId}))||e?.importToToken&&P.current.find((function(t){return t.networkId===e?.importFromToken?.networkId}))){var t,n;if(e?.importFromToken){var r=D(e?.importFromToken);e?.swapTabSwitchType&&r.includes(e?.swapTabSwitchType)&&o(e?.importFromToken)}if(e?.importToToken){var s=D(e?.importToToken);e?.swapTabSwitchType&&s.includes(e?.swapTabSwitchType)&&d(e?.importToToken)}if(e?.importFromToken&&!e?.importToToken&&!e?.importFromToken?.isNative){var i=S.sI[e?.importFromToken.networkId];if(i){var c=D(i);e?.swapTabSwitchType&&c.includes(e?.swapTabSwitchType)&&d(i)}}g(null!=(t=null!=(n=e?.importFromToken?.networkId)?n:e?.importToToken?.networkId)?t:(0,p.V)().onekeyall)}else if(E.current?.accountInfo?.ready&&E.current?.networkId&&P.current.length&&(!e?.importNetworkId||!E.current?.networkId||e?.importNetworkId===E.current?.networkId)&&!_){var u=m.Ay.isAllNetwork({networkId:E.current?.networkId}),l=P.current.find((function(e){return e.networkId===E.current?.networkId})),f=l,w=l?.networkId;if(u){w=(0,p.V)().onekeyall;var b=S.TW[w]?.fromToken;f=P.current.find((function(e){return e.networkId===b?.networkId}))}if(f&&w&&(!a()(S.TW[w]?.fromToken)||!a()(S.TW[w]?.toToken))){var k=S.TW[w]?.fromToken,v=S.TW[w]?.toToken;k&&(o(_objectSpread(_objectSpread({},k),{},{networkLogoURI:u?k.networkLogoURI:f?.logoURI})),g(k.networkId)),v&&(d(_objectSpread(_objectSpread({},v),{},{networkLogoURI:u?v.networkLogoURI:f?.logoURI})),g(v.networkId)),k&&D(k,!0)}}})),[e?.importFromToken,e?.importToToken,e?.importNetworkId,e?.swapTabSwitchType,_,g,D,o,d]);(0,i.useEffect)((function(){(0,s.A)((function*(){yield k.A.serviceSwap.swapRecentTokenSync()}))()}),[f]),(0,i.useEffect)((function(){(0,s.A)((function*(){yield N()}))()}),[N,t.length]),(0,i.useEffect)((function(){(0,s.A)((function*(){e?.importNetworkId&&E.current?.networkId&&e?.importNetworkId!==E.current.networkId&&(yield h({num:0,networkId:e?.importNetworkId}))}))()}),[e?.importNetworkId,h]),(0,i.useEffect)((function(){(0,s.A)((function*(){yield z()}))()}),[T.accountInfo?.ready,t.length,T.networkId,e?.importFromToken,e?.importToToken,e?.importNetworkId]);var L=(0,u.usePageType)();return(0,v.A)(w.V4.Swap,(function(e,t){L!==u.EPageType.modal&&e&&O(!!t)})),{fetchLoading:j}}function useSwapTokenList(e,t,n){var[r,o]=(0,i.useState)([]),[{tokenCatch:a}]=(0,I.PQ)(),[u]=(0,I.Yb)(),[d,l]=(0,i.useState)([]),[p]=(0,I.ZM)(),[w]=(0,I.qv)(),{tokenListFetchAction:S,swapLoadAllNetworkTokenList:b}=(0,I.eR)().current,v=(0,y.zf)(e),[A]=(0,I.Hb)();(0,i.useEffect)((function(){(0,s.A)((function*(){var e,{swapSupportAccounts:t}=yield k.A.serviceSwap.getSupportSwapAllAccounts({indexedAccountId:v?.accountInfo?.indexedAccount?.id,otherWalletTypeAccountId:v?.accountInfo?.indexedAccount?.id?void 0:null!=(e=v?.accountInfo?.account?.id)?e:v?.accountInfo?.dbAccount?.id,swapSupportNetworks:p});l(t)}))()}),[v?.accountInfo?.account?.id,v?.accountInfo?.dbAccount?.id,v?.accountInfo?.indexedAccount?.id,p]);var T=(0,i.useMemo)((function(){var e=d.find((function(e){return e.networkId===t}));return v.networkId===t?{networkId:t,keywords:n,accountAddress:v?.address,accountNetworkId:v?.networkId,accountId:v?.accountInfo?.account?.id}:{networkId:t,keywords:n,accountAddress:e?.apiAddress,accountNetworkId:e?.networkId,accountId:e?.accountId}}),[t,v.networkId,v?.address,v?.accountInfo?.account?.id,d,n]),h=(0,i.useMemo)((function(){var e,t,n;return u[null!=(e=null!=(t=null!=(n=v?.accountInfo?.indexedAccount?.id)?n:v?.accountInfo?.account?.id)?t:v?.accountInfo?.dbAccount?.id)?e:"noAccountId"]}),[u,v?.accountInfo?.indexedAccount?.id,v?.accountInfo?.account?.id,v?.accountInfo?.dbAccount?.id]),j=(0,i.useCallback)((function(e){var t=e.filter((function(e){var t,n=new c.A(null!=(t=e.price)?t:"0");return!n.isNaN()&&!n.isZero()}))?.sort((function(e,t){var n,r,o=new c.A(null!=(n=e.fiatValue)?n:"0");return new c.A(null!=(r=t.fiatValue)?r:"0").comparedTo(o)})),n=e.filter((function(e){var t,n=new c.A(null!=(t=e.price)?t:"0");return n.isNaN()||n.isZero()}))?.sort((function(e,t){var n,r,o=new c.A(null!=(n=e.fiatValue)?n:"0");return new c.A(null!=(r=t.fiatValue)?r:"0").comparedTo(o)}));return[...t,...n]}),[]),x=(0,i.useCallback)((function({swapAllNetRecommend:e,swapSearchTokens:t}){var n,r;if(e?.length&&!h)return[];var o=null!=(n=h?.map((function(e){var t=p.find((function(t){return t.networkId===e.networkId}));return t?_objectSpread(_objectSpread({},e),{},{networkLogoURI:t.logoURI}):e}))?.filter((function(e){return w.find((function(t){return t.networkId===e.networkId}))})))?n:[],a=null!=(r=o?.filter((function(e){var t,n=new c.A(null!=(t=e?.balanceParsed)?t:"0");return!n.isNaN()&&!n.isZero()})))?r:[];if(e){var s,i=null!=(s=e?.filter((function(e){return!a?.find((function(t){return(0,g.BQ)({token1:{networkId:t?.networkId,contractAddress:t?.contractAddress},token2:{networkId:e?.networkId,contractAddress:e?.contractAddress}})}))}))?.filter((function(e){return w.find((function(t){return t.networkId===e.networkId}))})))?s:[],u=[...a,...i];return j(null!=u?u:[])}if(t){var d=t.map((function(e){if(w.find((function(t){return t.networkId===e.networkId}))){var t=a.find((function(t){return t?.contractAddress===e?.contractAddress&&t?.networkId===e?.networkId}));return t||e}})).filter((function(e){return e}));return j(null!=d?d:[])}return[]}),[j,h,p,w]),_=(0,f.bJ)(m.Ay.isAllNetwork({networkId:T.networkId})&&n?x({swapSearchTokens:a?.[JSON.stringify(T)]?.data||[]}):a?.[JSON.stringify(T)]?.data||[],{shouldSort:!1,keys:["symbol","contractAddress"]}),O=(0,i.useRef)(_);return O.current!==_&&(O.current=_),(0,i.useEffect)((function(){var e;T.networkId&&!n&&m.Ay.isAllNetwork({networkId:T.networkId})&&b(v?.accountInfo?.indexedAccount?.id,v?.accountInfo?.indexedAccount?.id?void 0:null!=(e=v?.accountInfo?.account?.id)?e:v?.accountInfo?.dbAccount?.id);S(T)}),[v?.accountInfo?.account?.id,v?.accountInfo?.dbAccount?.id,v?.accountInfo?.indexedAccount?.id,b,T,S,n]),(0,i.useEffect)((function(){n&&O.current?o(O.current.search(n)):o(m.Ay.isAllNetwork({networkId:T.networkId})?x({swapAllNetRecommend:a?.[JSON.stringify(T)]?.data||[]}):a?.[JSON.stringify(T)]?.data||[])}),[a,T,t,n,x]),{fetchLoading:A&&0===r.length||m.Ay.isAllNetwork({networkId:T.networkId})&&!h,currentTokens:r}}function useSwapSelectedTokenInfo({token:e,type:t}){var n=(0,y.zf)(t),[r,o]=(0,i.useState)(0),[{swapHistoryPendingList:a}]=(0,l.useInAppNotificationAtom)(),{loadSwapSelectTokenDetail:s}=(0,I.eR)().current,c=(0,i.useRef)(a);c.current!==a&&(c.current=a);var p=(0,i.useRef)(r);p.current!==r&&(p.current=r);var f=(0,i.useRef)(n);f.current!==n&&(f.current=n);var m=(0,d.E)(),g=(0,i.useRef)(m);g.current!==m&&(g.current=m),(0,i.useEffect)((function(){if(g.current&&a.length){var e=a.filter((function(e){return e.status===b.lr.SUCCESS})).length;e>p.current&&(s(t,f.current,!0),o(e))}}),[s,a,t]),(0,i.useEffect)((function(){s(t,f.current,!e?.reservationValue&&e?.isNative)}),[t,n,e?.networkId,e?.contractAddress,s,e?.reservationValue,e?.isNative]);var S=(0,u.usePageType)();(0,v.A)(w.V4.Swap,(function(e,n){if(S!==u.EPageType.modal&&e&&!n&&c.current.length){var r=c.current.filter((function(e){return e.status===b.lr.SUCCESS})).length;r>p.current&&(s(t,f.current,!0),o(r))}}))}},309008:(e,t,n)=>{n.d(t,{o:()=>d});var r=n(324586),o=n(514041),a=n(325529),s=n(2577),i=n(597102),c=n(829561),u=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=(0,o.memo)((function(e){var{children:t,storeName:n}=e,r=(0,c.x6)(n),o=s.A.getOrCreateStore(r);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(i.H,_objectSpread({},r)),(0,u.jsx)(a.BY,{store:o,children:t})]})}));d.displayName="SwapProviderMirror"},797791:(e,t,n)=>{n.d(t,{A:()=>SwapMainLand});var r=n(324586),o=n(586330),a=n(514041),s=n(490343),i=n(498356),c=n(325529),u=n(259227),d=n(392097),l=n(628380),p=n(58546),f=n(619390),w=n(241440),m=n(908867),g=n(17617),S=n(334439),b=n(831085);const k=(0,a.memo)((function({onSelectTokenPairs:e,tokenPairs:t,fromTokenAmount:n}){var r=(0,m.A)(),[o,i]=(0,a.useState)(!1),[u]=(0,c.sK)(),d=new w.A(null!=n?n:0),l=(0,a.useMemo)((function(){return u===f.qX.BRIDGE?t?.filter((function(e){return e.fromToken.networkId!==e.toToken.networkId})):u===f.qX.SWAP?t?.filter((function(e){return e.toToken.networkId===e.fromToken.networkId})):[]}),[u,t]),p=(0,a.useCallback)((function(){var t=!o&&l.length>=6?l.slice(0,5):l;return(0,b.jsx)(s.XStack,{pt:"$1",pb:"$3",gap:"$1.5",flexWrap:"wrap",children:(0,b.jsxs)(b.Fragment,{children:[t.map((function(t,n){return(0,b.jsx)(s.XStack,{role:"button",userSelect:"none",alignItems:"center",px:"$2",py:"$1",bg:"$bg",borderRadius:"$4",borderWidth:g.A.hairlineWidth,borderColor:"$borderSubdued",hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusable:!0,focusVisibleStyle:{outlineColor:"$focusRing",outlineStyle:"solid",outlineWidth:2,outlineOffset:2},onPress:function(){e(t)},children:(0,b.jsx)(s.SizableText,{size:"$bodyMdMedium",children:`${t.fromToken.symbol}/${t.toToken.symbol}`})},n)})),l.length>=6?(0,b.jsx)(s.Stack,{role:"button",userSelect:"none",alignItems:"center",px:"$1.5",py:"$1",bg:"$bg",borderRadius:"$4",borderWidth:g.A.hairlineWidth,borderColor:"$borderSubdued",hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusable:!0,focusVisibleStyle:{outlineColor:"$focusRing",outlineStyle:"solid",outlineWidth:2,outlineOffset:2},onPress:function(){i(!o)},children:(0,b.jsx)(s.Stack,{animation:"quick",justifyContent:"center",alignItems:"center",rotate:o?"180deg":"0deg",children:(0,b.jsx)(s.Icon,{name:"ChevronDownSmallOutline",color:o?"$iconActive":"$iconSubdued",size:"$5"})})},"more-token-pairs"):null]})})}),[e,o,l]);return(d.isZero()||d.isNaN())&&l?.length?(0,b.jsxs)(s.YStack,{gap:"$1",children:[(0,b.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:r.formatMessage({id:S.ETranslations.swap_page_recent_trade})}),p()]}):null}));var v=n(20322),A=n(583354),I=n(948675),y=n(491180),T=n(403144),h=n(610421),j=n(927799);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function useSwapBuildTx(){var e,t,n,r,i,d,[l]=(0,c.NE)(),[m]=(0,c.Q8)(),[{slippageItem:g}]=(0,c.H_)(),[S]=(0,c.Zr)(),[,b]=(0,c.mA)(),[,k]=(0,c.vS)(),[,x]=(0,c.sh)(),[_,O]=(0,u.useInAppNotificationAtom)(),[E]=(0,u.useSettingsPersistAtom)(),[,C]=(0,c.VS)(),[,M]=(0,c.oz)(),P=(0,v.zf)(f.En.FROM),R=(0,v.zf)(f.En.TO),{generateSwapHistoryItem:$}=function useSwapTxHistoryActions(){var e,[t]=(0,c.ZM)(),[,n]=(0,c.NE)(),[,r]=(0,c.Q8)(),[,s]=(0,c.VS)(),[i]=(0,u.useSettingsPersistAtom)(),d=(0,a.useCallback)((e=(0,o.A)((function*({txId:e,gasFeeInNative:n,gasFeeFiatValue:r,swapTxInfo:o}){if(o){var a,s,c,u={status:f.lr.PENDING,currency:i.currencyInfo.symbol,baseInfo:{toAmount:o.receiver.amount,fromAmount:o.sender.amount,fromToken:o.sender.token,toToken:o.receiver.token,fromNetwork:t.find((function(e){return e?.networkId===o.sender.token.networkId})),toNetwork:t.find((function(e){return e?.networkId===o.receiver.token.networkId}))},txInfo:{txId:e,gasFeeFiatValue:r,gasFeeInNative:n,orderId:o.swapBuildResData.swftOrder?.orderId,sender:o.accountAddress,receiver:o.receivingAddress},date:{created:Date.now(),updated:Date.now()},swapInfo:{instantRate:null!=(a=o.swapBuildResData.result.instantRate)?a:"0",provider:o.swapBuildResData.result.info,socketBridgeScanUrl:o.swapBuildResData.socketBridgeScanUrl,oneKeyFee:null!=(s=o.swapBuildResData.result.fee?.percentageFee)?s:0,protocolFee:null!=(c=o.swapBuildResData.result.fee?.protocolFees)?c:0,orderId:o.swapBuildResData.orderId,supportUrl:o.swapBuildResData.result.supportUrl},ctx:o.swapBuildResData.ctx};yield h.A.serviceSwap.addSwapHistoryItem(u)}})),function(t){return e.apply(this,arguments)}),[i.currencyInfo.symbol,t]);return{generateSwapHistoryItem:d,swapAgainUseHistoryItem:(0,a.useCallback)((function(e){n(e?.baseInfo.fromToken),r(e?.baseInfo.toToken),s(e?.baseInfo.fromAmount)}),[n,s,r])}}(),[{isFirstTimeSwap:N},D]=(0,u.useSettingsPersistAtom)(),{navigationToSendConfirm:z}=(0,j.E)({accountId:null!=(e=P.accountInfo?.account?.id)?e:"",networkId:null!=(t=P.networkId)?t:""}),L=(0,s.usePageType)(),F=(0,a.useCallback)((n=(0,o.A)((function*({swapFromToken:e,swapToToken:t}){yield h.A.serviceSwap.swapRecentTokenPairsUpdate({fromToken:e,toToken:t})})),function(e){return n.apply(this,arguments)}),[]),B=(0,a.useCallback)((r=(0,o.A)((function*(e){if(e?.[0]){C(""),b([]),k(0);var t=e[0].signedTx,n=e[0].decodedTx,r=t.txid,{swapInfo:o}=t,{totalFeeInNative:a,totalFeeFiatValue:s,networkId:i}=n;o&&(yield $({txId:r,gasFeeFiatValue:s,gasFeeInNative:a,swapTxInfo:o}),o.sender.token.networkId===o.receiver.token.networkId&&h.A.serviceNotification.blockNotificationForTxId({networkId:i,tx:r}))}x(!1)})),function(e){return r.apply(this,arguments)}),[$,x,C,b,k]),H=(0,a.useCallback)((i=(0,o.A)((function*(e){if(e?.[0]){var t=e[0].signedTx.txid;_.swapApprovingTransaction&&!_.swapApprovingTransaction.resetApproveValue&&h.A.serviceNotification.blockNotificationForTxId({networkId:_.swapApprovingTransaction.fromToken.networkId,tx:t}),O((function(e){return e.swapApprovingTransaction?_objectSpread(_objectSpread({},e),{},{swapApprovingTransaction:_objectSpread(_objectSpread({},e.swapApprovingTransaction),{},{txId:t})}):e}))}})),function(e){return i.apply(this,arguments)}),[_.swapApprovingTransaction,O]),W=(0,a.useCallback)((function(){x(!1)}),[x]),V=(0,a.useCallback)((function(){W(),M(!0)}),[W,M]),U=(0,a.useCallback)((function(){W(),O((function(e){return e.swapApprovingTransaction?_objectSpread(_objectSpread({},e),{},{swapApprovingTransaction:_objectSpread(_objectSpread({},e.swapApprovingTransaction),{},{status:f.MG.CANCEL})}):e}))}),[W,O]),q=(0,a.useCallback)((0,o.A)((function*(){if(l&&m&&S?.fromAmount&&S?.toAmount&&P.address&&R.address&&P.networkId){x(!0);var e=l.isNative?A.D.DEPOSIT:A.D.WITHDRAW,t={from:P.address,type:e,contract:e===A.D.WITHDRAW?l.contractAddress:m.contractAddress,amount:S?.fromAmount},n={sender:{amount:S?.fromAmount,token:l},receiver:{amount:S.toAmount,token:m},accountAddress:P.address,receivingAddress:R.address,swapBuildResData:{result:S}};yield z({wrappedInfo:t,swapInfo:n,onSuccess:B,onCancel:W}),F({swapFromToken:l,swapToToken:m})}})),[l,m,S,P.address,P.networkId,R.address,x,z,B,W,F]),Q=(0,a.useCallback)((0,o.A)((function*(){if(l&&m&&S?.fromAmount&&g&&S?.toAmount&&P.address&&R.address&&P.networkId){try{var e=yield h.A.serviceSwap.fetchBuildTx({fromToken:l,toToken:m,toTokenAmount:S.toAmount,fromTokenAmount:S.fromAmount,slippagePercentage:g.value,receivingAddress:R.address,userAddress:P.address,provider:S?.info.provider,accountId:P.accountInfo?.account?.id,quoteResultCtx:S?.quoteResultCtx});if(e){var t,n,r,o,a;if(e?.swftOrder)o=void 0,r={from:P.address,tokenInfo:_objectSpread(_objectSpread({},e.result.fromTokenInfo),{},{isNative:!!e.result.fromTokenInfo.isNative,address:e.result.fromTokenInfo.contractAddress,name:null!=(a=e.result.fromTokenInfo.name)?a:e.result.fromTokenInfo.symbol}),to:e.swftOrder.platformAddr,amount:e.swftOrder.depositCoinAmt,memo:e.swftOrder.memo};else if(e?.changellyOrder){var s;o=void 0,r={from:P.address,tokenInfo:_objectSpread(_objectSpread({},e.result.fromTokenInfo),{},{isNative:!!e.result.fromTokenInfo.isNative,address:e.result.fromTokenInfo.contractAddress,name:null!=(s=e.result.fromTokenInfo.name)?s:e.result.fromTokenInfo.symbol}),to:e.changellyOrder.payinAddress,amount:e.changellyOrder.amountExpectedFrom,memo:e.changellyOrder.payinExtraId}}else if(e?.thorSwapCallData){var i;o=void 0,r={from:P.address,tokenInfo:_objectSpread(_objectSpread({},e.result.fromTokenInfo),{},{isNative:!!e.result.fromTokenInfo.isNative,address:e.result.fromTokenInfo.contractAddress,name:null!=(i=e.result.fromTokenInfo.name)?i:e.result.fromTokenInfo.symbol}),to:e.thorSwapCallData.vault,opReturn:e.thorSwapCallData.hasStreamingSwap?e.thorSwapCallData.memoStreamingSwap:e.thorSwapCallData.memo,amount:new w.A(e.thorSwapCallData.amount).shiftedBy(-l.decimals).toFixed()}}else if(e?.tx)if(r=void 0,"string"!=typeof e.tx&&e.tx.data){var c,u=(0,T.Si)(new w.A(null!=(c=e.tx.value)?c:0));o=_objectSpread(_objectSpread({},e?.tx),{},{value:u,from:P.address})}else o=e.tx;var d=new w.A(null!=(t=e.result?.gasLimit)?t:0),p=new w.A(null!=(n=S?.gasLimit)?n:0);return!d.isNaN()&&!d.isZero()||p.isNaN()||p.isZero()||(e.result.gasLimit=p.toNumber()),!e.result?.routesData?.length&&S?.routesData?.length&&(e.result.routesData=S.routesData),{swapInfo:{sender:{amount:S.fromAmount,token:l},receiver:{amount:S.toAmount,token:m},accountAddress:P.address,receivingAddress:R.address,swapBuildResData:e},transferInfo:r,encodedTx:o}}}catch(e){}return null}})),[l,S?.fromAmount,S?.gasLimit,S?.info.provider,S?.quoteResultCtx,S?.routesData,S?.toAmount,g,P.accountInfo?.account?.id,P.address,P.networkId,R.address,m]),K=(0,a.useCallback)((d=(0,o.A)((function*(e,t,n){var r,a=S?.allowanceResult;if(a&&l&&m&&P.networkId&&P.accountInfo?.account?.id&&P.address)if(E.swapBatchApproveAndSwap)try{var i;x(!0);var c=[],u={owner:P.address,spender:a.allowanceTarget,amount:e,isMax:!n&&t,tokenInfo:_objectSpread(_objectSpread({},l),{},{isNative:!!l.isNative,address:l.contractAddress,name:null!=(i=l.name)?i:l.symbol})};if(c=[u],n&&e===p.XU){var d,w={owner:P.address,spender:a.allowanceTarget,amount:n,isMax:t,tokenInfo:_objectSpread(_objectSpread({},l),{},{isNative:!!l.isNative,address:l.contractAddress,name:null!=(d=l.name)?d:l.symbol})};c=[...c,w]}var b,k,v=yield Q();v?(y.A.isHwAccount({accountId:P.accountInfo.account.id})||y.A.isOthersAccount({accountId:P.accountInfo.account.id})?yield z({approvesInfo:[c[0]],onSuccess:(r=(0,o.A)((function*(e){var t;c.length>1?yield z({approvesInfo:[c[1]],feeInfo:e?.[0]?.feeInfo,onSuccess:(t=(0,o.A)((function*(e){yield z({transfersInfo:v.transferInfo?[v.transferInfo]:void 0,encodedTx:v.encodedTx,feeInfo:e?.[0]?.feeInfo,swapInfo:v.swapInfo,onSuccess:B,onCancel:V})})),function onSuccess(e){return t.apply(this,arguments)}),onCancel:V}):yield z({transfersInfo:v.transferInfo?[v.transferInfo]:void 0,encodedTx:v.encodedTx,swapInfo:v.swapInfo,feeInfo:e?.[0]?.feeInfo,onSuccess:B,onCancel:V})})),function onSuccess(e){return r.apply(this,arguments)}),onCancel:V}):yield z({transfersInfo:v.transferInfo?[v.transferInfo]:void 0,encodedTx:v.encodedTx,swapInfo:v.swapInfo,approvesInfo:c,onSuccess:B,onCancel:V}),F({swapFromToken:l,swapToToken:m}),I.U.swap.createSwapOrder.swapCreateOrder({swapProvider:S?.info.provider,swapProviderName:S?.info.providerName,swapType:f.If.SWAP,slippage:g.value.toString(),sourceChain:l.networkId,receivedChain:m.networkId,sourceTokenSymbol:l.symbol,receivedTokenSymbol:m.symbol,feeType:null!=(b=S?.fee?.percentageFee?.toString())?b:"0",router:JSON.stringify(null!=(k=S?.routesData)?k:""),isFirstTime:N,createFrom:L===s.EPageType.modal?"modal":"swapPage"}),D((function(e){return _objectSpread(_objectSpread({},e),{},{isFirstTimeSwap:!1})}))):(x(!1),M(!0))}catch(e){x(!1),M(!0)}else try{var A;x(!0);var T={owner:P.address,spender:a.allowanceTarget,amount:e,isMax:!n&&t,tokenInfo:_objectSpread(_objectSpread({},l),{},{isNative:!!l.isNative,address:l.contractAddress,name:null!=(A=l.name)?A:l.symbol})};O((function(r){var o;return _objectSpread(_objectSpread({},r),{},{swapApprovingTransaction:{provider:S?.info.provider,fromToken:l,toToken:m,amount:e,useAddress:null!=(o=P.address)?o:"",spenderAddress:a.allowanceTarget,status:f.MG.PENDING,resetApproveValue:n,resetApproveIsMax:t}})})),yield z({approvesInfo:[T],onSuccess:H,onCancel:U})}catch(e){x(!1)}})),function(e,t,n){return d.apply(this,arguments)}),[S?.allowanceResult,S?.info.provider,S?.info.providerName,S?.fee?.percentageFee,S?.routesData,l,m,P.networkId,P.accountInfo?.account?.id,P.address,E.swapBatchApproveAndSwap,x,Q,z,B,V,F,g.value,N,L,D,M,O,H,U]);return{buildTx:(0,a.useCallback)((0,o.A)((function*(){if(l&&m&&S?.fromAmount&&g&&S?.toAmount&&P.address&&R.address&&P.networkId){x(!0);var e=yield Q();try{var t,n;if(e)yield z({transfersInfo:e.transferInfo?[e.transferInfo]:void 0,encodedTx:e.encodedTx,swapInfo:e.swapInfo,onSuccess:B,onCancel:V}),F({swapFromToken:l,swapToToken:m}),I.U.swap.createSwapOrder.swapCreateOrder({swapProvider:S?.info.provider,swapProviderName:S?.info.providerName,swapType:f.If.SWAP,slippage:g.value.toString(),sourceChain:l.networkId,receivedChain:m.networkId,sourceTokenSymbol:l.symbol,receivedTokenSymbol:m.symbol,feeType:null!=(t=S?.fee?.percentageFee?.toString())?t:"0",router:JSON.stringify(null!=(n=S?.routesData)?n:""),isFirstTime:N,createFrom:L===s.EPageType.modal?"modal":"swapPage"}),D((function(e){return _objectSpread(_objectSpread({},e),{},{isFirstTimeSwap:!1})}));else x(!1),M(!0)}catch(e){x(!1),M(!0)}}})),[l,m,S?.fromAmount,S?.toAmount,S?.info.provider,S?.info.providerName,S?.fee?.percentageFee,S?.routesData,g,P.address,P.networkId,R.address,x,Q,z,B,V,F,N,L,D,M]),wrappedTx:q,approveTx:K}}var x=n(153763),_=n(82506);function useSwapQuoteLoading(){var[e]=(0,c.iA)(),[t]=(0,c.I4)();return e||t}function useSwapQuoteEventFetching(){var[e]=(0,c.vS)(),[t]=(0,c.mA)();return e>0&&t.length<e}function useSwapActionState(){var e=(0,m.A)(),t=useSwapQuoteLoading(),n=useSwapQuoteEventFetching(),[r]=(0,c.Zr)(),[o]=(0,c.sh)(),[s]=(0,c.VS)(),[i]=(0,c.NE)(),[d]=(0,c.Q8)(),[l]=(0,u.useSettingsPersistAtom)(),[g]=(0,c.oz)(),[b]=(0,c.rE)();!function useSwapWarningCheck(){var e=(0,v.zf)(f.En.FROM),t=(0,v.zf)(f.En.TO),[n]=(0,c.NE)(),[r]=(0,c.Q8)(),[o]=(0,c.Zr)(),[s]=(0,c.VS)(),[i]=(0,c.kz)(),{checkSwapWarning:u}=(0,c.eR)().current,d=(0,a.useRef)({swapFromAddressInfo:{address:void 0,networkId:void 0,accountInfo:void 0,activeAccount:void 0},swapToAddressInfo:{address:void 0,networkId:void 0,accountInfo:void 0,activeAccount:void 0}}),l=(0,x.E)(),p=(0,a.useCallback)((function(){d.current.swapFromAddressInfo!==e&&(d.current.swapFromAddressInfo=e),d.current.swapToAddressInfo!==t&&(d.current.swapToAddressInfo=t)}),[e,t]);(0,a.useEffect)((function(){l&&(p(),u(d.current.swapFromAddressInfo,d.current.swapToAddressInfo))}),[p,u,n,s,r,i,o,l])}();var[k]=(0,c.LX)(),[A]=(0,c.kz)(),I=i?.networkId!==d?.networkId,y=(0,v.zf)(f.En.FROM),T=(0,v.zf)(f.En.TO),[h]=(0,c.SR)(),j=h>p.si||g,O=k.states.some((function(e){return e.alertLevel===f.HM.ERROR})),E=(0,a.useMemo)((function(){return r&&(r.fromTokenInfo.networkId!==i?.networkId||r.toTokenInfo.networkId!==d?.networkId||r.fromTokenInfo.contractAddress!==i?.contractAddress||r.toTokenInfo.contractAddress!==d?.contractAddress)||r?.allowanceResult&&r.allowanceResult.amount!==s}),[i?.contractAddress,i?.networkId,s,r,d?.contractAddress,d?.networkId]),C=(0,_.d)(E,10),M=(0,a.useMemo)((function(){var o={disable:!(!O&&r),label:e.formatMessage({id:S.ETranslations.swap_page_swap_button})};if(y.address&&T.address&&r?.fromAmount===s||(o.disable=!0),t||n)o.label=e.formatMessage({id:S.ETranslations.swap_page_button_fetching_quotes});else{I&&i&&d&&(o.label=e.formatMessage({id:S.ETranslations.swap_page_button_cross_chain})),r&&r.isWrapped&&(o.label=e.formatMessage({id:S.ETranslations.swap_page_button_wrap})),r&&r.allowanceResult&&(o.label=e.formatMessage({id:l.swapBatchApproveAndSwap?S.ETranslations.swap_page_approve_and_swap:S.ETranslations.global_approve})),!r||r.toAmount||r.limit||(o.label=e.formatMessage({id:S.ETranslations.swap_page_alert_no_provider_supports_trade}),o.disable=!0),r&&r.toAmount&&!T.address&&(o.label=e.formatMessage({id:S.ETranslations.swap_page_button_enter_a_recipient}),o.disable=!0);var a=new w.A(null!=A?A:0),c=new w.A(s);i&&y.address&&a.lt(c)&&(o.label=e.formatMessage({id:S.ETranslations.swap_page_button_insufficient_balance}),o.disable=!0),i&&d||(o.label=e.formatMessage({id:S.ETranslations.swap_page_button_select_token}),o.disable=!0),s||(o.label=e.formatMessage({id:S.ETranslations.swap_page_button_enter_amount}),o.disable=!0),(j||C)&&(o.label=e.formatMessage({id:S.ETranslations.swap_page_button_refresh_quotes}),o.disable=!1)}return o}),[i,s,O,e,I,j,r,n,t,C,A,l.swapBatchApproveAndSwap,y.address,T.address,d]);return{label:M.label,isLoading:o,disabled:M.disable||t||n,approveUnLimit:b,isApprove:!!r?.allowanceResult,isCrossChain:I,shoutResetApprove:!!r?.allowanceResult?.shouldResetApprove,isWrapped:!!r?.isWrapped,isRefreshQuote:(j||C)&&!t&&!n}}var O=n(866063),E=n(309008),C=n(117746);function SwapActionsState_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SwapActionsState_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapActionsState_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapActionsState_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const M=(0,a.memo)((function({onBuildTx:e,onApprove:t,onWrapped:n}){var r=(0,m.A)(),[o]=(0,c.NE)(),[i]=(0,c.Q8)(),[d]=(0,c.VS)(),[l]=(0,c.Zr)(),p=(0,v.zf)(f.En.FROM),{cleanQuoteInterval:w,quoteAction:g}=(0,c.eR)().current,k=useSwapActionState(),[{swapEnableRecipientAddress:A}]=(0,u.useSettingsPersistAtom)(),I=(0,v.Gr)(A),y=useSwapQuoteLoading(),[{swapBatchApproveAndSwap:T}]=(0,u.useSettingsPersistAtom)(),h=(0,a.useCallback)((function(){k.shoutResetApprove?s.Dialog.confirm({onConfirmText:r.formatMessage({id:S.ETranslations.global_continue}),onConfirm:function(){t(d,k.approveUnLimit,!0)},showCancelButton:!0,title:r.formatMessage({id:S.ETranslations.swap_page_provider_approve_usdt_dialog_title}),description:r.formatMessage({id:S.ETranslations.swap_page_provider_approve_usdt_dialog_content}),icon:"ErrorOutline"}):t(d,k.approveUnLimit)}),[d,r,t,k.approveUnLimit,k.shoutResetApprove]),j=(0,s.usePageType)(),{md:x}=(0,s.useMedia)(),_=(0,a.useCallback)((function(){if(k.isRefreshQuote)g(p?.address,p?.accountInfo?.account?.id);else{if(w(),k.isApprove)return void h();if(k.isWrapped)return void n();e()}}),[w,h,e,n,g,k.isApprove,k.isRefreshQuote,k.isWrapped,p?.accountInfo?.account?.id,p?.address]),O=(0,a.useCallback)((function(){var e,t,n;!k.isRefreshQuote&&l?.quoteShowTip?s.Dialog.confirm({onConfirmText:r.formatMessage({id:S.ETranslations.global_continue}),onConfirm:function(){_()},title:null!=(e=l?.quoteShowTip.title)?e:"",description:null!=(t=l.quoteShowTip.detail)?t:"",icon:null!=(n=l?.quoteShowTip.icon)?n:"ChecklistBoxOutline",renderContent:l.quoteShowTip?.link?(0,b.jsx)(s.Button,{variant:"tertiary",size:"small",alignSelf:"flex-start",icon:"QuestionmarkOutline",onPress:function(){l.quoteShowTip?.link&&(0,C.Dr)(l.quoteShowTip?.link)},children:r.formatMessage({id:S.ETranslations.global_learn_more})}):void 0}):_()}),[l?.quoteShowTip,r,_,k.isRefreshQuote]),E=(0,a.useMemo)((function(){return A&&I?.showAddress&&o&&i&&l?.toTokenInfo.networkId===i.networkId}),[A,l?.toTokenInfo.networkId,o,I?.showAddress,i]),M=(0,a.useMemo)((function(){var e;return!k.isApprove||T||y?null:(0,b.jsxs)(s.XStack,SwapActionsState_objectSpread(SwapActionsState_objectSpread({gap:"$1"},j!==s.EPageType.modal||x?{pb:"$5"}:{}),{},{children:[(0,b.jsx)(s.Popover,{title:r.formatMessage({id:S.ETranslations.global_approve}),placement:"top-start",renderContent:(0,b.jsx)(s.SizableText,{size:"$bodyLg",$gtMd:{size:"$bodyMd",pt:"$5"},pb:"$5",px:"$5",children:r.formatMessage({id:S.ETranslations.swap_page_swap_steps_1_approve_dialog})}),renderTrigger:(0,b.jsxs)(s.XStack,{userSelect:"none",hoverStyle:{opacity:.5},children:[(0,b.jsx)(s.SizableText,{size:"$bodyMdMedium",pr:"$1",children:r.formatMessage({id:S.ETranslations.swap_page_swap_steps_1},{tokenSymbol:null!=(e=o?.symbol)?e:""})}),(0,b.jsx)(s.Icon,{size:"$5",color:"$iconSubdued",name:"QuestionmarkOutline"})]})}),(0,b.jsx)(s.Icon,{name:"ArrowRightOutline",size:"$5",color:"$iconSubdued"}),(0,b.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:r.formatMessage({id:S.ETranslations.swap_page_swap_steps_2})})]}))}),[o?.symbol,T,r,x,j,y,k.isApprove]),P=(0,a.useMemo)((function(){return k.isApprove&&!T?null:E?(0,b.jsxs)(s.XStack,SwapActionsState_objectSpread(SwapActionsState_objectSpread({gap:"$1"},j!==s.EPageType.modal||x?{pb:"$4"}:{flex:1}),{},{children:[(0,b.jsx)(s.Stack,{children:(0,b.jsx)(s.Icon,{name:"AddedPeopleOutline",w:"$5",h:"$5"})}),(0,b.jsxs)(s.XStack,{flex:1,flexWrap:"wrap",gap:"$1",children:[(0,b.jsx)(s.SizableText,{flexShrink:0,size:"$bodyMd",color:"$textSubdued",children:r.formatMessage({id:S.ETranslations.swap_page_recipient_send_to})}),(0,b.jsx)(s.SizableText,{flexShrink:0,size:"$bodyMd",children:I?.showAddress}),(0,b.jsx)(s.SizableText,{numberOfLines:1,flexShrink:0,size:"$bodyMd",color:"$textSubdued",children:`(${I?.isExtAccount?r.formatMessage({id:S.ETranslations.swap_page_recipient_external_account}):`${null!=(e=I?.accountInfo?.walletName)?e:""}-${null!=(t=I?.accountInfo?.accountName)?t:""}`})`})]})]})):null;var e,t}),[k.isApprove,T,E,j,x,r,I?.showAddress,I?.accountInfo?.walletName,I?.accountInfo?.accountName,I?.isExtAccount]),R=(0,a.useMemo)((function(){return(0,b.jsxs)(s.Stack,SwapActionsState_objectSpread(SwapActionsState_objectSpread({flex:1},j!==s.EPageType.modal||x?{}:{flexDirection:"row",justifyContent:E?"space-between":"flex-end",alignItems:"center"}),{},{children:[M,P,(0,b.jsx)(s.Button,{onPress:O,size:j!==s.EPageType.modal||x?"large":"medium",variant:"primary",disabled:k.disabled||k.isLoading,loading:k.isLoading,children:k.label})]}))}),[M,x,O,j,P,E,k.disabled,k.isLoading,k.label]);return(0,b.jsx)(s.YStack,{p:"$5",children:j===s.EPageType.modal||x?(0,b.jsx)(s.Page.Footer,SwapActionsState_objectSpread(SwapActionsState_objectSpread({},j!==s.EPageType.modal||x?{}:{buttonContainerProps:{flex:1}}),{},{confirmButton:R})):R})}));var P=n(353203);function SwapAlertContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SwapAlertContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapAlertContainer_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapAlertContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const R=(0,a.memo)((function({alerts:e}){var t,n=(0,a.useMemo)((function(){return e?.sort((function(e){return e.alertLevel===f.HM.ERROR?-1:e.alertLevel===f.HM.INFO?0:1}))}),[e]),[r]=(0,c.WC)(),i=(0,m.A)(),[d,l]=(0,u.useAccountManualCreatingAtom)(),{createAddress:p}=(0,P.m)(),[w,g]=(0,a.useState)(!1),k=(0,a.useCallback)((t=(0,o.A)((function*(e){if(e?.actionType===f.jb.CREATE_ADDRESS&&e.actionData?.account)try{var t;l((function(t){return SwapAlertContainer_objectSpread(SwapAlertContainer_objectSpread({},t),{},{key:e?.actionData?.key,isLoading:!0})})),yield p({num:null!=(t=e?.actionData?.num)?t:0,account:e?.actionData?.account,selectAfterCreate:!1}),s.Toast.success({title:i.formatMessage({id:S.ETranslations.swap_page_toast_address_generated})}),g(!1)}catch(e){s.Toast.error({title:i.formatMessage({id:S.ETranslations.swap_page_toast_address_generated_fail})}),g(!0)}finally{l((function(t){return SwapAlertContainer_objectSpread(SwapAlertContainer_objectSpread({},t),{},{key:e?.actionData?.key,isLoading:!1})}))}})),function(e){return t.apply(this,arguments)}),[p,i,l]),v=(0,a.useMemo)((function(){return n?.some((function(e){return e.alertLevel===f.HM.ERROR}))}),[n]),A=(0,a.useCallback)((function(e){return e===f.HM.ERROR?"critical":e===f.HM.WARNING?"warning":"default"}),[]),I=(0,a.useCallback)((function(e,t){var n,{alertLevel:o,title:a,icon:i,message:c,action:u}=e;return u?.actionType!==f.jb.CREATE_ADDRESS||u?.actionData?.key!==d.key||d.isLoading||w?(r.from||r.to)&&u?.actionType===f.jb.TOKEN_DETAIL_FETCHING||v&&e.alertLevel!==f.HM.ERROR&&e.action?.actionType!==f.jb.CREATE_ADDRESS?null:(0,b.jsx)(s.Alert,{type:A(o),title:a,icon:i,description:c,action:u?.actionLabel?{primary:null!=(n=u?.actionLabel)?n:"",onPrimaryPress:function(){k(u)},isPrimaryLoading:d.key===u?.actionData?.key&&d.isLoading}:void 0},t):null}),[d.isLoading,d.key,w,A,k,v,r.from,r.to]);return(0,b.jsx)(s.YStack,{gap:"$2.5",children:(v?n.reverse():n).map((function(e,t){return I(e,t)}))})}));var $=n(839850),N=(n(663522),n(896666));function SwapHeaderRightActionContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SwapHeaderRightActionContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapHeaderRightActionContainer_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapHeaderRightActionContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var SwapSettingsCommonItem=function({value:e,onChange:t,title:n,content:r,badgeContent:o}){return(0,b.jsxs)(s.XStack,{justifyContent:"space-between",alignItems:"center",children:[(0,b.jsxs)(s.YStack,{flex:1,gap:"$0.5",children:[(0,b.jsxs)(s.XStack,{alignItems:"center",gap:"$1.5",children:[(0,b.jsx)(s.SizableText,{size:"$bodyLgMedium",children:n}),o?(0,b.jsx)(s.Badge,{badgeSize:"sm",badgeType:"success",children:o}):null]}),(0,b.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",width:"95%",children:r})]}),(0,b.jsx)(s.Switch,{value:e,onChange:t})]})},SwapSettingsDialogContent=function(){var e=(0,m.A)(),[{swapBatchApproveAndSwap:t,swapEnableRecipientAddress:n},r]=(0,u.useSettingsPersistAtom)(),[,o]=(0,u.useSettingsAtom)();return(0,b.jsxs)(s.YStack,{gap:"$5",children:[(0,b.jsx)(SwapSettingsCommonItem,{title:e.formatMessage({id:S.ETranslations.swap_page_settings_simple_mode}),content:e.formatMessage({id:S.ETranslations.swap_page_settings_simple_mode_content}),badgeContent:"Beta",value:t,onChange:function(e){r((function(t){return SwapHeaderRightActionContainer_objectSpread(SwapHeaderRightActionContainer_objectSpread({},t),{},{swapBatchApproveAndSwap:e})}))}}),(0,b.jsx)(SwapSettingsCommonItem,{title:e.formatMessage({id:S.ETranslations.swap_page_settings_recipient_title}),content:e.formatMessage({id:S.ETranslations.swap_page_settings_recipient_content}),value:n,onChange:function(e){r((function(t){return SwapHeaderRightActionContainer_objectSpread(SwapHeaderRightActionContainer_objectSpread({},t),{},{swapEnableRecipientAddress:e})})),e||o((function(e){return SwapHeaderRightActionContainer_objectSpread(SwapHeaderRightActionContainer_objectSpread({},e),{},{swapToAnotherAccountSwitchOn:!1})}))}})]})};const components_SwapHeaderRightActionContainer=function(){var e=(0,i.A)(),[{swapHistoryPendingList:t}]=(0,u.useInAppNotificationAtom)(),n=(0,m.A)(),r=(0,a.useMemo)((function(){return t.filter((function(e){return e.status===f.lr.PENDING||e.status===f.lr.CANCELING}))}),[t]),o=(0,a.useCallback)((function(){e.pushModal(d.ry.SwapModal,{screen:l.u.SwapHistoryList})}),[e]),c=(0,a.useCallback)((function(){s.Dialog.show({title:n.formatMessage({id:S.ETranslations.swap_page_settings}),renderContent:(0,b.jsx)(SwapSettingsDialogContent,{}),showConfirmButton:!1,showCancelButton:!1,showFooter:!1})}),[n]);return(0,b.jsxs)(N.bE,{children:[r.length>0?(0,b.jsxs)(s.Badge,{badgeSize:"lg",badgeType:"info",onPress:o,children:[(0,b.jsx)(s.Stack,{borderRadius:"$full",p:3,bg:"$borderInfo",children:(0,b.jsx)(s.Stack,{w:"$1.5",h:"$1.5",borderRadius:"$full",bg:"$iconInfo"})}),(0,b.jsx)(s.Badge.Text,{cursor:"pointer",pl:"$2",children:`${r.length} ${n.formatMessage({id:S.ETranslations.swap_history_detail_status_pending})} `})]}):(0,b.jsx)(N.v$,{icon:"ClockTimeHistoryOutline",onPress:o,iconProps:{size:24},size:"medium"}),(0,b.jsx)(N.v$,{icon:"SettingsOutline",onPress:c,iconProps:{size:24},size:"medium"})]})};var D=["children","isSelected","onPress"];function SwapHeaderContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SwapHeaderContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapHeaderContainer_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapHeaderContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function CustomTabItem(e){var{children:t,isSelected:n,onPress:r}=e,o=(0,$.A)(e,D);return(0,b.jsx)(s.Stack,SwapHeaderContainer_objectSpread(SwapHeaderContainer_objectSpread(SwapHeaderContainer_objectSpread({py:"$1",px:"$2.5",borderRadius:"$2",borderCurve:"continuous",userSelect:"none",hitSlop:{top:4,bottom:4}},n?{bg:"$bgActive"}:{hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"}}),{},{onPress:r},o),{},{children:(0,b.jsx)(s.SizableText,SwapHeaderContainer_objectSpread(SwapHeaderContainer_objectSpread({size:"$headingMd",color:"$textSubdued"},n&&{color:"$text"}),{},{children:t}))}))}const z=(0,a.memo)((function({defaultSwapType:e}){var t=(0,m.A)(),[n]=(0,c.sK)(),{swapTypeSwitchAction:r}=(0,c.eR)().current,{networkId:o}=(0,v.zf)(f.En.FROM),[i]=(0,c.NE)(),u=(0,a.useCallback)((function(){return(0,b.jsx)(components_SwapHeaderRightActionContainer,{})}),[]),d=(0,a.useRef)(o);return d.current!==o&&(d.current=o),d.current!==i?.networkId&&(d.current=i?.networkId),(0,a.useEffect)((function(){e&&setTimeout((function(){r(e,d.current)}),10)}),[]),(0,b.jsxs)(s.XStack,{justifyContent:"space-between",children:[(0,b.jsxs)(s.XStack,{gap:"$3",children:[(0,b.jsx)(CustomTabItem,{isSelected:n===f.qX.SWAP,onPress:function(){n!==f.qX.SWAP&&r(f.qX.SWAP,o)},children:t.formatMessage({id:S.ETranslations.swap_page_swap})}),(0,b.jsx)(CustomTabItem,{isSelected:n===f.qX.BRIDGE,onPress:function(){n!==f.qX.BRIDGE&&r(f.qX.BRIDGE,o)},children:t.formatMessage({id:S.ETranslations.swap_page_bridge})})]}),u()]})}));var L=n(317522);function useSwapApproving_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function useSwapApproving_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?useSwapApproving_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):useSwapApproving_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=n(318822),B=n(734818),H=n(100009);var W=n(88803);const components_SwapAccountAddressContainer=function({type:e,onClickNetwork:t}){var n=(0,m.A)(),[r]=(0,c.NE)(),[o]=(0,c.sK)(),[i]=(0,c.qv)(),[u]=(0,c.Q8)(),d=(0,a.useMemo)((function(){var n=i.find((function(t){return t.networkId===(e===f.En.FROM?r?.networkId:u?.networkId)}));return(0,b.jsx)(s.AnimatePresence,{children:o===f.qX.BRIDGE&&n?(0,b.jsxs)(s.XStack,{animation:"quick",enterStyle:{opacity:0,x:8},exitStyle:{opacity:0,x:4},gap:"$1",alignItems:"center",cursor:"pointer",onPress:function(){t?.(e)},children:[(0,b.jsx)(s.Image,{w:18,h:18,source:{uri:n.logoURI}}),(0,b.jsx)(s.SizableText,{size:"$bodyMd",color:"$text",children:n.name})]},"network-component"):null})}),[i,o,t,e,r?.networkId,u?.networkId]);return(0,b.jsxs)(s.XStack,{pb:"$2",children:[(0,b.jsx)(s.SizableText,{size:"$bodyMd",mr:"$2",userSelect:"none",color:"$textSubdued",children:n.formatMessage({id:e===f.En.FROM?S.ETranslations.swap_page_from:S.ETranslations.swap_page_to})}),d]})};const V=(0,a.memo)((function({onAmountChange:e,direction:t,token:n,amountValue:r,selectTokenLoading:o,inputLoading:i,onSelectToken:d,onBalanceMaxPress:l,balance:p}){(0,O.ZF)({token:n,type:t});var[m]=(0,u.useSettingsPersistAtom)(),[g]=(0,c.LX)(),{address:S,accountInfo:k}=(0,v.zf)(t),[A]=(0,c.I5)(),I=(0,a.useMemo)((function(){var e;if(!n?.price)return"0.0";var t=new w.A(null!=(e=n.price)?e:0),o=new w.A(null!=r?r:0).multipliedBy(t);return o.isNaN()?"0.0":`${o.decimalPlaces(6,w.A.ROUND_DOWN).toFixed()}`}),[r,n?.price]),T=(0,a.useMemo)((function(){return g?.states.some((function(e){return e.inputShowError}))&&t===f.En.FROM||!S&&(y.A.isHdWallet({walletId:k?.wallet?.id})||y.A.isHwWallet({walletId:k?.wallet?.id})||y.A.isQrWallet({walletId:k?.wallet?.id}))}),[g?.states,t,S,k]),h=(0,a.useMemo)((function(){if(A&&t===f.En.TO){var e="$textSubdued";return i&&(e="$textPlaceholder"),A.unit===f.GK.NEGATIVE&&(e="$textCritical"),A.unit===f.GK.POSITIVE&&(e="$textSuccess"),(0,b.jsx)(s.SizableText,{size:"$bodyMd",color:e,children:A.value})}return null}),[t,i,A]);return(0,b.jsxs)(s.YStack,{children:[(0,b.jsx)(components_SwapAccountAddressContainer,{type:t,onClickNetwork:d}),(0,b.jsx)(W.J,{onChange:e,value:r,hasError:T,balanceProps:{value:p,onPress:l},valueProps:{value:I,color:i&&t===f.En.TO?"$textPlaceholder":void 0,currency:m.currencyInfo.symbol,moreComponent:h},inputProps:{placeholder:"0.0",readOnly:t===f.En.TO,color:t===f.En.TO&&i?"$textPlaceholder":void 0,style:t===f.En.TO?{caretColor:"transparent"}:void 0},tokenSelectorTriggerProps:{loading:o,selectedNetworkImageUri:n?.networkLogoURI,selectedTokenImageUri:n?.logoURI,selectedTokenSymbol:n?.symbol,onPress:function(){d(t)}},enableMaxAmount:t===f.En.FROM})]})}));const U=(0,a.memo)((function({onSelectToken:e,selectLoading:t}){var n,[r,o]=(0,c.VS)(),i=useSwapQuoteLoading(),l=useSwapQuoteEventFetching(),[p]=(0,c.NE)(),[g]=(0,c.Q8)(),[k]=(0,c.WC)(),{alternationToken:A}=(0,c.eR)().current,[I]=(0,c.Zr)(),[y]=(0,c.kz)(),[T]=(0,c.pW)();return function useSwapQuote(){var e=(0,m.A)(),{quoteAction:t,cleanQuoteInterval:n,recoverQuoteInterval:r,quoteEventHandler:o}=(0,c.eR)().current,[i]=(0,c.jH)(),l=(0,v.zf)(f.En.FROM),[p]=(0,c.NE)(),[w]=(0,c.Q8)(),[g]=(0,c.DI)(),[S]=(0,c.FR)(),[b,k]=(0,c.VS)(),[A,I]=(0,c.mA)(),[y,T]=(0,c.vS)(),[h]=(0,c.iA)(),{closeQuoteEvent:j}=(0,c.eR)().current,[{swapApprovingTransaction:O}]=(0,u.useInAppNotificationAtom)(),[E]=(0,c.oz)(),C=(0,a.useRef)(E),M=(0,a.useRef)(i),P=(0,a.useRef)(h);P.current!==h&&(P.current=h);var R=(0,a.useRef)(A);R.current!==A&&(R.current=A);var $=(0,a.useRef)(y);$.current!==y&&($.current=y),M.current!==i&&(M.current=i),C.current!==E&&(C.current=E);var N=(0,x.E)(),D=(0,a.useRef)(N);D.current!==N&&(D.current=N);var z=(0,a.useRef)();z.current!==l&&(z.current=l);var W=(0,a.useRef)();W.current!==O&&(W.current=O);var V=(0,_.d)(b,500,{leading:!0}),U=(0,a.useCallback)((function(){var e=(0,H.mD)(V,p?.decimals);e&&e!==V&&k(e)}),[p?.decimals,V,k]);(0,a.useEffect)((function(){D.current&&(b||t(z.current?.address,z.current?.accountInfo?.account?.id))}),[b,t]),(0,a.useEffect)((function(){g.status||S?n():g.status||"save"!==g.flag?r(z.current?.address,z.current?.accountInfo?.account?.id):t(z.current?.address,z.current?.accountInfo?.account?.id)}),[t,n,r,S,g]),(0,a.useEffect)((function(){D.current&&O&&O.txId&&O.status===f.MG.SUCCESS&&!O.resetApproveValue&&t(z.current?.address,z.current?.accountInfo?.account?.id,O.blockNumber)}),[e,n,t,O]),(0,a.useEffect)((function(){if(D.current&&!(p?.networkId!==z.current?.networkId||(0,B.BQ)({token1:{networkId:p?.networkId,contractAddress:p?.contractAddress},token2:{networkId:w?.networkId,contractAddress:w?.contractAddress}})||M.current?.actionLock&&M.current?.fromTokenAmount===V&&(0,B.BQ)({token1:M.current?.fromToken,token2:{networkId:p?.networkId,contractAddress:p?.contractAddress}})&&(0,B.BQ)({token1:M.current?.toToken,token2:{networkId:w?.networkId,contractAddress:w?.contractAddress}})&&M.current.accountId===z.current?.accountInfo?.account?.id&&M.current?.address===l.address))return U(),t(z.current?.address,z.current?.accountInfo?.account?.id),function(){n()}}),[n,t,l.address,l.networkId,p?.networkId,p?.contractAddress,w?.networkId,w?.contractAddress,U,V]),(0,a.useEffect)((function(){if(!D.current&&p?.networkId===z.current?.networkId&&!(0,B.BQ)({token1:{networkId:p?.networkId,contractAddress:p?.contractAddress},token2:{networkId:w?.networkId,contractAddress:w?.contractAddress}}))return U(),t(z.current?.address,z.current?.accountInfo?.account?.id),function(){n()}}),[l.accountInfo?.deriveType]);var q=(0,s.usePageType)();(0,L.A)(d.V4.Swap,(function(e,t){q!==s.EPageType.modal&&(e?(F.iL.off(F.Tu.SwapQuoteEvent,o),F.iL.on(F.Tu.SwapQuoteEvent,o)):t?((P.current||$.current>0&&R.current.length<$.current)&&(j(),T(0),I([]),k("")),F.iL.off(F.Tu.SwapQuoteEvent,o)):(F.iL.off(F.Tu.SwapQuoteEvent,o),F.iL.on(F.Tu.SwapQuoteEvent,o))),setTimeout((function(){q!==s.EPageType.modal&&(!e||t||W.current?.txId||C.current?n():r(z.current?.address,z.current?.accountInfo?.account?.id))}),100)})),(0,a.useEffect)((function(){q===s.EPageType.modal&&N&&(F.iL.off(F.Tu.SwapQuoteEvent,o),F.iL.on(F.Tu.SwapQuoteEvent,o))}),[N,q,o]),(0,a.useEffect)((function(){setTimeout((function(){q===s.EPageType.modal&&(!N||W.current?.txId||C.current?n():r(z.current?.address,z.current?.accountInfo?.account?.id))}),100)}),[n,N,q,r])}(),(0,v.jA)(),function useSwapApproving(){var e=(0,m.A)(),{approvingStateAction:t,cleanApprovingInterval:n}=(0,c.eR)().current,[{swapApprovingTransaction:r},o]=(0,u.useInAppNotificationAtom)(),i=(0,a.useRef)();i.current!==r&&(i.current=r);var{approveTx:l}=useSwapBuildTx(),p=(0,a.useRef)(l);p.current!==l&&(p.current=l);var w=(0,x.E)(),g=(0,a.useRef)(w);g.current!==w&&(g.current=w),(0,a.useEffect)((function(){if(g.current)return r?.txId&&r?.status===f.MG.PENDING?t():n(),r?.status===f.MG.FAILED?s.Toast.error({title:e.formatMessage({id:S.ETranslations.swap_page_toast_approve_failed})}):r?.status===f.MG.CANCEL?s.Toast.error({title:e.formatMessage({id:S.ETranslations.swap_page_toast_approve_canceled})}):r?.status===f.MG.SUCCESS&&(r?.resetApproveValue&&Number(r?.resetApproveValue)>0?p.current?.(r?.resetApproveValue,!!r?.resetApproveIsMax):s.Toast.success({title:e.formatMessage({id:S.ETranslations.swap_page_toast_approve_successful})})),r?.status!==f.MG.FAILED&&r?.status!==f.MG.CANCEL||o((function(e){return useSwapApproving_objectSpread(useSwapApproving_objectSpread({},e),{},{swapApprovingTransaction:void 0})})),function(){n()}}),[t,n,e,o,r?.resetApproveIsMax,r?.resetApproveValue,r?.status,r?.txId]);var b=(0,s.usePageType)();(0,L.A)(d.V4.Swap,(function(e,r){b!==s.EPageType.modal&&(e&&!r&&i.current?.txId&&i.current?.status===f.MG.PENDING?t():n())})),(0,a.useEffect)((function(){b===s.EPageType.modal&&(w&&i.current?.txId&&i.current?.status===f.MG.PENDING?t():n())}),[t,n,w,b])}(),(0,b.jsxs)(s.YStack,{children:[(0,b.jsx)(V,{token:p,direction:f.En.FROM,selectTokenLoading:t,onAmountChange:function(e){(0,H.dM)(e,p?.decimals)&&o(e)},amountValue:r,onBalanceMaxPress:function(){var e=y;if(p?.reservationValue){var t=new w.A(null!=y?y:0),n=new w.A(p.reservationValue);t.minus(n).isGreaterThan(0)&&(e=t.minus(n).toFixed())}o(e)},onSelectToken:e,balance:y}),(0,b.jsxs)(s.YStack,{pt:"$3.5",children:[(0,b.jsx)(s.IconButton,{alignSelf:"flex-end",icon:"SwitchVerOutline",size:"small",zIndex:2,disabled:k.from||k.to,onPress:A,mb:"$-3"}),(0,b.jsx)(V,{token:g,inputLoading:i||l,selectTokenLoading:t,direction:f.En.TO,amountValue:null!=(n=I?.toAmount)?n:"",onSelectToken:e,balance:T})]})]})}));const components_SwapCommonInfoItem=function({title:e,value:t,onPress:n,isLoading:r,valueComponent:o,questionMarkContent:i}){var c=(0,a.useMemo)((function(){return(0,b.jsx)(s.Popover,{title:e,renderTrigger:(0,b.jsx)(s.IconButton,{variant:"tertiary",size:"small",icon:"QuestionmarkOutline"}),renderContent:(0,b.jsx)(s.SizableText,{p:"$5",$gtMd:{size:"$bodyMd"},children:i})})}),[i,e]),u=(0,a.useMemo)((function(){return(0,b.jsxs)(s.XStack,{userSelect:"none",hoverStyle:{opacity:.5},alignItems:"center",onPress:n,cursor:n?"pointer":void 0,children:[o||(0,b.jsx)(s.SizableText,{size:"$bodyMdMedium",children:t}),n?(0,b.jsx)(s.Icon,{name:"ChevronRightSmallOutline",mr:"$-1",size:"$5",color:"$iconSubdued"}):null]})}),[n,t,o]);return(0,b.jsxs)(s.XStack,{justifyContent:"space-between",alignItems:"center",children:[(0,b.jsxs)(s.XStack,{children:[(0,b.jsx)(s.SizableText,{userSelect:"none",mr:"$1",size:"$bodyMd",color:"$textSubdued",children:e}),i?c:null]}),(0,b.jsx)(s.XStack,{gap:"$2",children:r?(0,b.jsx)(s.Stack,{py:"$1",children:(0,b.jsx)(s.Skeleton,{h:"$3",w:"$24"})}):u})]})};const components_SwapProviderInfoItem=function({fromToken:e,isBest:t,toToken:n,providerIcon:r,providerName:o,showLock:a,onPress:i,isLoading:c}){var u=(0,m.A)();return(0,b.jsxs)(s.XStack,{justifyContent:"space-between",alignItems:"center",children:[(0,b.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",userSelect:"none",children:u.formatMessage({id:S.ETranslations.swap_page_provider_provider})}),c?(0,b.jsx)(s.Stack,{py:"$1",children:(0,b.jsx)(s.Skeleton,{h:"$3",w:"$24"})}):(0,b.jsxs)(s.XStack,{alignItems:"center",userSelect:"none",hoverStyle:{opacity:.5},onPress:i,cursor:i?"pointer":void 0,children:[r&&e&&n?(0,b.jsxs)(b.Fragment,{children:[t?(0,b.jsx)(s.Badge,{badgeSize:"sm",badgeType:"success",marginRight:"$2",children:u.formatMessage({id:S.ETranslations.global_best})}):null,(0,b.jsx)(s.Image,{source:{uri:r},w:"$5",h:"$5",borderRadius:"$1"}),(0,b.jsx)(s.SizableText,{size:"$bodyMdMedium",ml:"$1",children:null!=o?o:""})]}):null,a?(0,b.jsx)(s.Icon,{name:"LockOutline",color:"$iconSubdued",ml:"$1",size:"$5"}):null,i?(0,b.jsx)(s.Icon,{name:"ChevronRightSmallOutline",size:"$5",color:"$iconSubdued",mr:"$-1"}):null]})]})};const components_SwapQuoteResultRate=function({rate:e,isBest:t,fromToken:n,toToken:r,providerIcon:o,providerName:i,isLoading:c,onOpenResult:u,openResult:d}){var l=(0,m.A)(),[p,f]=(0,a.useState)(!1),g=(0,a.useMemo)((function(){return!new w.g(null!=e?e:0).isZero()}),[e]),k=(0,a.useMemo)((function(){if(!u||!n||!r)return(0,b.jsx)(s.SizableText,{size:"$bodyMdMedium",children:l.formatMessage({id:S.ETranslations.swap_page_provider_provider_insufficient_liquidity})});if(!g)return(0,b.jsx)(s.SizableText,{ml:"$1",size:"$bodyMdMedium",children:l.formatMessage({id:S.ETranslations.swap_page_provider_rate_unavailable})});var t=new w.g(null!=e?e:0);return(0,b.jsx)(s.XStack,{gap:"$2",alignItems:"center",hoverStyle:{opacity:.5},onPress:function(e){e.stopPropagation(),f(!p)},cursor:"pointer",children:(0,b.jsxs)(s.SizableText,{size:"$bodyMdMedium",maxWidth:240,$gtMd:{maxWidth:240},textAlign:"right",children:[`1 ${p?r.symbol.toUpperCase():n.symbol.toUpperCase()} = `,(0,b.jsx)(s.NumberSizeableText,{size:"$bodyMdMedium",formatter:"balance",children:p?new w.g(1).div(t).toFixed():t.toFixed()}),(0,b.jsx)(s.SizableText,{size:"$bodyMdMedium",children:` ${p?n.symbol:r.symbol}`})]})})}),[n,l,p,u,e,g,r]);return(0,b.jsxs)(s.XStack,{alignItems:"center",gap:"$5",children:[c?(0,b.jsx)(s.Stack,{py:"$0.5",children:(0,b.jsx)(s.Skeleton,{h:"$4",w:"$32"})}):k,(0,b.jsxs)(s.XStack,{alignItems:"center",userSelect:"none",gap:"$1",flex:1,children:[o&&n&&r&&u?(0,b.jsxs)(s.XStack,{flex:1,justifyContent:"flex-end",animation:"quick",y:d?"$1":"$0",opacity:d?0:1,children:[t?(0,b.jsx)(s.Badge,{badgeSize:"sm",marginRight:"$2",badgeType:"success",children:l.formatMessage({id:S.ETranslations.global_best})}):null,(0,b.jsx)(s.Image,{source:{uri:o},w:"$5",h:"$5",borderRadius:"$1"}),(0,b.jsx)(s.SizableText,{numberOfLines:1,size:"$bodyMdMedium",ml:"$1",flexShrink:1,children:null!=i?i:""})]}):null,!c&&u?(0,b.jsx)(s.Stack,{animation:"quick",rotate:d?"180deg":"0deg",children:(0,b.jsx)(s.Icon,{name:"ChevronDownSmallOutline",color:d?"$iconActive":"$iconSubdued",size:"$5"})}):null]})]})};const q=(0,a.memo)((function({onSelectAllowanceValue:e,currentSelectAllowanceValue:t,selectItems:n,onSelectOpenChange:r,isLoading:o}){var i=(0,m.A)(),c=(0,a.useCallback)((function(){return o?(0,b.jsx)(s.Stack,{py:"$1",children:(0,b.jsx)(s.Skeleton,{h:"$3",w:"$24"})}):(0,b.jsxs)(s.XStack,{userSelect:"none",hoverStyle:{opacity:.5},children:[(0,b.jsx)(s.SizableText,{size:"$bodyMdMedium",children:t?.label}),(0,b.jsx)(s.Icon,{size:"$5",color:"$iconSubdued",name:"ChevronRightSmallOutline",mr:"$-1"})]})}),[t?.label,o]);return(0,b.jsxs)(s.XStack,{justifyContent:"space-between",children:[(0,b.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",userSelect:"none",children:i.formatMessage({id:S.ETranslations.swap_page_provider_approve_amount})}),(0,b.jsx)(s.Select,{placement:"bottom-end",items:n,value:t?.value,onChange:function(t){e(t)},onOpenChange:r,title:i.formatMessage({id:S.ETranslations.swap_page_provider_approve_amount}),renderTrigger:c})]})}));const Q=(0,a.memo)((function({allowanceResult:e,fromTokenSymbol:t,isLoading:n}){var r=(0,m.A)(),[o,i]=(0,c.rE)(),[,u]=(0,c.FR)(),d=(0,a.useMemo)((function(){return[{label:(0,b.jsx)(s.NumberSizeableText,{size:"$bodyMdMedium",formatter:"balance",formatterOptions:{tokenSymbol:t},children:e.amount}),value:f.KF.PRECISION},{label:r.formatMessage({id:S.ETranslations.swap_page_provider_approve_amount_un_limit}),value:f.KF.UN_LIMIT}]}),[e.amount,t,r]),l=(0,a.useCallback)((function(e){i(e===f.KF.UN_LIMIT)}),[i]);return(0,b.jsx)(q,{currentSelectAllowanceValue:d[o?1:0],onSelectAllowanceValue:l,selectItems:d,isLoading:n,onSelectOpenChange:u})}));var K=n(712784),X=n.n(K);function SwapSlippageContentContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var G=(0,a.memo)((function({swapSlippage:e,onChangeText:t,props:n}){var[o,i]=(0,a.useState)(""),c=(0,a.useRef)(!1),u=(0,a.useCallback)((function(e){(0,H.dM)(e,p.Oz)&&(c.current=/^\d+\.$/.test(e),i(e),t(e))}),[t]),d=(0,a.useMemo)((function(){return new w.g(e.value).decimalPlaces(p.Oz,w.g.ROUND_DOWN).toFixed()}),[e.value]);return(0,a.useEffect)((function(){c.current||i(d)}),[d]),(0,b.jsx)(s.Input,function SwapSlippageContentContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapSlippageContentContainer_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapSlippageContentContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({size:"medium",containerProps:{flex:1},value:o,autoFocus:e.key===f.k0.CUSTOM,addOns:[{label:"%"}],textAlign:"left",disabled:e.key===f.k0.AUTO,placeholder:d,onChangeText:u},n))}));const Z=(0,a.memo)((function({swapSlippage:e,onSave:t,autoValue:n}){var[r,o]=(0,a.useState)(e),i=(0,m.A)(),[c,u]=(0,a.useState)({status:f.nC.NORMAL,message:""}),d=(0,a.useCallback)(X()((function(e){var t=new w.g(e);t.isNaN()||t.isNegative()||t.gt(p.qm)?u({status:f.nC.ERROR,message:i.formatMessage({id:S.ETranslations.slippage_tolerance_error_message})}):(o({key:f.k0.CUSTOM,value:t.toNumber()}),t.lte(p.SF)?u({status:f.nC.WRONG,message:i.formatMessage({id:S.ETranslations.slippage_tolerance_warning_message_2},{number:p.SF})}):t.gte(p.Rq)?u({status:f.nC.WRONG,message:i.formatMessage({id:S.ETranslations.slippage_tolerance_warning_message_1},{number:p.Rq})}):u({status:f.nC.NORMAL,message:""}))}),350),[]);return(0,b.jsxs)(s.YStack,{gap:"$4",children:[(0,b.jsx)(s.SegmentControl,{fullWidth:!0,value:r.key,options:p.dI.map((function(e){return{label:i.formatMessage({id:e.key===f.k0.AUTO?S.ETranslations.slippage_tolerance_switch_auto:S.ETranslations.slippage_tolerance_switch_custom}),value:e.key}})),onChange:function(t){o({key:t,value:t===f.k0.AUTO?n:e.value})}}),r.key!==f.k0.CUSTOM?(0,b.jsx)(G,{swapSlippage:r,onChangeText:d}):null,r.key===f.k0.CUSTOM?(0,b.jsxs)(s.XStack,{gap:"$2.5",children:[(0,b.jsx)(G,{swapSlippage:r,onChangeText:d}),(0,b.jsx)(s.XStack,{children:p.RW.map((function(e,t){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Button,{variant:"secondary",size:"medium",borderTopRightRadius:2!==t?0:"$2",borderBottomRightRadius:2!==t?0:"$2",borderTopLeftRadius:0!==t?0:"$2",borderBottomLeftRadius:0!==t?0:"$2",onPress:function(){u({status:f.nC.NORMAL,message:""}),o({key:f.k0.CUSTOM,value:e})},children:`${e}${t===p.RW.length-1?"  ":""}%`},e),t!==p.RW.length-1?(0,b.jsx)(s.Divider,{vertical:!0}):null]})}))})]}):null,r.key===f.k0.AUTO?(0,b.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:i.formatMessage({id:S.ETranslations.slippage_tolerance_description})}):null,r.key!==f.k0.AUTO&&c.status!==f.nC.NORMAL?(0,b.jsx)(s.SizableText,{size:"$bodySmMedium",color:c.status===f.nC.ERROR?"$textCritical":"$textCaution",children:c.message}):null,(0,b.jsx)(s.Dialog.Footer,{showCancelButton:!1,onConfirmText:i.formatMessage({id:S.ETranslations.slippage_tolerance_button_save}),confirmButtonProps:{variant:"primary",disabled:r.key===f.k0.CUSTOM&&c.status===f.nC.ERROR},onConfirm:function({close:e}){t(r,e)}})]})}));const J=(0,a.memo)((function({isLoading:e,onPress:t}){var n=(0,m.A)(),[{slippageItem:r}]=(0,c.H_)(),o=(0,a.useMemo)((function(){return new w.A(r.value).decimalPlaces(p.Oz,w.A.ROUND_DOWN).toFixed()}),[r.value]),i=(0,a.useMemo)((function(){return n.formatMessage({id:r.key===f.k0.AUTO?S.ETranslations.swap_page_provider_slippage_auto:S.ETranslations.swap_page_provider_custom},{number:o})}),[o,n,r.key]),u=(0,a.useMemo)((function(){return(0,b.jsx)(s.SizableText,{size:"$bodyMdMedium",color:r.value>p.Rq?"$textCritical":"$text",children:i})}),[i,r.value]);return(0,b.jsx)(components_SwapCommonInfoItem,{title:n.formatMessage({id:S.ETranslations.swap_page_provider_slippage_tolerance}),isLoading:e,onPress:t,questionMarkContent:n.formatMessage({id:S.ETranslations.slippage_tolerance_popover}),valueComponent:u})}));const Y=(0,a.memo)((function({onOpenProviderList:e,quoteResult:t,onOpenRecipient:n}){var r,o,i,d,[l,p]=(0,a.useState)(!1),[g]=(0,c.NE)(),[k]=(0,c.Q8)(),[A]=(0,c.VS)(),[I]=(0,u.useSettingsPersistAtom)(),[y]=(0,c.KO)(),[T]=(0,c.dF)(),h=useSwapQuoteLoading(),j=(0,m.A)(),[,x]=(0,c.DI)(),[{slippageItem:O,autoValue:E}]=(0,c.H_)(),[,C]=(0,c.$E)(),[,M]=(0,c.AF)(),P=(0,a.useRef)(null),R=(0,a.useCallback)((function(e,t){M(e.key),e.key===f.k0.CUSTOM&&C(e.value),t({flag:"save"})}),[C,M]),$=(0,v.Gr)(I.swapEnableRecipientAddress),N=(0,a.useCallback)((function(e,t,n){var r,o=w.A.maximum(e,t).dividedBy(100).toNumber();return(0,b.jsx)(components_SwapCommonInfoItem,{title:j.formatMessage({id:S.ETranslations.swap_page_buy_sell_tax},{token:`${null!=(r=n?.symbol)?r:""}`}),isLoading:h,valueComponent:(0,b.jsx)(s.SizableText,{size:"$bodyMdMedium",children:`${o}%`})})}),[j,h]),D=(0,a.useCallback)((function(e,t,n){var r=e?.buyToken,o=e?.sellToken,a=null,s=null,i=new w.A(r?.buyTaxBps?r?.buyTaxBps:0),c=new w.A(r?.sellTaxBps?r?.sellTaxBps:0),u=new w.A(o?.buyTaxBps?o?.buyTaxBps:0),d=new w.A(o?.sellTaxBps?o?.sellTaxBps:0);return(i.gt(0)||c.gt(0))&&(a=N(i,c,n)),(u.gt(0)||d.gt(0))&&(s=N(u,d,t)),(0,b.jsxs)(b.Fragment,{children:[s,a]})}),[N]),z=(0,a.useCallback)((function(){P.current=s.Dialog.show({title:j.formatMessage({id:S.ETranslations.slippage_tolerance_title}),renderContent:(0,b.jsx)(Z,{swapSlippage:O,autoValue:E,onSave:R}),onOpen:function(){x({status:!0})},onClose:function(e){x({status:!1,flag:e?.flag})}})}),[j,O,E,R,x]),L=(0,_.d)(A,500,{leading:!0});return!g||!k||new w.A(A).isNaN()||new w.A(A).isZero()?null:g&&k&&!new w.A(L).isZero()&&!new w.A(L).isNaN()?(0,b.jsx)(s.Accordion,{type:"single",collapsible:!0,children:(0,b.jsxs)(s.Accordion.Item,{value:"1",children:[(0,b.jsx)(s.Accordion.Trigger,{unstyled:!0,borderWidth:0,bg:"$transparent",p:"$0",cursor:"pointer",disabled:!t?.info.provider||h,children:function({open:e}){var n,r;return(0,b.jsx)(components_SwapQuoteResultRate,{rate:t?.instantRate,fromToken:g,toToken:k,isBest:t?.isBest,providerIcon:null!=(n=t?.info.providerLogo)?n:"",providerName:null!=(r=t?.info.providerName)?r:"",isLoading:h,onOpenResult:t?.info.provider&&!h?function(){return p(!l)}:void 0,openResult:e})}}),(0,b.jsx)(s.Accordion.HeightAnimator,{animation:"quick",children:(0,b.jsxs)(s.Accordion.Content,{gap:"$4",p:"$0",animation:"quick",enterStyle:{opacity:0},exitStyle:{opacity:0},children:[(0,b.jsx)(s.Divider,{mt:"$4"}),T&&I.swapEnableRecipientAddress?(0,b.jsx)(components_SwapCommonInfoItem,{title:j.formatMessage({id:S.ETranslations.global_recipient}),isLoading:h,onPress:n,valueComponent:(0,b.jsxs)(s.XStack,{gap:"$1",children:[$?.showAddress?null:(0,b.jsx)(s.Icon,{name:"AddPeopleOutline",w:18,h:18}),(0,b.jsx)(s.SizableText,{size:"$bodyMdMedium",children:null!=(r=$?.showAddress)?r:j.formatMessage({id:S.ETranslations.swap_page_recipient_edit})})]})}):null,t?.allowanceResult?(0,b.jsx)(Q,{allowanceResult:t?.allowanceResult,fromTokenSymbol:null!=(o=g?.symbol)?o:"",isLoading:h}):null,t?.info.provider?(0,b.jsx)(components_SwapProviderInfoItem,{providerIcon:null!=(i=t?.info.providerLogo)?i:"",providerName:null!=(d=t?.info.providerName)?d:"",isLoading:h,isBest:t.isBest,fromToken:g,toToken:k,showLock:!!t?.allowanceResult,onPress:t?.info.provider?function(){e?.()}:void 0}):null,t?.toAmount&&!t?.unSupportSlippage?(0,b.jsx)(J,{isLoading:h,onPress:z}):null,t?.fee?.estimatedFeeFiatValue?(0,b.jsx)(components_SwapCommonInfoItem,{title:j.formatMessage({id:S.ETranslations.swap_page_provider_est_network_fee}),isLoading:h,valueComponent:(0,b.jsx)(s.NumberSizeableText,{size:"$bodyMdMedium",formatter:"value",formatterOptions:{currency:I.currencyInfo.symbol},children:t.fee?.estimatedFeeFiatValue})}):null,y?.swapTokenMetadata?D(y?.swapTokenMetadata,g,k):null]})})]})}):void 0}));function SwapMainLand_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SwapMainLand_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SwapMainLand_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SwapMainLand_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var SwapMainLoad=function({swapInitParams:e,pageType:t}){var n,r,{buildTx:w,approveTx:m,wrappedTx:g}=useSwapBuildTx(),{fetchLoading:S}=(0,O.FI)(e),A=(0,i.A)(),[I]=(0,c.Zr)(),[y]=(0,c.LX)(),T=(0,v.zf)(f.En.TO),h=useSwapQuoteLoading(),j=useSwapQuoteEventFetching(),[{swapRecentTokenPairs:x}]=(0,u.useInAppNotificationAtom)(),[_]=(0,c.VS)(),{selectFromToken:E,selectToToken:C}=(0,c.eR)().current,P=(0,a.useCallback)((function(e){A.pushModal(d.ry.SwapModal,{screen:l.u.SwapTokenSelect,params:{type:e,storeName:t===s.EPageType.modal?u.EJotaiContextStoreNames.swapModal:u.EJotaiContextStoreNames.swap}})}),[A,t]),$=(0,a.useCallback)((function({fromToken:e,toToken:t}){E(e,!0),C(t)}),[E,C]),N=(0,a.useCallback)((function(){A.pushModal(d.ry.SwapModal,{screen:l.u.SwapProviderSelect,params:{storeName:t===s.EPageType.modal?u.EJotaiContextStoreNames.swapModal:u.EJotaiContextStoreNames.swap}})}),[A,t]),D=(0,a.useCallback)((function(){A.pushModal(d.ry.SwapModal,{screen:l.u.SwapToAnotherAddress,params:{address:T.address,storeName:t===s.EPageType.modal?u.EJotaiContextStoreNames.swapModal:u.EJotaiContextStoreNames.swap}})}),[A,t,T.address]),L=(0,a.useCallback)((0,o.A)((function*(){yield w()})),[w]),F=(0,a.useCallback)((r=(0,o.A)((function*(e,t,n){n?yield m(p.XU,t,e):yield m(e,t)})),function(e,t,n){return r.apply(this,arguments)}),[m]),B=(0,a.useCallback)((0,o.A)((function*(){yield g()})),[g]);return(0,b.jsx)(s.ScrollView,{children:(0,b.jsxs)(s.YStack,{testID:"swap-content-container",flex:1,marginHorizontal:"auto",width:"100%",maxWidth:t===s.EPageType.modal?"100%":480,children:[(0,b.jsxs)(s.YStack,{pt:"$2.5",px:"$5",pb:"$5",gap:"$5",flex:1,$gtMd:{flex:"unset",pt:t===s.EPageType.modal?"$2.5":"$5"},children:[(0,b.jsx)(z,{defaultSwapType:e?.swapTabSwitchType}),(0,b.jsx)(U,{onSelectToken:P,selectLoading:S}),(0,b.jsx)(Y,{onOpenProviderList:N,quoteResult:I,onOpenRecipient:D}),y.states.length>0&&!h&&!j&&y.quoteId===(null!=(n=I?.quoteId)?n:"")?(0,b.jsx)(R,{alerts:y.states}):null,(0,b.jsx)(k,{onSelectTokenPairs:$,tokenPairs:x,fromTokenAmount:_})]}),(0,b.jsx)(M,{onBuildTx:L,onApprove:F,onWrapped:B})]})})};const SwapMainLand=function(e){return(0,b.jsx)(E.o,{storeName:e?.pageType===s.EPageType.modal?u.EJotaiContextStoreNames.swapModal:u.EJotaiContextStoreNames.swap,children:(0,b.jsx)(SwapMainLoad,SwapMainLand_objectSpread({},e))})}}}]);