"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[38381],{738381:(e,t,i)=>{i.r(t),i.d(t,{default:()=>x});var r=i(586330),s=i(514041),n=i(654266),a=i(908867),o=i(17617),d=i(490343),l=i(259227),c=i(318822),u=i(334439),f=i(948675),g=i(491180),m=i(901976),h=i(100645),y=i(610421),w=i(298254),v=function(e){return e[e.Unverified=0]="Unverified",e[e.Verifying=1]="Verifying",e[e.Verified=2]="Verified",e[e.ForceShow=3]="ForceShow",e}({}),b=i(831085);const x=function ReceiveToken(){(0,m.e)({name:"ReceiveToken9971"});var e=(0,a.A)(),t=(0,n.lq)(),{networkId:i,accountId:x,walletId:p,token:$}=t.params,{account:T,network:S,wallet:k,vaultSettings:_,addressType:j,deriveType:C}=(0,w.b)({accountId:x,networkId:i,walletId:p}),[I,E]=(0,s.useState)(v.Unverified),[A]=(0,l.useHardwareUiStateAtom)(),{copyText:U}=(0,d.useClipboard)(),M=g.A.isQrWallet({walletId:p})||g.A.isHwWallet({walletId:p}),R=(0,s.useMemo)((function(){return!M||(I===v.ForceShow||I===v.Verified||I===v.Verifying&&A?.action===l.EHardwareUiStateAction.REQUEST_BUTTON)}),[I,A?.action,M]),V=(0,s.useMemo)((function(){if(I===v.Verifying&&A?.action===l.EHardwareUiStateAction.REQUEST_BUTTON)return!0}),[I,A?.action]),z=(0,s.useMemo)((function(){return!M||(I===v.ForceShow||I===v.Verified)}),[I,M]),B=I===v.Verifying,H=(0,s.useCallback)((0,r.A)((function*(){E(v.Verifying);try{if(!C)return;var t=yield y.A.serviceAccount.verifyHWAccountAddresses({walletId:p,networkId:i,indexedAccountId:T?.indexedAccountId,deriveType:C,confirmOnDevice:h.hz.EveryItem}),r=t?.[0]?.toLowerCase()===T?.address?.toLowerCase();f.U.transaction.receive.showReceived({walletType:k?.type,isSuccess:r,failedReason:r?"":e.formatMessage({id:u.ETranslations.feedback_address_mismatch})}),r||d.Toast.error({title:e.formatMessage({id:u.ETranslations.feedback_address_mismatch}),message:e.formatMessage({id:u.ETranslations.feedback_address_mismatch_desc})}),E(r?v.Verified:v.Unverified)}catch(e){throw E(v.Unverified),f.U.transaction.receive.showReceived({walletType:k?.type,isSuccess:!1,failedReason:e.message}),e}})),[T?.address,T?.indexedAccountId,C,e,i,k?.type,p]);(0,s.useEffect)((function(){var callback=function(){return E(v.Unverified)};return c.iL.on(c.Tu.CloseHardwareUiStateDialogManually,callback),function(){c.iL.off(c.Tu.CloseHardwareUiStateDialogManually,callback)}}),[]),(0,s.useEffect)((function(){M||f.U.transaction.receive.showReceived({walletType:k?.type,isSuccess:!0,failedReason:""})}),[M,k?.type]);var F=(0,s.useCallback)((function(){return M?I===v.Verified||I===v.ForceShow||B?(0,b.jsx)(d.Button,{mt:"$5",icon:"Copy3Outline",disabled:B,loading:B,onPress:function(){var e;return U(null!=(e=T?.address)?e:"")},children:e.formatMessage({id:u.ETranslations.global_copy_address})}):(0,b.jsxs)(d.YStack,{gap:"$5",alignItems:"center",children:[(0,b.jsx)(d.Button,{mt:"$5",variant:"primary",onPress:H,children:e.formatMessage({id:u.ETranslations.global_verify_on_device})}),(0,b.jsx)(d.Button,{size:"medium",variant:"tertiary",onPress:function(){return E(v.ForceShow)},children:e.formatMessage({id:u.ETranslations.skip_verify_text})})]}):(0,b.jsx)(d.Button,{mt:"$5",icon:"Copy3Outline",onPress:function(){var e;return U(null!=(e=T?.address)?e:"")},children:e.formatMessage({id:u.ETranslations.global_copy_address})})}),[T?.address,I,U,H,e,M,B]),O=(0,s.useCallback)((function(){var t;return T&&S&&k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(d.Stack,{mb:"$5",children:[(0,b.jsxs)(d.XStack,{gap:"$2",alignItems:"center",justifyContent:"center",children:[(0,b.jsx)(d.Heading,{size:"$headingMd",children:null!=(t=$?.symbol)?t:S.symbol}),_?.showAddressType&&j?(0,b.jsx)(d.Badge,{children:j}):null]}),(0,b.jsx)(d.SizableText,{mt:"$1",size:"$bodyMd",color:"$textSubdued",textAlign:"center",children:e.formatMessage({id:u.ETranslations.receive_send_asset_warning_message},{network:S.name})})]}),(0,b.jsxs)(d.Stack,{borderRadius:"$3",borderWidth:o.A.hairlineWidth,borderColor:"$borderSubdued",p:"$4",children:[(0,b.jsx)(d.Stack,{position:"relative",children:(0,b.jsx)(d.QRCode,{value:T.address,size:240,logo:S.isCustomNetwork?void 0:{uri:$?.logoURI||S.logoURI},logoSize:S.isCustomNetwork?void 0:40})}),z?null:(0,b.jsxs)(d.Stack,{position:"absolute",top:"$0",left:"$0",right:"$0",bottom:"$0",alignItems:"center",justifyContent:"center",children:[(0,b.jsx)(d.BlurView,{contentStyle:{borderRadius:"$3",width:"100%",height:"100%",borderCurve:"continuous"},position:"absolute",intensity:100,top:"$0",left:"$0",right:"$0",bottom:"$0"}),(0,b.jsx)(d.Empty,{icon:"EyeOffOutline",description:e.formatMessage({id:u.ETranslations.address_verify_address_instruction})})]})]}),(0,b.jsx)(d.ConfirmHighlighter,{maxWidth:"$96",highlight:V,mt:"$5",px:"$3",borderRadius:"$3",borderCurve:"continuous",children:(0,b.jsx)(d.SizableText,{textAlign:"center",size:"$bodyMd",style:{wordBreak:"break-all"},children:R?T.address:g.A.shortenAddress({address:T.address})})}),R&&I===v.ForceShow?(0,b.jsxs)(d.XStack,{mt:"$1",justifyContent:"center",alignItems:"center",children:[(0,b.jsx)(d.Icon,{name:"InfoCircleOutline",size:"$4",color:"$iconCritical"}),(0,b.jsx)(d.SizableText,{size:"$bodyMd",color:"$textCritical",pl:"$1.5",children:e.formatMessage({id:u.ETranslations.receive_address_unconfimed_alert_message})})]}):null,F()]}):null}),[T,S,k,_?.showAddressType,j,e,$?.logoURI,z,V,R,I,F,$?.symbol]);return(0,b.jsxs)(d.Page,{children:[(0,b.jsx)(d.Page.Header,{title:e.formatMessage({id:u.ETranslations.global_receive})}),(0,b.jsx)(d.Page.Body,{flex:1,justifyContent:"center",alignItems:"center",px:"$5",pb:"$5",children:O()})]})}}}]);