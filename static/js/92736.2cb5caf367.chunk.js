"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[92736],{326745:(e,n,t)=>{t.d(n,{u:()=>useAppRoute});var r=t(654266);function useAppRoute(){return(0,r.lq)()}},925771:(e,n,t)=>{t.d(n,{$:()=>CalculationListItem,k:()=>CalculationList});var r=t(324586),i=t(839850),o=t(490343),a=t(831085),s=["children"],l=["children"],c=["children"];function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach((function(n){(0,r.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function CalculationList({children:e}){return(0,a.jsx)(o.YStack,{gap:"$4",children:e})}function CalculationListItem(e){var{children:n}=e,t=(0,i.A)(e,s);return(0,a.jsx)(o.XStack,_objectSpread(_objectSpread({animation:"quick",enterStyle:{opacity:0},justifyContent:"space-between",alignItems:"center"},t),{},{children:n}))}CalculationList.Item=CalculationListItem,CalculationListItem.Label=function CalculationListItemLabel(e){var{children:n}=e,t=(0,i.A)(e,l);return(0,a.jsx)(o.SizableText,_objectSpread(_objectSpread({color:"$textSubdued"},t),{},{children:n}))},CalculationListItem.Value=function CalculationListItemValue(e){var{children:n}=e,t=(0,i.A)(e,c);return(0,a.jsx)(o.SizableText,_objectSpread(_objectSpread({size:"$bodyLgMedium"},t),{},{children:n}))}},286192:(e,n,t)=>{t.d(n,{BA:()=>EstimateNetworkFee,QL:()=>useShowClaimEstimateGasAlert,fH:()=>calcDaysSpent,sM:()=>useShowStakeEstimateGasAlert});var r=t(514041),i=t(241440),o=t(908867),a=t(490343),s=t(259227),l=t(334439),c=t(925771),d=t(831085),useShowStakeEstimateGasAlert=function(){var e=(0,o.A)(),[{currencyInfo:{symbol:n}}]=(0,s.useSettingsPersistAtom)();return(0,r.useCallback)((function({daysConsumed:t,estFiatValue:r,onConfirm:i}){var o=t?e.formatMessage({id:l.ETranslations.earn_transaction_loss_when_stake},{number:(0,d.jsx)(a.SizableText,{size:"$bodyLgMedium",color:"$textCaution",children:t})}):void 0;a.Dialog.show({title:e.formatMessage({id:l.ETranslations.earn_transaction_loss}),icon:"InfoCircleOutline",description:o,renderContent:(0,d.jsxs)(a.XStack,{children:[(0,d.jsxs)(a.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.global_est_network_fee}),":"]}),(0,d.jsx)(a.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:r})]}),onConfirm:i})}),[e,n])},useShowClaimEstimateGasAlert=function(){var e=(0,o.A)(),[{currencyInfo:{symbol:n}}]=(0,s.useSettingsPersistAtom)();return(0,r.useCallback)((function({claimTokenFiatValue:t,estFiatValue:r,onConfirm:o}){var s=(0,i.A)(t).minus(r).absoluteValue().toFixed(),c=e.formatMessage({id:l.ETranslations.earn_transaction_loss_when_claim},{number:(0,d.jsx)(a.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",color:"$textCaution",formatterOptions:{currency:n},children:s})});a.Dialog.show({title:e.formatMessage({id:l.ETranslations.earn_transaction_loss}),icon:"InfoCircleOutline",description:c,renderContent:(0,d.jsxs)(a.YStack,{children:[(0,d.jsxs)(a.XStack,{children:[(0,d.jsxs)(a.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.global_est_network_fee}),":"]}),(0,d.jsx)(a.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:r})]}),(0,d.jsxs)(a.XStack,{children:[(0,d.jsxs)(a.SizableText,{size:"$bodyLg",mr:"$1",children:[e.formatMessage({id:l.ETranslations.earn_reward_value}),":"]}),(0,d.jsx)(a.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:n},children:t})]})]}),onConfirm:o})}),[e,n])},EstimateNetworkFeeListItem=function({estFiatValue:e,onPress:n}){var t=(0,o.A)(),[{currencyInfo:{symbol:r}}]=(0,s.useSettingsPersistAtom)();return Number(e)>0?(0,d.jsxs)(c.$,{onPress:n,children:[(0,d.jsx)(c.$.Label,{children:t.formatMessage({id:l.ETranslations.global_est_network_fee})}),(0,d.jsxs)(a.XStack,{alignItems:"center",cursor:n?"pointer":void 0,mr:n?-6:void 0,children:[(0,d.jsx)(a.NumberSizeableText,{size:"$bodyLgMedium",formatter:"value",formatterOptions:{currency:r},children:e}),n?(0,d.jsx)(a.Icon,{name:"ChevronRightSmallOutline",size:24}):null]})]}):null},calcDaysSpent=function(e,n){var t=(0,i.A)(n).div(e).multipliedBy(365);return t.isNaN()?void 0:Math.ceil(t.toNumber())},EstimateNetworkFee=function({estimateFeeResp:e,onPress:n,isVisible:t}){return e&&t?(0,d.jsx)(EstimateNetworkFeeListItem,{estFiatValue:e.feeFiatValue,onPress:n}):null}},338443:(e,n,t)=>{t.d(n,{m:()=>OptionList});var r=t(586330),i=t(514041),o=t(908867),a=t(17617),s=t(490343),l=t(391944),c=t(498356),d=t(259227),u=t(334439),m=t(831085),f=(0,i.createContext)({}),ExtraField=function({name:e,renderItem:n,item:t}){return(0,m.jsxs)(s.XStack,{justifyContent:"space-between",children:[(0,m.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:e}),(0,m.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",children:n({item:t})})]})},OptionItem=function({item:e,token:n,network:t,onPress:r}){var[{currencyInfo:{symbol:c}}]=(0,d.useSettingsPersistAtom)(),{extraFields:b,activeId:g}=(0,i.useContext)(f),k=g===e.id,y=(0,o.A)();return(0,m.jsx)(s.Stack,{px:"$5",py:"$2",children:(0,m.jsxs)(s.YStack,{group:!0,onPress:function(){return r?.({item:e})},borderWidth:a.A.hairlineWidth,borderColor:k?"$borderActive":"$borderSubdued",borderRadius:"$3",borderCurve:"continuous",overflow:"hidden",userSelect:"none",children:[(0,m.jsxs)(s.XStack,{bg:"$bgSubdued","$group-hover":{bg:"$bgHover"},"$group-press":{bg:"$bgActive"},"$group-":!0,px:14,py:12,jc:"space-between",ai:"center",children:[(0,m.jsxs)(s.XStack,{children:[(0,m.jsx)(s.Stack,{pr:"$3",children:(0,m.jsx)(l.o,{tokenImageUri:n.logoURI,networkImageUri:t?.logoURI})}),(0,m.jsxs)(s.YStack,{children:[(0,m.jsx)(s.NumberSizeableText,{size:"$bodyLgMedium",formatter:"balance",formatterOptions:{tokenSymbol:n?.symbol},children:e.amount}),(0,m.jsx)(s.NumberSizeableText,{size:"$bodyMd",color:"$textSubdued",formatter:"value",formatterOptions:{currency:c},children:e.fiatValue})]})]}),e.isPending?(0,m.jsx)(s.Stack,{children:(0,m.jsx)(s.Badge,{badgeType:"info",children:y.formatMessage({id:u.ETranslations.global_pending})})}):null]}),b&&b.length>0?(0,m.jsx)(s.YStack,{py:12,px:14,gap:10,children:b.map((function(n){return(0,m.jsx)(i.Suspense,{fallback:null,children:(0,m.jsx)(ExtraField,{name:n.name,renderItem:n.renderItem,item:e})},n.name)}))}):null]})})},ListEmptyComponent=function(){var e=(0,o.A)();return(0,m.jsx)(s.Empty,{icon:"ClockTimeHistoryOutline",title:e.formatMessage({id:u.ETranslations.earn_no_orders}),description:e.formatMessage({id:u.ETranslations.earn_no_orders_desc})})},OptionList=function({items:e,token:n,network:t,onPress:o,onConfirmText:a,extraFields:l,ListHeaderComponent:d}){var u=(0,c.A)(),[b,g]=(0,i.useState)(e[0]?.id),[k,y]=(0,i.useState)(!1),p=(0,i.useCallback)((function({item:e}){return(0,m.jsx)(OptionItem,{item:e,token:n,network:t,onPress:function({item:e}){return g(e.id)}})}),[n,t]),x=(0,i.useCallback)((0,r.A)((function*(){var n=e.find((function(e){return e.id===b}));if(n)try{y(!0),yield o?.({item:n})}finally{y(!1)}})),[e,b,o]),v=(0,i.useMemo)((function(){return{extraFields:l,activeId:b}}),[l,b]),S=(0,i.useMemo)((function(){return!b||!e.find((function(e){return e.id===b&&!e.isPending}))}),[b,e]);return(0,m.jsx)(f.Provider,{value:v,children:(0,m.jsxs)(s.Stack,{children:[(0,m.jsx)(s.ListView,{estimatedItemSize:"$5",data:e,renderItem:p,ListHeaderComponent:d,ListEmptyComponent}),(0,m.jsx)(s.Page.Footer,{onConfirmText:a,confirmButtonProps:{onPress:x,disabled:S,loading:k},cancelButtonProps:{onPress:function(){u.pop()}}})]})})}},138584:(e,n,t)=>{t.d(n,{Py:()=>SimpleSpinnerSkeleton,am:()=>isLoadingState,bU:()=>PageFrame,o0:()=>isErrorState});var r=t(908867),i=t(490343),o=t(791088),a=t(334439),s=t(831085),PageErrOccurred=function({onPress:e}){var n=(0,r.A)();return(0,s.jsx)(i.Empty,{pt:"$32",icon:"ErrorOutline",title:n.formatMessage({id:a.ETranslations.global_an_error_occurred}),description:n.formatMessage({id:a.ETranslations.global_an_error_occurred_desc}),buttonProps:{onPress:e,children:n.formatMessage({id:a.ETranslations.global_refresh})}})},SimpleSpinnerSkeleton=function(){return(0,s.jsxs)(i.Stack,{children:[(0,s.jsx)(i.Stack,{px:"$5",py:"$2",children:(0,s.jsx)(i.Skeleton.HeadingSm,{})}),Array.from({length:3}).map((function(e,n){return(0,s.jsxs)(o.c,{children:[(0,s.jsx)(i.Skeleton,{h:"$10",w:"$10",radius:"round"}),(0,s.jsxs)(i.Stack,{children:[(0,s.jsx)(i.Skeleton.BodyLg,{}),(0,s.jsx)(i.Skeleton.BodyMd,{})]})]},n)}))]})},isLoadingState=function({result:e,isLoading:n}){return Boolean(void 0===e&&(void 0===n||!0===n))},isErrorState=function({result:e,isLoading:n}){return Boolean(void 0===e&&!1===n)},PageFrame=function({children:e,loading:n,LoadingSkeleton:t,error:r,onRefresh:i}){return n?t?(0,s.jsx)(t,{}):null:r?(0,s.jsx)(PageErrOccurred,{onPress:i}):(0,s.jsx)(s.Fragment,{children:e})}},653913:(e,n,t)=>{t.d(n,{B8:()=>useUniversalStake,D0:()=>useUniversalClaim,Pg:()=>useUniversalWithdraw});var r=t(586330),i=t(514041),o=t(241440),a=t(610421),s=t(927799),l=t(553083),c=t(161024),d=t(286192);function useUniversalStake({networkId:e,accountId:n}){var t,{navigationToSendConfirm:o}=(0,s.E)({accountId:n,networkId:e});return(0,i.useCallback)((t=(0,r.A)((function*({amount:t,symbol:r,term:i,feeRate:s,provider:c,stakingInfo:d,onSuccess:u,onFail:m}){var f,b,g=yield a.A.serviceStaking.buildStakeTransaction({amount:t,networkId:e,accountId:n,symbol:r,term:i,provider:c,feeRate:s}),k=yield a.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:g});l.Ay.isBTCNetwork(e)&&k.fee&&(f=!0,b=!1),yield o({encodedTx:k,stakingInfo:d,onSuccess:u,onFail:m,useFeeInTx:f,feeInfoEditable:b})})),function(e){return t.apply(this,arguments)}),[o,n,e])}function useUniversalWithdraw({networkId:e,accountId:n}){var t,{navigationToSendConfirm:o}=(0,s.E)({accountId:n,networkId:e});return(0,i.useCallback)((t=(0,r.A)((function*({amount:t,symbol:i,provider:s,identity:d,stakingInfo:u,onSuccess:m,onFail:f}){var b,g=yield a.A.serviceStaking.getStakingConfigs({networkId:e,symbol:i,provider:s});if(!g)throw new Error("Staking config not found");if(g?.unstakeWithSignMessage){var k=yield a.A.serviceAccount.getAccount({accountId:n,networkId:e}),{message:y,deadline:p}=yield a.A.serviceStaking.buildLidoEthPermitMessageData({accountId:n,networkId:e,amount:t}),x=yield a.A.serviceDApp.openSignMessageModal({accountId:n,networkId:e,request:{origin:"https://lido.fi/",scope:"ethereum"},unsignedMessage:{type:c.$.TYPED_DATA_V4,message:y,payload:[k.address,y]},walletInternalSign:!0});b=yield a.A.serviceStaking.buildUnstakeTransaction({amount:t,networkId:e,accountId:n,symbol:i,provider:s,signature:x,deadline:p})}else b=yield a.A.serviceStaking.buildUnstakeTransaction({amount:t,identity:d,networkId:e,accountId:n,symbol:i,provider:s});var v,S,h,I=yield a.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:b});l.Ay.isBTCNetwork(e)&&I.fee&&(v=!0,S=!1),yield o({encodedTx:I,stakingInfo:u,signOnly:g?.withdrawSignOnly,useFeeInTx:v,feeInfoEditable:S,onSuccess:(h=(0,r.A)((function*(t){if(g?.withdrawSignOnly){var r=t[0].signedTx.finalizedPsbtHex;r&&d&&(yield a.A.serviceStaking.unstakePush({txId:d,networkId:e,accountId:n,symbol:i,provider:s,unstakeTxHex:r}),m?.(t))}else m?.(t)})),function onSuccess(e){return h.apply(this,arguments)}),onFail:f})})),function(e){return t.apply(this,arguments)}),[n,e,o])}function useUniversalClaim({networkId:e,accountId:n}){var t,{navigationToSendConfirm:c}=(0,s.E)({accountId:n,networkId:e}),u=(0,d.QL)();return(0,i.useCallback)((t=(0,r.A)((function*({identity:t,amount:i,provider:s,symbol:d,stakingInfo:m,onSuccess:f,onFail:b}){var g,k=(g=(0,r.A)((function*(){var r,o,u=yield a.A.serviceStaking.buildClaimTransaction({networkId:e,accountId:n,symbol:d,provider:s,amount:i,identity:t}),g=yield a.A.serviceStaking.buildEarnTx({networkId:e,accountId:n,tx:u});l.Ay.isBTCNetwork(e)&&g.fee&&(r=!0,o=!1),yield c({encodedTx:g,stakingInfo:m,onSuccess:f,onFail:b,useFeeInTx:r,feeInfoEditable:o})})),function continueClaim(){return g.apply(this,arguments)});if(Number(i)>0){var y=yield a.A.serviceStaking.estimateFee({networkId:e,provider:s,symbol:d,action:"claim",amount:i}),p=(0,o.A)(y.token.price).multipliedBy(i);if(p.lt(y.feeFiatValue))return void u({claimTokenFiatValue:p.toFixed(),estFiatValue:y.feeFiatValue,onConfirm:k})}yield k()})),function(e){return t.apply(this,arguments)}),[c,n,e,u])}},292736:(e,n,t)=>{t.r(n),t.d(n,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=t(586330),i=t(514041),o=t(908867),a=t(490343),s=t(610421),l=t(498356),c=t(326745),d=t(911998),u=t(334439),m=t(948675),f=t(491180),b=t(553083),g=t(550082),k=t(338443),y=t(138584),p=t(653913),x=t(905817),v=t(831085);const __WEBPACK_DEFAULT_EXPORT__=function(){var e,n=(0,c.u)(),t=(0,l.A)(),{accountId:S,networkId:h,symbol:I,provider:j,details:w}=n.params,{result:T,isLoading:A,run:C}=(0,d.yk)((function(){return s.A.serviceStaking.getClaimableList({networkId:h,accountId:S,symbol:I,provider:j})}),[S,h,I,j],{watchLoading:!0}),_=(0,p.D0)({accountId:S,networkId:h}),$=(0,i.useCallback)((e=(0,r.A)((function*({item:e}){var n;yield _({identity:e.id,amount:e.amount,symbol:w.token.info.symbol,provider:j,stakingInfo:{label:g.D.Claim,protocol:j,protocolLogoURI:w.provider.logoURI,receive:{token:w.token.info,amount:e.amount},tags:[(0,x.Y)(w)]},onSuccess:(n=(0,r.A)((function*(n){n[0]&&(yield s.A.serviceStaking.addBabylonTrackingItem({txId:e.id,action:"claim",createAt:Date.now(),accountId:S,networkId:h,amount:e.amount})),t.pop(),m.U.staking.page.unstaking({token:w.token.info,stakingProtocol:j}),"babylon"===j&&s.A.serviceStaking.babylonClaimRecord({accountId:S,networkId:h,provider:j,symbol:I,identity:e.id})})),function onSuccess(e){return n.apply(this,arguments)})})})),function(n){return e.apply(this,arguments)}),[t,w,_,j,S,h,I]),P=(0,o.A)();return(0,v.jsxs)(a.Page,{scrollEnabled:!0,children:[(0,v.jsx)(a.Page.Header,{title:P.formatMessage({id:u.ETranslations.earn_select_a_claimable_order})}),(0,v.jsx)(a.Page.Body,{children:(0,v.jsx)(y.bU,{LoadingSkeleton:y.Py,loading:(0,y.am)({result:T,isLoading:A}),error:(0,y.o0)({result:T,isLoading:A}),onRefresh:C,children:T?(0,v.jsx)(k.m,{items:T.items,token:T.token,network:T.network,onPress:$,onConfirmText:P.formatMessage({id:u.ETranslations.earn_claim}),extraFields:b.Ay.isBTCNetwork(h)?[{name:P.formatMessage({id:u.ETranslations.global_status}),renderItem:()=>P.formatMessage({id:u.ETranslations.earn_claimable})},{name:P.formatMessage({id:u.ETranslations.global_transaction_id}),renderItem:({item:e})=>f.A.shortenAddress({address:e.id})}]:void 0}):null})})]})}},905817:(e,n,t)=>{t.d(n,{FZ:()=>countDecimalPlaces,Y:()=>buildLocalTxStatusSyncId,c:()=>capitalizeString});var r=t(241440),buildLocalTxStatusSyncId=function(e){return`${e.provider.name.toLowerCase()}-${e.token.info.symbol.toLowerCase()}`};function capitalizeString(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function countDecimalPlaces(e){var n="string"==typeof e?Number(e):e;if(Number.isNaN(n))return 0;var t="string"==typeof e?e:(0,r.A)(e).toFixed(),i=t.indexOf(".");return-1===i?0:t.length-i-1}}}]);