"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[87862],{687862:(e,t,n)=>{n.r(t),n.d(t,{V4MigrationPreview:()=>V4MigrationPreview,default:()=>j});var r=n(586330),o=n(324586),i=n(514041),a=n(908867),s=n(17617),c=n(490343),l=n(610421),u=n(791088),d=n(880590),f=n(498356),p=n(911998),g=n(229263),b=n(259227),v=n(334439),m=n(392097),y=n(774614),x=n(883085),h=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function BackupDialogContent({item:e,confirmText:t}){var n=(0,a.A)(),[o,u]=(0,b.useV4migrationAtom)(),[f,p]=(0,i.useState)(!0),{copyText:g}=(0,c.useClipboard)(),[m,y]=(0,i.useState)(""),x=(e?.network&&(0,h.jsxs)(c.XStack,{mb:"$4",children:[(0,h.jsx)(d.um,{networkId:e.network.id}),(0,h.jsx)(c.SizableText,{ml:"$2",color:"$textSubdued",children:e.network.name})]}),(0,h.jsx)(c.Dialog.Footer,{showCancelButton:!1,onConfirmText:t,confirmButtonProps:{disabled:f},onConfirm:function(){u((function(t){return _objectSpread(_objectSpread({},t),{},{backedUpMark:_objectSpread(_objectSpread({},t.backedUpMark),{},{[e.backupId]:!0})})}))}}));if(f){var j="Click to view the content, make sure no one is looking your screen";return e.hdWallet&&(j=n.formatMessage({id:v.ETranslations.v4_migration_backup_recovery_phrase_reveal_alert})),e.importedAccount&&(j=n.formatMessage({id:v.ETranslations.v4_migration_backup_private_key_reveal_alert})),(0,h.jsxs)(c.Stack,{children:[(0,h.jsxs)(c.Stack,{p:"$5",userSelect:"none",borderRadius:"$3",borderCurve:"continuous",borderWidth:s.A.hairlineWidth,borderColor:"$borderSubdued",backgroundColor:"$bgSubdued",alignItems:"center",justifyContent:"center",hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusable:!0,focusVisibleStyle:{outlineWidth:2,outlineColor:"$focusRing",outlineStyle:"solid",outlineOffset:2},onPress:(0,r.A)((function*(){if(e?.hdWallet?.id){var t=yield l.A.serviceV4Migration.revealV4HdMnemonic({hdWalletId:e.hdWallet.id});y(t.mnemonic)}if(e?.importedAccount?.id){var n=yield l.A.serviceV4Migration.revealV4ImportedPrivateKey({accountId:e.importedAccount.id});y(n.exportedPrivateKey||n.privateKey)}p(!1)})),children:[(0,h.jsx)(c.Icon,{size:"$8",name:"EyeOutline"}),(0,h.jsx)(c.SizableText,{pt:"$5",color:"$textSubdued",textAlign:"center",children:j})]}),x]})}return(0,h.jsxs)(c.Stack,{children:[(0,h.jsxs)(c.Stack,{py:"$1",px:"$2.5",borderRadius:"$3",borderCurve:"continuous",borderWidth:s.A.hairlineWidth,borderColor:"$borderSubdued",backgroundColor:"$bgSubdued",children:[e?.hdWallet?.id?(0,h.jsx)(c.XStack,{flexWrap:"wrap",children:m.split(" ").map((function(e,t){return(0,h.jsxs)(c.XStack,{minWidth:"33.33%",alignItems:"baseline",p:"$1.5",borderBottomWidth:s.A.hairlineWidth,borderBottomColor:"$borderSubdued",children:[(0,h.jsx)(c.SizableText,{size:"$bodyMd",color:"$textDisabled",minWidth:"$4",mr:"$1",children:t+1}),(0,h.jsx)(c.SizableText,{flex:1,size:"$bodyLg",children:e})]},t)}))}):null,e?.importedAccount?.id?(0,h.jsx)(c.SizableText,{mt:"$2",mx:"$1.5",color:"$text",size:"$bodyLg",children:m}):null,(0,h.jsx)(c.Stack,{p:"$2",children:(0,h.jsx)(c.Button,{onPress:function(){return g(m)},variant:"tertiary",children:n.formatMessage({id:v.ETranslations.global_copy})})})]}),x]})}function BackupedMarkLabel({backupId:e}){var[t]=(0,b.useV4migrationAtom)(),n=(0,a.A)();return e&&t?.backedUpMark?.[e]?(0,h.jsx)(u.c.Text,{align:"right",secondary:n.formatMessage({id:v.ETranslations.global_backed_up}),secondaryTextProps:{size:"$bodyLg"}}):null}function AccountsSectionList(){var e=(0,a.A)(),{serviceV4Migration:t}=l.A,{result:n=[]}=(0,p.yk)((function(){return t.buildV4WalletsForBackupSectionData()}),[t]),r=(0,i.useCallback)((function({item:t}){var n,r="I've backed up";t.hdWallet&&(r=e.formatMessage({id:v.ETranslations.global_saved_the_phrases}),n=e.formatMessage({id:v.ETranslations.onboarding_backup_recovery_phrase_help_text})),t.importedAccount&&(r=e.formatMessage({id:v.ETranslations.global_saved_the_private_key})),c.Dialog.show({showCancelButton:!1,showConfirmButton:!1,onConfirmText:r,title:t.title,description:n,renderContent:(0,h.jsx)(BackupDialogContent,{item:t,confirmText:r})})}),[e]);return(0,h.jsx)(c.SectionList,{sections:n,renderSectionHeader:function({section:{title:e},index:t}){return(0,h.jsx)(c.SectionList.SectionHeader,{title:e})},estimatedItemSize:"$10",stickySectionHeadersEnabled:!0,renderItem:function({item:e,index:t}){var n;if(e.hdWallet&&e?.hdWallet?.avatar){var o=e?.hdWallet?.avatar?.emoji;if(!o)try{var i=JSON.parse(e?.hdWallet?.avatar);o=i?.emoji}catch(e){}o&&(n=(0,h.jsx)(c.Stack,{w:"$8",h:"$8",justifyContent:"center",alignItems:"center",children:(0,h.jsx)(c.SizableText,{size:"$heading3xl",children:o})}))}else e?.network?.id&&(n=(0,h.jsx)(d.um,{size:"$8",networkId:e.network.id}));if(!n&&e.networkId){var a=g.A.getNotSupportNetworkInfo({networkId:e.networkId});n=(0,h.jsx)(c.Image,{size:"$8",src:a?.logo||""})}var s=`${e.backupId||""}-${e.title||""}-${e.networkId||""}-${t}`;return(0,h.jsx)(u.c,{title:e.title,subtitle:e.subTitle,subtitleProps:{numberOfLines:1},onPress:function(){r({item:e})},drillIn:!0,renderAvatar:n,children:(0,h.jsx)(BackupedMarkLabel,{backupId:e?.backupId},s)},s)}})}function ConfirmMigrationContent({navigation:e}){var[t,n]=(0,i.useState)(!0),[r,o]=(0,i.useState)(3),s=(0,a.A)();return(0,i.useEffect)((function(){var e=setInterval((function(){o((function(t){return 1===t?(n(!1),clearInterval(e),t):t-1}))}),1e3);return function(){clearInterval(e)}}),[]),(0,h.jsxs)(c.Stack,{children:[(0,h.jsx)(c.SizableText,{children:s.formatMessage({id:v.ETranslations.v4_migration_backed_up_warning_desc})}),(0,h.jsx)(c.Dialog.Footer,{onCancelText:s.formatMessage({id:v.ETranslations.global_review_again}),onConfirmText:t?`${r}s`:s.formatMessage({id:v.ETranslations.global_confirm}),confirmButtonProps:{disabled:t},onConfirm:function(){e.push(m.xl.V4MigrationProcess)}},t?"disabled":"enabled")]})}function V4MigrationPreview({route:e}){var t=(0,f.A)(),n=(0,a.A)(),[o,s]=(0,i.useState)(!1),{serviceV4Migration:u}=l.A,d=(0,i.useCallback)((0,r.A)((function*(){try{s(!0),c.Dialog.show({tone:"warning",icon:"ErrorOutline",title:n.formatMessage({id:v.ETranslations.v4_migration_backed_up_warning}),renderContent:(0,h.jsx)(ConfirmMigrationContent,{navigation:t})})}finally{s(!1)}})),[n,t]);return(0,h.jsxs)(x.l,{children:[(0,h.jsx)(c.Page.Header,{headerTitle:n.formatMessage({id:v.ETranslations.v4_migration_backup_title}),headerRight:y.h}),(0,h.jsxs)(c.Page.Body,{children:[(0,h.jsx)(y.U,{children:(0,h.jsx)(c.Alert,{m:"$5",mt:"$2.5",type:"warning",title:n.formatMessage({id:v.ETranslations.v4_migration_backup_alert_title}),description:n.formatMessage({id:v.ETranslations.v4_migration_backup_alert_desc})})}),(0,h.jsx)(AccountsSectionList,{})]}),(0,h.jsx)(c.Page.Footer,{confirmButton:(0,h.jsx)(c.Page.ConfirmButton,{loading:o,onConfirm:d,children:n.formatMessage({id:v.ETranslations.v4_migration_backup_primary_action})})})]})}const j=V4MigrationPreview},774614:(e,t,n)=>{n.d(t,{U:()=>V4MigrationLogCopy,h:()=>V4MigrationLogCopyHeaderRight});var r=n(324586),o=n(839850),i=n(490343),a=n(518736),s=(n(663522),n(621591)),c=n(831085),l=["children"];function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V4MigrationLogCopy(e){var{children:t}=e,n=(0,o.A)(e,l),r=(0,s.D)();return(0,c.jsx)(a.P,_objectSpread(_objectSpread({},n),{},{onPress:function(){r.copyV4MigrationLogs()},children:t}))}function V4MigrationLogCopyHeaderRight(){return(0,c.jsx)(V4MigrationLogCopy,{children:(0,c.jsx)(i.Stack,{w:"$8",h:"$8",backgroundColor:void 0})})}},883085:(e,t,n)=>{n.d(t,{l:()=>V4MigrationModalPage});var r=n(324586),o=n(586330),i=n(839850),a=n(514041),s=n(490343),c=n(153763),l=n(259227),u=n(60406),d=n(831085),f=["children","onMounted","exitPreventMode","isAutoStartOnMount"];function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V4MigrationModalPage(e){var{children:t,onMounted:n,exitPreventMode:r=u.yN.confirm,isAutoStartOnMount:p}=e,g=(0,i.A)(e,f),b=(0,a.useRef)(null),v=(0,c.E)();return(0,u.ek)({exitPreventMode:r,isAutoStartOnMount:p}),(0,a.useEffect)((function(){v&&clearTimeout(b.current)}),[v]),(0,d.jsx)(s.Page,_objectSpread(_objectSpread({scrollEnabled:!0,onMounted:(0,o.A)((function*(){yield l.v4migrationAtom.set((function(e){return _objectSpread(_objectSpread({},e),{},{isMigrationModalOpen:!0})})),n?.()})),onUnmounted:function(){},onClose:function(){}},g),{},{children:t}))}},60406:(e,t,n)=>{n.d(t,{EE:()=>useIsV4MigrationAutoStartFirstTime,ek:()=>useV4MigrationExitPrevent,yN:()=>y});var r=n(324586),o=n(514041),i=n(334025),a=n(908867),s=n(355931),c=n(493360),l=n(490343),u=n(498356),d=n(153763),f=n(259227),p=n(334439),g=n(663522),b=n(621591),v=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=!1,y=function(e){return e.always="always",e.confirm="confirm",e.disabled="disabled",e}({});function ModalExitPreventDialogContent({message:e,onCancelText:t,onConfirmText:n,preventRemoveData:r,isAutoStartOnMount:i}){var s=(0,a.A)(),c=(0,u.A)(),[d,g]=(0,f.useV4migrationPersistAtom)(),[b,m]=(0,o.useState)(!1);return(0,v.jsxs)(l.Stack,{children:[(0,v.jsx)(l.SizableText,{children:e}),i&&(d?.v4migrationAutoStartCount||0)>=3?(0,v.jsx)(l.Stack,{children:(0,v.jsx)(l.Checkbox,{value:b,onChange:function(){return m(!b)},label:s.formatMessage({id:p.ETranslations.v4_migration_exit_migration_checkbox_label})})}):null,(0,v.jsx)(l.Dialog.Footer,{onConfirmText:n,onConfirm:function(){c.dispatch(r.action),b&&g((function(e){return _objectSpread(_objectSpread({},e),{},{v4migrationAutoStartDisabled:!0})}))},onCancelText:t})]})}function useIsV4MigrationAutoStartFirstTime(){var[e]=(0,f.useV4migrationPersistAtom)();return!e.v4migrationAutoStartDisabled&&(!e?.v4migrationAutoStartCount||e?.v4migrationAutoStartCount<=1)}function useV4MigrationExitPrevent({exitPreventMode:e,isAutoStartOnMount:t}){var n=(0,a.A)(),r=n.formatMessage({id:p.ETranslations.confirm_exit_dialog_title}),u=n.formatMessage({id:p.ETranslations.confirm_exit_dialog_desc}),f=n.formatMessage({id:p.ETranslations.global_exit}),x=n.formatMessage({id:p.ETranslations.global_cancel}),h=useIsV4MigrationAutoStartFirstTime();(0,i.Wg)(),function useModalExitPrevent({exitPreventMode:e,isAutoStartOnMount:t,title:n,message:r,onConfirmText:i,onCancelText:a}){var s=(0,d.E)(),c=(0,o.useCallback)((function({data:e}){m||(m=!0,l.Dialog.show({title:n,renderContent:(0,v.jsx)(ModalExitPreventDialogContent,{onCancelText:a,onConfirmText:i,preventRemoveData:e,message:r,isAutoStartOnMount:t}),onClose:function(){m=!1}}))}),[t,r,a,i,n]),u=e!==y.disabled&&s,f=e===y.confirm?c:function(){return null};(0,l.usePreventRemove)(u,f)}({exitPreventMode:h&&e===y.confirm?y.always:e,isAutoStartOnMount:t,title:r,message:u,onConfirmText:f,onCancelText:x}),function useAppExitPrevent({message:e,title:t}){var n=(0,a.A)();(0,o.useEffect)((function(){if(g.Ay.isRuntimeBrowser&&!g.Ay.isExtensionUiPopup){var fn=function(t){return t.preventDefault(),t.returnValue=!0,e};return window.addEventListener("beforeunload",fn),function(){window.removeEventListener("beforeunload",fn)}}}),[e]),(0,o.useEffect)((function(){var r=c.A.addEventListener("hardwareBackPress",(function(){return s.A.alert(t,e,[{text:n.formatMessage({id:p.ETranslations.global_cancel}),onPress:function(){},style:"cancel"},{text:n.formatMessage({id:p.ETranslations.global_quit}),onPress:function(){return c.A.exitApp()}}],{cancelable:!1}),!0}));return function(){return r.remove()}}),[e,t,n])}({title:r,message:u}),function useExtensionV4MigrationFromExpandTab(){var e=(0,b.D)();(0,o.useEffect)((function(){g.Ay.isExtensionUiPopup&&(e.openV4MigrationOfExtension(),window.close())}),[e])}()}},334025:(e,t,n)=>{n.d(t,{Wg:()=>useKeepAwake});var r,o=n(586330),i=n(72631),a=n(514041),s=n(683180),c=n(34546);!function(e){e.RELEASE="release"}(r||(r={}));var l={};const u={isAvailableAsync:()=>(0,o.A)((function*(){return!!s.A.isDOMAvailable&&"wakeLock"in navigator}))(),activate:e=>(0,o.A)((function*(){if(s.A.isDOMAvailable){var t=yield navigator.wakeLock.request("screen");l[e]=t}}))(),deactivate:e=>(0,o.A)((function*(){if(s.A.isDOMAvailable){if(!l[e])throw new c.A("ERR_KEEP_AWAKE_TAG_INVALID",`The wake lock with tag ${e} has not activated yet`);l[e].release?.(),delete l[e]}}))(),addListenerForTag(e,t){var eventListener=function(){t({state:r.RELEASE})},n=l[e];return n&&("addEventListener"in n?n.addEventListener?.("release",eventListener):n.onrelease=eventListener),{remove:function(){var t=l[e];t&&(t.removeEventListener?t.removeEventListener("release",eventListener):t.onrelease=null)}}}};var d="ExpoKeepAwakeDefaultTag";function useKeepAwake(e=d,t){(0,a.useEffect)((function(){var n=!0;return activateKeepAwakeAsync(e).then((function(){n&&u.addListenerForTag&&t?.listener&&function addListener(e,t){if(!u.addListenerForTag)throw new i.V("ExpoKeepAwake","addListenerForTag");var n="string"==typeof e?e:d,r="function"==typeof e?e:t;return u.addListenerForTag(n,r)}(e,t.listener)})),function(){n=!1,t?.suppressDeactivateWarnings?deactivateKeepAwake(e).catch((function(){})):deactivateKeepAwake(e)}}),[e])}function activateKeepAwakeAsync(){return _activateKeepAwakeAsync.apply(this,arguments)}function _activateKeepAwakeAsync(){return(_activateKeepAwakeAsync=(0,o.A)((function*(e=d){yield u.activate?.(e)}))).apply(this,arguments)}function deactivateKeepAwake(){return _deactivateKeepAwake.apply(this,arguments)}function _deactivateKeepAwake(){return(_deactivateKeepAwake=(0,o.A)((function*(e=d){yield u.deactivate?.(e)}))).apply(this,arguments)}}}]);