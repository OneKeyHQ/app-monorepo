"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[55680],{793437:(e,t,n)=>{n.d(t,{X:()=>OpenInAppButton});var r=n(586330),o=n(514041),i=n(908867),a=n(17617),s=n(490343),c=n(889949),l=n(726130),u=n(334439),d=n(663522),f=n(117746),k=n(911998),p=n(831085);function OpenInAppButton({buildDeepLinkUrl:e,buildFullUrl:t}){var n=(0,i.A)(),{result:y}=(0,k.yk)((0,r.A)((function*(){var t=e();return(yield f.Ay.linkingCanOpenURL(t))?t:""})),[e]),m=((0,o.useMemo)((function(){return d.Ay.isWebMobile?d.Ay.isWebMobileAndroid?"Open by OneKey Android":d.Ay.isWebMobileIOS?"Open by OneKey iOS":void 0:"Open by OneKey Desktop"}),[]),(0,o.useCallback)((0,r.A)((function*(){var e=yield t();s.Dialog.show({title:n.formatMessage({id:u.ETranslations.open_in_mobile_app}),floatingPanelProps:{overflow:"hidden"},renderContent:(0,p.jsxs)(s.Stack,{children:[(0,p.jsx)(s.Stack,{alignItems:"center",justifyContent:"center",overflow:"hidden",children:(0,p.jsx)(s.Stack,{p:"$4",borderRadius:"$6",borderCurve:"continuous",borderWidth:a.A.hairlineWidth,borderColor:"$borderSubdued",children:(0,p.jsx)(s.QRCode,{value:e,logo:c,logoSize:40,size:224})})}),(0,p.jsxs)(s.XStack,{m:"$-5",mt:"$5",py:"$4",px:"$5",backgroundColor:"$bgSubdued",alignItems:"center",children:[(0,p.jsx)(s.SizableText,{size:"$bodyMd",color:"$textSubdued",flex:1,children:n.formatMessage({id:u.ETranslations.dont_have_mobile_app_yet})}),(0,p.jsx)(s.Button,{size:"small",onPress:function(){(0,f.Dr)(l.A8)},children:n.formatMessage({id:u.ETranslations.global_download})})]})]}),showFooter:!1})})),[t,n]));return(0,p.jsx)(s.Button,{size:"small",onPress:m,children:n.formatMessage({id:u.ETranslations.open_in_mobile_app})})}},660823:(e,t,n)=>{n.d(t,{i:()=>TabPageHeader});var r=n(514041),o=n(490343),i=n(901976),a=n(162616),s=n(208257),c=n(325809),l=n(586330),u=n(908867),d=n(334439),f=n(392097),k=n(595346),p=n(714191),y=n(317522),m=n(812979),w=n(831085);function HeaderLeft({sceneName:e}){var t,n=(0,u.A)(),{tourTimes:i,tourVisited:a}=(0,m.c1)(k.A.switchDappAccount),[s,h]=(0,r.useState)(!1);(0,y.A)(f.V4.Home,(t=(0,l.A)((function*(e,t){h(!t&&e)})),function(e,n){return t.apply(this,arguments)}));var A=(0,r.useMemo)((function(){return 1===i&&s}),[s,i]),b=(0,r.useMemo)((function(){return e===p.Zs.homeUrlAccount?(0,w.jsx)(o.Page.Close,{children:(0,w.jsx)(o.NavBackButton,{})}):(0,w.jsx)(c.Qt,{num:0,spotlightProps:{visible:A,content:(0,w.jsx)(o.SizableText,{size:"$bodyMd",children:n.formatMessage({id:d.ETranslations.spotlight_account_alignment_desc})}),onConfirm:function(){a(2)},childrenPaddingVertical:0}},"accountSelectorTrigger")}),[n,e,A,a]);return(0,w.jsx)(c.b8,{enabledNum:[0],config:{sceneName:e,sceneUrl:""},children:b})}var h=n(896666),A=n(384013),b=n(259227),v=n(948675),g=n(663522),T=n(251039),I=n(596020),j=n(610421),S=n(498356),x=n(793437),O=n(211129),L=n(491180),N=n(796151),C=n(826339);function OpenInAppButtonContainer(){var{activeAccount:{account:e,network:t}}=(0,a.LH)({num:0}),n=(0,r.useCallback)((function(){return e&&t?N.Ay.buildDeepLinkUrl({path:O.oO.url_account,query:{networkCode:t.code,address:e.address}}):""}),[e,t]),o=(0,r.useCallback)((0,l.A)((function*(){return e&&t?(0,C.Hw)({account:e,network:t}):"n"})),[e,t]);return e?.address&&t?.id?(0,w.jsx)(x.X,{buildDeepLinkUrl:n,buildFullUrl:o}):null}function ShareButton(){var{activeAccount:{account:e,network:t}}=(0,a.LH)({num:0}),{shareText:n}=(0,o.useShare)();return e?.address&&t?.id?(0,w.jsx)(o.HeaderIconButton,{onPress:(0,l.A)((function*(){var r=yield(0,C.Hw)({account:e,network:t});yield n(r)})),icon:"ShareOutline"}):null}var P={Address:function Address(){var{activeAccount:{account:e}}=(0,a.LH)({num:0});return(0,o.useMedia)(),(0,w.jsxs)(o.XStack,{alignItems:"center",children:[(0,w.jsx)(o.SizableText,{size:"$headingLg",children:L.A.shortenAddress({address:e?.address})}),null]})},OpenInApp:function OpenInApp(){return(0,w.jsx)(c.b8,{config:{sceneName:p.Zs.homeUrlAccount,sceneUrl:""},enabledNum:[0],children:(0,w.jsx)(OpenInAppButtonContainer,{})})},Share:function Share(){return(0,w.jsx)(c.b8,{config:{sceneName:p.Zs.homeUrlAccount,sceneUrl:""},enabledNum:[0],children:(0,w.jsx)(ShareButton,{})})}},_=n(834015),R=n(390574),M=n(506851);function UniversalSearchInput(){var e=(0,u.A)(),t=(0,S.A)(),n=(0,r.useCallback)((function(){t.pushModal(f.ry.UniversalSearchModal,{screen:R.j.UniversalSearch,params:{filterType:M.j.Address}})}),[t]);return(0,w.jsxs)(o.XStack,{w:280,children:[(0,w.jsx)(o.Input,{leftIconName:"SearchOutline",containerProps:{w:"100%"},size:"small",placeholder:e.formatMessage({id:d.ETranslations.global_search_address})},"searchInput"),(0,w.jsx)(o.View,{position:"absolute",top:0,left:0,right:0,bottom:0,onPress:n})]})}function HeaderRight({sceneName:e}){var t=(0,u.A)(),n=(0,S.A)(),i=(0,_.A)(),[{firstTimeGuideOpened:s,badge:c}]=(0,b.useNotificationsAtom)(),{activeAccount:{account:k}}=(0,a.LH)({num:0}),[y]=(0,A.RI)(),[m]=(0,A.D4)(),x=(0,r.useCallback)((function(){n.pushModal(f.ry.SettingModal,{screen:f.Pj.SettingListModal})}),[n]),O=(0,r.useCallback)((function(){return i.start({handlers:i.PARSE_HANDLER_NAMES.all,autoHandleResult:!0,account:k,tokens:{data:y.tokens,keys:y.keys,map:m}})}),[i,k,y,m]),L=(0,o.useMedia)(),N=(0,r.useCallback)((0,l.A)((function*(){n.pushModal(f.ry.NotificationsModal,{screen:T.f.NotificationList})})),[n]),C=(0,r.useMemo)((function(){var n,r,i,a=(0,w.jsx)(h.v$,{title:t.formatMessage({id:d.ETranslations.settings_settings}),icon:"SettingsOutline",testID:"setting",onPress:x},"setting"),u={routes:""},f=(0,w.jsx)(o.ActionList,{title:t.formatMessage({id:d.ETranslations.global_layout}),items:[g.Ay.isExtensionUiPopup?{label:t.formatMessage({id:d.ETranslations.open_as_sidebar}),icon:"LayoutRightOutline",onPress:(i=(0,l.A)((function*(){v.U.account.wallet.openSidePanel(),yield I.Ay.openPanelOnActionClick(!0),yield I.Ay.openSidePanel(u),window.close()})),function onPress(){return i.apply(this,arguments)})}:{label:t.formatMessage({id:d.ETranslations.open_as_popup}),icon:"LayoutTopOutline",onPress:(r=(0,l.A)((function*(){yield I.Ay.openPanelOnActionClick(!1),window.close()})),function onPress(){return r.apply(this,arguments)})},{label:t.formatMessage({id:d.ETranslations.global_expand_view}),icon:"ExpandOutline",onPress:(n=(0,l.A)((function*(){v.U.account.wallet.openExpandView(),window.close(),yield j.A.serviceApp.openExtensionExpandTab(u)})),function onPress(){return n.apply(this,arguments)})}],renderTrigger:(0,w.jsx)(h.v$,{title:t.formatMessage({id:d.ETranslations.global_layout}),icon:"LayoutRightOutline"},"layoutRightView")},"layoutExtView"),k=(0,w.jsx)(h.v$,{title:t.formatMessage({id:d.ETranslations.scan_scan_qr_code}),icon:"ScanOutline",onPress:O},"scan"),y=(0,w.jsxs)(o.Stack,{children:[(0,w.jsx)(h.v$,{title:t.formatMessage({id:d.ETranslations.global_notifications}),icon:"BellOutline",onPress:N}),!s||c?(0,w.jsx)(o.Stack,{position:"absolute",right:"$-2.5",top:"$-2",alignItems:"flex-end",w:"$10",pointerEvents:"none",children:(0,w.jsx)(o.Stack,{bg:"$bgApp",borderRadius:"$full",borderWidth:2,borderColor:"$transparent",children:(0,w.jsx)(o.Stack,{px:"$1",borderRadius:"$full",bg:"$bgCriticalStrong",minWidth:"$4",height:"$4",alignItems:"center",justifyContent:"center",children:s?(0,w.jsx)(o.SizableText,{color:"$textOnColor",size:"$bodySm",children:c&&c>99?"99+":c}):(0,w.jsx)(o.Stack,{width:"$1",height:"$1",backgroundColor:"white",borderRadius:"$full"})})})}):null]},"notifications"),m=L.gtMd?(0,w.jsx)(UniversalSearchInput,{},"searchInput"):null;return e===p.Zs.homeUrlAccount?[(0,w.jsx)(P.OpenInApp,{},"urlAccountOpenInApp"),(0,w.jsx)(P.Share,{},"urlAccountShare")].filter(Boolean):g.Ay.isExtensionUiPopup||g.Ay.isExtensionUiSidePanel?[f,y,a].filter(Boolean):[k,y=null,a,m].filter(Boolean)}),[t,x,O,N,c,s,L.gtMd,e]);return(0,w.jsx)(h.bE,{testID:"Wallet-Page-Header-Right",className:"app-region-no-drag",children:C})}function HeaderTitle({sceneName:e}){var t=(0,r.useMemo)((function(){if(e===p.Zs.homeUrlAccount)return(0,w.jsx)(P.Address,{},"urlAccountNavHeaderAddress")}),[e]);return(0,w.jsx)(c.b8,{enabledNum:[0],config:{sceneName:e,sceneUrl:""},children:t})}function TabPageHeader({sceneName:e,showHeaderRight:t}){(0,i.e)({name:`web TabPageHeader:${e}:${String(t)}`});var n=(0,r.useCallback)((function(){return(0,w.jsx)(HeaderLeft,{sceneName:e})}),[e]),{config:l}=(0,a.H9)(),u=(0,r.useCallback)((function(){return t&&l?(0,w.jsx)(s.p,{children:(0,w.jsx)(c.b8,{enabledNum:[0],config:l,children:(0,w.jsx)(HeaderRight,{sceneName:e})})}):null}),[l,e,t]),d=(0,r.useCallback)((function(){return(0,w.jsx)(HeaderTitle,{sceneName:e})}),[e]);return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(o.Page.Header,{headerTitle:d,headerLeft:n,headerRight:u})})}},989840:(e,t,n)=>{n.d(t,{wu:()=>k,Lu:()=>useAccountOverviewActions,Al:()=>b,mw:()=>h,we:()=>p});var r=n(324586),o=n(230414),i=n(929296),a=n(195309),s=n(972715),c=n(514041),l=n(241440),u=n(657355),d=n(714178),f=n(809690),{Provider:k,withProvider:p,contextAtom:y,contextAtomMethod:m}=(0,f.f)(),{atom:w,use:h}=y({worth:{},createAtNetworkWorth:"0",accountId:"",initialized:!1,updateAll:!1}),{atom:A,use:b}=y({isRefreshing:!1,initialized:!1});function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var n,r=(0,s.A)(e);if(t){var o=(0,s.A)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,a.A)(this,n)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var v=function(e){(0,i.A)(ContextJotaiActionsAccountOverview,e);var t=_createSuper(ContextJotaiActionsAccountOverview);function ContextJotaiActionsAccountOverview(...e){var n;return(n=t.call(this,...e)).updateAccountOverviewState=m((function(e,t,n){t(A(),_objectSpread(_objectSpread({},e(A())),n))})),n.updateAccountWorth=m((function(e,t,n){var r;if(n.merge){var o,{worth:i,createAtNetworkWorth:a}=e(w());t(w(),{worth:_objectSpread(_objectSpread({},i),n.worth),createAtNetworkWorth:new l.A(null!=a?a:"0").plus(null!=(o=n.createAtNetworkWorth)?o:"0").toFixed(),initialized:n.initialized,accountId:n.accountId,updateAll:n.updateAll})}else t(w(),{worth:n.worth,createAtNetworkWorth:null!=(r=n.createAtNetworkWorth)?r:"0",initialized:n.initialized,accountId:n.accountId,updateAll:n.updateAll})})),n}return(0,o.A)(ContextJotaiActionsAccountOverview)}(d.x),g=(0,u.jq)((function(){return new v}));function useAccountOverviewActions(){var e=g(),t=e.updateAccountWorth.use(),n=e.updateAccountOverviewState.use();return(0,c.useRef)({updateAccountWorth:t,updateAccountOverviewState:n})}},349521:(e,t,n)=>{n.d(t,{F:()=>FirmwareUpdateReminderAlert,a:()=>HomeFirmwareUpdateReminder});var r=n(586330),o=n(514041),i=n(908867),a=n(490343),s=n(259227),c=n(334439),l=n(714191),u=n(610421),d=n(325809),f=n(498356),k=n(911998),p=n(162616),y=n(773831),m=n(318822);function BootloaderModeUpdateReminder(){var e=(0,f.A)(),t=(0,y.B)();return(0,o.useEffect)((function(){var fn=function(e){t.showBootloaderMode({connectId:e.connectId,existsFirmware:e.existsFirmware})};return m.iL.on(m.Tu.ShowFirmwareUpdateFromBootloaderMode,fn),function(){m.iL.off(m.Tu.ShowFirmwareUpdateFromBootloaderMode,fn)}}),[t,e]),null}var w=n(153763),h=n(491180),A=n(831085);function HomeFirmwareUpdateDetectCmp(){var{activeAccount:e}=(0,p.LH)({num:0}),t=e.device?.connectId,n=(0,w.E)(),r=(0,o.useMemo)((function(){return h.A.isHwWallet({walletId:e.wallet?.id})}),[e.wallet?.id]);return(0,o.useEffect)((function(){r&&t&&n&&u.A.serviceFirmwareUpdate.detectActiveAccountFirmwareUpdates({connectId:t})}),[r,t,n]),null}var b=(0,o.memo)((function HomeFirmwareUpdateDetectWithProvider(){var[e]=(0,s.useAppIsLockedAtom)();return e?null:(0,A.jsx)(d.b8,{config:{sceneName:l.Zs.home},enabledNum:[0],children:(0,A.jsx)(HomeFirmwareUpdateDetectCmp,{})})}));function FirmwareUpdateReminderAlert({message:e,onPress:t}){var n=(0,i.A)();return(0,A.jsxs)(a.XStack,{px:"$5",py:"$2",borderTopWidth:"$px",borderBottomWidth:"$px",bg:"$bgInfoSubdued",borderColor:"$borderInfoSubdued",alignItems:"center",gap:"$2",flex:1,children:[(0,A.jsx)(a.Icon,{size:"$4",name:"DownloadOutline",color:"$iconInfo"}),(0,A.jsx)(a.SizableText,{flex:1,size:"$bodyMdMedium",color:"$text",numberOfLines:1,children:e}),(0,A.jsx)(a.Button,{size:"small",onPress:t,children:n.formatMessage({id:c.ETranslations.global_view})})]})}function HomeFirmwareUpdateReminderCmp(){var e=(0,i.A)(),{activeAccount:t}=(0,p.LH)({num:0}),n=t.device?.connectId,l=(0,y.B)(),[d]=(0,s.useFirmwareUpdatesDetectStatusAtom)(),{result:m}=((0,f.A)(),(0,k.yk)((0,r.A)((function*(){if(n){var e=d?.[n],t=e?.connectId===n&&e?.hasUpgrade;yield u.A.serviceFirmwareUpdate.getFirmwareUpdateDetectInfo({connectId:n});return{shouldUpdate:t,detectResult:e}}})),[n,d])),w=(0,o.useMemo)((function(){if(m?.shouldUpdate){var t="New firmware is available";return m?.detectResult?.toVersion?t=e.formatMessage({id:c.ETranslations.update_firmware_version_available},{version:m?.detectResult?.toVersion}):m?.detectResult?.toVersionBle&&(t=e.formatMessage({id:c.ETranslations.update_bluetooth_version_available},{version:m?.detectResult?.toVersionBle})),(0,A.jsx)(FirmwareUpdateReminderAlert,{message:t,onPress:(0,r.A)((function*(){l.openChangeLogModal({connectId:n})}))})}return null}),[e,l,n,m]);return(0,A.jsxs)(a.XStack,{children:[(0,A.jsx)(b,{}),(0,A.jsx)(BootloaderModeUpdateReminder,{}),w]})}function HomeFirmwareUpdateReminder(){return(0,A.jsx)(d.b8,{config:{sceneName:l.Zs.home},enabledNum:[0],children:(0,A.jsx)(HomeFirmwareUpdateReminderCmp,{})})}},918120:(e,t,n)=>{n.d(t,{m:()=>HomeTokenListProviderMirrorWrapper});var r=n(324586),o=n(839850),i=n(491180),a=n(208257),s=n(514041),c=n(641106),l=n(727476),u=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=(0,s.memo)((function(e){var t=(0,l.y)();return(0,u.jsx)(c.m,_objectSpread(_objectSpread({},e),{},{data:t}))}));d.displayName="UrlAccountHomeTokenListProviderMirror";var f=["accountId"];function HomeTokenListProvider_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HomeTokenListProvider_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HomeTokenListProvider_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HomeTokenListProvider_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function HomeTokenListProviderMirrorWrapper(e){var{accountId:t}=e,n=(0,o.A)(e,f);return i.A.isUrlAccountFn({accountId:t})?(0,u.jsx)(d,HomeTokenListProvider_objectSpread({},n)):(0,u.jsx)(a.p,HomeTokenListProvider_objectSpread({},n))}},323104:(e,t,n)=>{n.d(t,{A:()=>useHomePageWidth});var r=n(514041),o=n(812715),i=n(490343),a=n(40651),s=n(989375);function useHomePageWidth(){var e=(0,i.useMedia)(),t=(0,o.A)().width,n=(0,r.useMemo)((function(){return(0,s.RQ)().size.sideBarWidth.val}),[]),{leftSidebarCollapsed:c}=(0,a.A)();return{screenWidth:t,pageWidth:e.md||c?t:t-n}}},155680:(e,t,n)=>{n.d(t,{U:()=>HomePageView});var r=n(586330),o=n(514041),i=n(908867),a=n(546591),s=n(462723),c=n(490343),l=n(928557),u=n(318822),d=n(334439),f=(n(663522),n(491180)),k=n(714191),p=n(610421),y=n(357829),m=n(660823),w=n(713132),h=(n(117746),n(536612),n(831085));w.ue.notify,w.ue.downloading,w.ue.verifying,w.ue.ready,w.ue.failed,w.ue.done;var UpdateReminder=function(){return null},A=n(911998),b=n(162616),v=n(349521),g=n(324586),T=n(839850),I=n(325809),j=n(575995),S=n(84269),x=["createAddressDisabled"];function HomeSelector_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HomeSelector_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HomeSelector_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HomeSelector_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const O=(0,o.memo)((function HomeSelector(e){(0,c.useMedia)();var{createAddressDisabled:t}=e,n=(0,T.A)(e,x);return(0,h.jsxs)(c.XStack,HomeSelector_objectSpread(HomeSelector_objectSpread({testID:"Wallet-Address-Generator",alignItems:"center",gap:"$3"},n),{},{children:[(0,h.jsx)(S.vO,{num:0}),t?null:(0,h.jsx)(I.Ln,{num:0}),t?null:(0,h.jsx)(j.Xs,{num:0})]}))}));function HomeSupportedWallet({supportedDeviceTypes:e,watchingAccountEnabled:t}){var n=(0,i.A)(),r=[];e&&r.push(...e),t&&r.push("watching");var o={classic:"Classic",classic1s:"Classic 1S",mini:"Mini",touch:"Touch",pro:"Pro",unknown:"",watching:n.formatMessage({id:d.ETranslations.faq_watched_account})},a=(r||[]).map((function(e){return o[e]})).filter((function(e){return e}));return(0,h.jsxs)(c.YStack,{height:"100%",children:[(0,h.jsx)(O,{createAddressDisabled:!0,padding:"$5"}),(0,h.jsx)(c.Stack,{flex:1,justifyContent:"center",children:(0,h.jsx)(c.Empty,{icon:"GlobusOutline",title:n.formatMessage({id:d.ETranslations.selected_network_only_supports_device},{deviceType:a.join(", ")})})})]})}var L=n(323104),N=n(208257),C=n(186207),P=n(292600),_=n(498356),R=n(384013),M=n(392097),$=n(359395),E=n(398509),H=n(69531),D=n(181447);function WalletActionBuy(){var e,t,{activeAccount:{network:n,account:r,wallet:i}}=(0,b.LH)({num:0}),{isSupported:a,handleFiatCrypto:s}=(0,H.TH)({networkId:null!=(e=n?.id)?e:"",accountId:null!=(t=r?.id)?t:"",fiatCryptoType:"buy"}),c=(0,o.useMemo)((function(){return i?.type===D.Hk||!a}),[a,i?.type]);return(0,h.jsx)(E.c.Buy,{onPress:s,disabled:c})}var F=n(404727),B=n(962771),V=n(639563),W=n(15409),U=n(259227);function WalletActionMore(){var e,t,n,a,s,l,[u]=(0,U.useDevSettingsPersistAtom)(),{activeAccount:f}=(0,b.LH)({num:0}),{account:k,network:y,wallet:m,deriveInfo:w,deriveType:v}=f,g=(0,i.A)(),{copyText:T}=(0,c.useClipboard)(),{handleOnReceive:I}=(0,B.m)({accountId:null!=(e=k?.id)?e:"",networkId:null!=(t=y?.id)?t:"",walletId:null!=(n=m?.id)?n:"",deriveInfo:w,deriveType:v}),{isEnable:j,handleWalletAddress:S}=(0,W.p)({activeAccount:f}),{isSupported:x,handleFiatCrypto:O}=(0,H.TH)({accountId:null!=(a=k?.id)?a:"",networkId:null!=(s=y?.id)?s:"",fiatCryptoType:"sell"}),L=(0,o.useMemo)((function(){return m?.type===D.Hk||!x}),[x,m?.type]),N=(0,o.useCallback)((function(){j?S():m?.type===D.FN?I():T(k?.address||"")}),[k?.address,T,I,m?.type,j,S]),C=(0,P.T)(),_=(0,A.yk)((0,r.A)((function*(){var e;return yield p.A.serviceNetwork.getVaultSettings({networkId:null!=(e=y?.id)?e:""})})),[y?.id]).result,R=[];if(_?.copyAddressDisabled&&_?.hideBlockExplorer||R.unshift({items:[..._?.hideBlockExplorer?[]:[{label:g.formatMessage({id:d.ETranslations.global_view_in_blockchain_explorer}),icon:"GlobusOutline",onPress:function(){return(0,V.HM)({networkId:y?.id,address:k?.address})}}],..._?.copyAddressDisabled?[]:[{label:g.formatMessage({id:d.ETranslations.global_copy_address}),icon:"Copy3Outline",onPress:N}]]}),C&&R.unshift({items:[{label:g.formatMessage({id:d.ETranslations.global_cash_out}),icon:"MinusLargeOutline",disabled:Boolean(L||!k?.id||!y?.id),onPress:O}]}),u?.settings?.showDevExportPrivateKey){var M=(l=(0,r.A)((function*({keyType:e}){var t="";t=e===F.ECoreApiExportedSecretKeyType.xpub||e===F.ECoreApiExportedSecretKeyType.publicKey?yield p.A.serviceAccount.exportAccountPublicKey({accountId:k?.id||"",networkId:y?.id||"",keyType:e}):yield p.A.serviceAccount.exportAccountSecretKey({accountId:k?.id||"",networkId:y?.id||"",keyType:e}),c.Dialog.show({title:"Key",description:t,onConfirmText:"Copy",onConfirm(){T(t||"")}})})),function exportAccountCredentialKey(e){return l.apply(this,arguments)});R.unshift({items:[{label:"Export Public Key",icon:"MinusLargeOutline",onPress:function(){M({keyType:F.ECoreApiExportedSecretKeyType.publicKey})}},{label:"Export xpub",icon:"MinusLargeOutline",onPress:function(){M({keyType:F.ECoreApiExportedSecretKeyType.xpub})}},{label:"Export Private Key",icon:"MinusLargeOutline",onPress:function(){M({keyType:F.ECoreApiExportedSecretKeyType.privateKey})}},{label:"Export xprvt",icon:"MinusLargeOutline",onPress:function(){M({keyType:F.ECoreApiExportedSecretKeyType.xprvt})}}]})}return(0,h.jsx)(E.c.More,{sections:R})}function WalletActionReceive(){var e,t,n,{activeAccount:{network:r,account:i,wallet:a,deriveInfo:s,deriveType:c}}=(0,b.LH)({num:0}),[l]=(0,R.RI)(),[u]=(0,R.D4)(),[d]=(0,R.V3)(),f=(0,o.useMemo)((function(){return a?.type===D.Hk}),[a?.type]),{handleOnReceive:k}=(0,B.m)({accountId:null!=(e=i?.id)?e:"",networkId:null!=(t=r?.id)?t:"",walletId:null!=(n=a?.id)?n:"",deriveInfo:s,deriveType:c,tokens:{data:l.tokens,keys:l.keys,map:u},tokenListState:d});return(0,h.jsx)(E.c.Receive,{disabled:f,onPress:function(){return k()}})}function WalletActions_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function WalletActions_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WalletActions_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WalletActions_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function WalletActionSend(){var e=(0,_.A)(),{activeAccount:{account:t,network:n,wallet:a}}=(0,b.LH)({num:0}),s=(0,i.A)(),[c]=(0,R.RI)(),[l]=(0,R.D4)(),[u]=(0,R.V3)(),k=(0,A.yk)((0,r.A)((function*(){var e;return yield p.A.serviceNetwork.getVaultSettings({networkId:null!=(e=n?.id)?e:""})})),[n?.id]).result,y=(0,o.useCallback)((0,r.A)((function*(){if(t&&n)if(k?.isSingleToken){var o=yield p.A.serviceToken.getNativeToken({networkId:n.id,accountId:t.id});e.pushModal(M.ry.SendModal,{screen:M.j$.SendDataInput,params:{accountId:t.id,networkId:n.id,isNFT:!1,token:o}})}else{var i;e.pushModal(M.ry.SendModal,{screen:M.j$.SendSelectToken,params:{title:s.formatMessage({id:d.ETranslations.global_send}),searchPlaceholder:s.formatMessage({id:d.ETranslations.global_search_asset}),networkId:n.id,accountId:t.id,tokens:{data:c.tokens,keys:c.keys,map:l},tokenListState:u,closeAfterSelect:!1,onSelect:(i=(0,r.A)((function*(r){var o,i,s,c;if((yield p.A.serviceNetwork.getVaultSettings({networkId:null!=(o=r.networkId)?o:""})).mergeDeriveAssetsEnabled&&n.isAllNetworks&&!f.A.isOthersWallet({walletId:null!=(i=a?.id)?i:""})){var u,d,k,y,m=f.A.getWalletIdFromAccountId({accountId:null!=(u=r.accountId)?u:""});e.push(M.j$.SendSelectDeriveAddress,{networkId:null!=(d=r.networkId)?d:"",indexedAccountId:null!=(k=t.indexedAccountId)?k:"",walletId:m,accountId:null!=(y=r.accountId)?y:"",actionType:$.rI.Select,token:r,tokenMap:l,onUnmounted:function(){},onSelected:function({account:t}){var o;e.push(M.j$.SendDataInput,{accountId:t.id,networkId:null!=(o=r.networkId)?o:n.id,isNFT:!1,token:r,isAllNetworks:n?.isAllNetworks})}})}else e.push(M.j$.SendDataInput,{accountId:null!=(s=r.accountId)?s:t.id,networkId:null!=(c=r.networkId)?c:n.id,isNFT:!1,token:r,isAllNetworks:n?.isAllNetworks})})),function onSelect(e){return i.apply(this,arguments)})}})}})),[t,n,k?.isSingleToken,e,s,c.tokens,c.keys,l,u,a?.id]);return(0,h.jsx)(E.c.Send,{onPress:y,disabled:k?.disabledSendAction})}function WalletActionSwap({networkId:e,accountId:t}){var n=(0,i.A)(),a=(0,_.A)(),s=(0,A.yk)((0,r.A)((function*(){return yield p.A.serviceNetwork.getVaultSettings({networkId:null!=e?e:""})})),[e]).result,c=(0,o.useCallback)((function(){a.pushModal(M.ry.SwapModal,{screen:M.uw.SwapMainLand,params:{importNetworkId:e}})}),[a,e]);return(0,h.jsx)(E.c.Swap,{onPress:c,label:n.formatMessage({id:d.ETranslations.global_trade}),disabled:s?.disabledSwapAction||f.A.isUrlAccountFn({accountId:t})})}function WalletActions(e){var t=Object.assign({},((0,C.A)(e),e)),{activeAccount:{network:n,account:r}}=(0,b.LH)({num:0});return(0,h.jsxs)(E.c,WalletActions_objectSpread(WalletActions_objectSpread({},t),{},{children:[(0,h.jsx)(P.O,{children:(0,h.jsx)(WalletActionBuy,{})}),(0,h.jsx)(WalletActionSwap,{networkId:n?.id,accountId:r?.id}),(0,h.jsx)(WalletActionSend,{}),(0,h.jsx)(WalletActionReceive,{}),(0,h.jsx)(WalletActionMore,{})]}))}var z=n(241440),K=n(948675),q=n(403144),X=n(827037),G=n(686233),Z=n(989840),J=n(432178);function HomeOverviewContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HomeOverviewContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HomeOverviewContainer_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HomeOverviewContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function HomeOverviewContainer(){var e,{activeAccount:{account:t,network:n,wallet:a}}=(0,b.LH)({num:0}),s=(0,i.A)(),[l,y]=(0,o.useState)(!1),[m,w]=(0,o.useState)(!1),[v,g]=(0,o.useState)(!1),[T,I]=(0,o.useState)(!1),j=(0,o.useRef)(""),[S]=(0,Z.mw)(),[x]=(0,Z.Al)(),{updateAccountOverviewState:O,updateAccountWorth:L}=(0,Z.Lu)().current,[N]=(0,U.useSettingsPersistAtom)(),{result:C}=(0,A.yk)((0,r.A)((function*(){if(n)return p.A.serviceNetwork.getVaultSettings({networkId:n.id})})),[n]);(0,o.useEffect)((function(){t?.id&&n?.id&&a?.id&&n.isAllNetworks&&L({accountId:t.id,worth:{},initialized:!1})}),[t?.id,n?.id,n?.isAllNetworks,O,L,a?.id]),(0,o.useEffect)((function(){var fn=function({isRefreshing:e,type:t,accountId:n,networkId:r}){var o=`${n}-${r}`;!e&&j.current&&j.current!==o||(j.current=o,t===k.GV.TOKENS?w(e):t===k.GV.NFT?g(e):t===k.GV.HISTORY&&I(e),y(e))};return u.iL.on(u.Tu.TabListStateUpdate,fn),function(){u.iL.off(u.Tu.TabListStateUpdate,fn)}}),[]),(0,o.useEffect)((function(){if(t&&n&&S.initialized&&t.id===S.accountId)if(f.A.isOthersAccount({accountId:t.id})){if(!n.isAllNetworks&&t.createAtNetwork!==n.id)return;var e=t.id;p.A.serviceAccountProfile.updateAccountValue({accountId:e,value:S.createAtNetworkWorth,currency:N.currencyInfo.id,shouldUpdateActiveAccountValue:!0})}else{var r=t.indexedAccountId;n.isAllNetworks||p.A.serviceAccountProfile.updateAccountValueForSingleNetwork({accountId:r,value:S.worth[f.A.buildAccountValueKey({accountId:t.id,networkId:n.id})],currency:N.currencyInfo.id}),p.A.serviceAccountProfile.updateAllNetworkAccountValue({accountId:r,value:S.worth,currency:N.currencyInfo.id,updateAll:S.updateAll})}}),[t,S.accountId,S.createAtNetworkWorth,S.initialized,S.updateAll,S.worth,n,N.currencyInfo.id,a]);var{md:P}=(0,c.useMedia)(),_=(0,o.useRef)(null),R=(0,o.useRef)(null),M=(0,o.useCallback)((function(){l||(y(!0),u.iL.emit(u.Tu.AccountDataUpdate,void 0),K.U.account.wallet.walletManualRefresh())}),[l]),$=l||m||v||T,E=(0,o.useMemo)((function(){return(0,h.jsx)(c.IconButton,{icon:"RefreshCcwOutline",variant:"tertiary",loading:$,onPress:M})}),[M,$]),H=(0,o.useCallback)((0,r.A)((function*(){var e=yield U.settingsValuePersistAtom.get();yield U.settingsValuePersistAtom.set({hideValue:!e.hideValue})})),[]),D=(0,o.useCallback)((function(){var e,r;_?.current||(_.current=(0,J.k)({accountId:null!=(e=t?.id)?e:"",networkId:null!=(r=n?.id)?r:"",onClose:function(){_.current=null}}))}),[t,n]),F=(0,o.useCallback)((function(){var e,r;R?.current||(R.current=(0,G.u)({accountId:null!=(e=t?.id)?e:"",networkId:null!=(r=n?.id)?r:"",onClose:function(){R.current=null}}))}),[t?.id,n?.id]),B=(0,o.useMemo)((function(){var e,r,o,i;return n?.isAllNetworks?Object.values(S.worth).reduce((function(e,t){return new z.A(e).plus(t).toFixed()}),"0"):null!=(e=null!=(r=S.worth[f.A.buildAccountValueKey({accountId:null!=(o=t?.id)?o:"",networkId:null!=(i=n?.id)?i:""})])?r:Object.values(S.worth)[0])?e:"0"}),[S.worth,t?.id,n?.id,n?.isAllNetworks]);if(x.isRefreshing&&!x.initialized)return(0,h.jsx)(c.Stack,{py:"$2.5",children:(0,h.jsx)(c.Skeleton,{w:"$40",h:"$7",my:"$2.5"})});var V="$heading5xl",W={formatter:"value",formatterOptions:{currency:N.currencyInfo.symbol}};return(0,h.jsxs)(c.YStack,{gap:"$2.5",alignItems:"flex-start",children:[(0,h.jsxs)(c.XStack,{alignItems:"center",gap:"$3",children:[(0,h.jsx)(c.XStack,{flexShrink:1,borderRadius:"$3",px:"$1",py:"$0.5",mx:"$-1",my:"$-0.5",cursor:"default",focusable:!0,hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusVisibleStyle:{outlineColor:"$focusRing",outlineWidth:2,outlineOffset:0,outlineStyle:"solid"},onPress:H,children:(0,h.jsx)(X.A,HomeOverviewContainer_objectSpread(HomeOverviewContainer_objectSpread({hideValue:!0,flexShrink:1,minWidth:0},W),{},{size:P&&null!=(e=[{length:17,size:"$headingXl"},{length:13,size:"$heading4xl"}].find((function(e){return(0,q.jq)(String(B),W,!0).length>=e.length}))?.size)?e:V,children:B}))}),E]}),C?.hasFrozenBalance?(0,h.jsx)(c.Button,{onPress:D,variant:"tertiary",size:"small",iconAfter:"InfoCircleOutline",children:s.formatMessage({id:d.ETranslations.balance_detail_button_balance})}):void 0,C?.hasResource?(0,h.jsx)(c.Button,{onPress:F,variant:"tertiary",size:"small",iconAfter:"InfoCircleOutline",px:"$1",py:"$0.5",mx:"$-1",children:s.formatMessage({id:C.resourceKey})}):void 0]})}function HomeHeaderContainer(){return(0,h.jsx)(N.p,{children:(0,h.jsxs)(c.Stack,{testID:"Wallet-Tab-Header",p:"$5",bg:"$bgApp",children:[(0,h.jsx)(O,{mb:"$2.5"}),(0,h.jsxs)(c.Stack,{$gtLg:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsx)(HomeOverviewContainer,{}),(0,h.jsx)(WalletActions,{pt:"$5",$gtLg:{pt:0}})]})]})})}var Y=n(603514),Q=n.n(Y),ee=n(787835),te=n.n(ee),ne=n(625931),re=n(227428),oe=n(482407),ie={current:""};function useAllNetworkRequests(e){var{account:t,network:n,wallet:i,allNetworkRequests:a,allNetworkCacheRequests:s,allNetworkCacheData:c,abortAllNetworkRequests:l,clearAllNetworkData:u,isNFTRequests:d,disabled:f,interval:k=0,shouldAlwaysFetch:y,onStarted:m,onFinished:w}=e,h=(0,o.useRef)(!1),b=(0,o.useRef)(!1),[v,g]=(0,o.useState)(!1),{run:T,result:I}=(0,A.yk)((0,r.A)((function*(){var e=(0,oe.lk)();if(!f&&!b.current&&t&&n&&i&&n.isAllNetworks){b.current=!0,h.current||u(),l?.();var{accountsInfo:r,accountsInfoBackendIndexed:o,accountsInfoBackendNotIndexed:k}=yield p.A.serviceAllNetwork.getAllNetworkAccounts({accountId:t.id,networkId:n.id,deriveType:void 0,nftEnabledOnly:d});if(!r||Q()(r))return g(!0),void(b.current=!1);var y=null;if(0===r.length)return g(!0),void(b.current=!1);if(g(!1),m?.({accountId:t.id,networkId:n.id}),!h.current)try{var A=(yield Promise.all(Array.from(r).map((function(e){var{accountId:t,networkId:n,accountXpub:r,apiAddress:o}=e;return s?.({accountId:t,networkId:n,xpub:r,accountAddress:o})})))).filter(Boolean);A&&!Q()(A)&&(h.current=!0,c?.({data:A,accountId:t.id,networkId:n.id}))}catch(e){}if(ie.current=e,h.current){var v=r.map((function(e){var{accountId:t,networkId:n}=e;return a({accountId:t,networkId:n,allNetworkDataInit:h.current})}));try{y=(yield Promise.all(v)).filter(Boolean)}catch(e){y=null,l?.()}}else{try{yield Promise.all(Array.from(o).map((function(e){var{accountId:t,networkId:n,apiAddress:r}=e;return a({accountId:t,networkId:n,allNetworkDataInit:h.current})})))}catch(e){}try{yield Promise.all(Array.from(k).map((function(e){var{accountId:t,networkId:n,apiAddress:r}=e;return a({accountId:t,networkId:n,allNetworkDataInit:h.current})})))}catch(e){}}return h.current=!0,b.current=!1,w?.({accountId:t.id,networkId:n.id}),y}})),[f,t,n,i,l,d,m,w,u,s,c,a],{debounced:re.EI,overrideIsFocused:function(e){return e||!!y}});return(0,o.useEffect)((function(){t?.id&&n?.id&&i?.id&&(h.current=!1)}),[t?.id,n?.id,i?.id]),{run:T,result:I,isEmptyAccount:v,allNetworkDataInit:h}}var ae=n(230414),se=n(929296),ce=n(195309),le=n(972715),ue=n(657355),de=n(714178),fe=n(809690),{Provider:ke,withProvider:pe,contextAtom:ye,contextAtomMethod:me}=(0,fe.f)(),{atom:we,use:he}=ye("");function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var n,r=(0,le.A)(e);if(t){var o=(0,le.A)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,ce.A)(this,n)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var Ae=function(e){(0,se.A)(ContextJotaiActionsNFTList,e);var t=_createSuper(ContextJotaiActionsNFTList);function ContextJotaiActionsNFTList(...e){var n;return(n=t.call(this,...e)).updateSearchKey=me((function(e,t,n){t(we(),n)})),n}return(0,ae.A)(ContextJotaiActionsNFTList)}(de.x),be=(0,ue.jq)((function(){return new Ae}));function useNFTListActions(){var e=be().updateSearchKey.use();return(0,o.useRef)({updateSearchKey:e})}var ve=n(535864),ge=n(69983),Te=n(669617),Ie=n(712784),je=n.n(Ie),Se=n(327550);function NFTListHeader(e){var{filteredNfts:t}=e,n=(0,i.A)(),[r]=he(),{updateSearchKey:o}=useNFTListActions().current;return(0,h.jsx)(Se.W,{px:"$2.5",searchProps:{placeholder:n.formatMessage({id:d.ETranslations.global_search_asset}),onChangeText:je()((function(e){return o(e)}),re.FV),searchResultCount:r&&r.length>=re.NZ?t.length:0}})}var xe=n(391944),Oe=n(298254),Le=n(982447);var Ne=(0,o.memo)((function BasicNFTListItem(e){var t,{nft:n,onPress:r,flexBasis:i,isAllNetworks:a}=e,[s,l]=(0,o.useState)(!!n.metadata?.image),{network:u}=(0,Oe.b)({networkId:n.networkId});return(0,h.jsxs)(c.Stack,{group:"nftItem",flexBasis:i,focusable:!0,focusVisibleStyle:{outlineColor:"$focusRing",outlineWidth:2,outlineStyle:"solid",outlineOffset:-2},p:"$2.5",borderRadius:"$4",onPress:function(){r?.(n)},userSelect:"none",children:[(0,h.jsx)(c.Stack,{pb:"100%","$group-nftItem-hover":{opacity:.8},children:(0,h.jsxs)(c.Stack,{position:"absolute",left:0,top:0,right:0,bottom:0,children:[(0,h.jsxs)(c.Image,{w:"100%",h:"100%",borderRadius:"$2.5",children:[s?(0,h.jsx)(c.Video,{source:{uri:n.metadata?.image},onError:function(){return l(!1)},style:{width:"100%",height:"100%",position:"absolute",zIndex:1},autoPlay:!1}):(0,h.jsx)(c.Image.Source,{src:n.metadata?.image}),(0,h.jsx)(c.Image.Fallback,{bg:"$bgStrong",justifyContent:"center",alignItems:"center",children:(0,h.jsx)(c.Icon,{name:"ImageSquareWavesOutline",color:"$iconDisabled"})})]}),n.collectionType===Le.m.ERC1155&&new z.A(null!=(t=n.amount)?t:1).gt(1)?(0,h.jsx)(c.Stack,{borderRadius:"$2.5",position:"absolute",right:"$0",bottom:"$0",px:"$2",bg:"$bgInverse",borderWidth:2,borderColor:"$bgApp",children:(0,h.jsxs)(c.SizableText,{size:"$bodyMdMedium",color:"$textInverse",children:["x",new z.A(n.amount).gt(re.JA)?`${re.JA}+`:n.amount]})}):null]})}),(0,h.jsxs)(c.Stack,{mt:"$2",children:[(0,h.jsxs)(c.XStack,{alignItems:"center",justifyContent:"space-between",children:[(0,h.jsx)(c.SizableText,{size:"$bodySm",color:"$textSubdued",minWidth:0,flex:1,numberOfLines:1,pr:"$2",children:n.collectionName||"-"}),a?(0,h.jsx)(xe.o,{width:"$3.5",height:"$3.5",tokenImageUri:u?.logoURI}):null]}),(0,h.jsx)(c.SizableText,{size:"$bodyLgMedium",numberOfLines:1,children:n.metadata?.name||"-"})]})]},n.itemId)}));function NFTListView_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function NFTListView_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NFTListView_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NFTListView_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var useMumColumns=function(){var{gtSm:e,gtLg:t,gtXl:n,gt2xl:r}=(0,c.useMedia)();return(0,o.useMemo)((function(){return r?{flexBasis:"14.2857142857%",numColumns:7}:n?{flexBasis:"16.666666%",numColumns:6}:t?{flexBasis:"25%",numColumns:4}:e?{flexBasis:"33.333333%",numColumns:3}:{flexBasis:"50%",numColumns:2}}),[r,t,e,n])};function NFTListView(e){var{data:t,isLoading:n,initialized:r,inTabList:i=!1,isAllNetworks:a}=e,[s]=he(),l=(0,Te.D_)({nfts:t,searchKey:s}),u=(0,_.A)(),{activeAccount:{account:d,network:f,wallet:k}}=(0,b.LH)({num:0}),p=(0,o.useCallback)((function(e){var t,n;d&&f&&k&&u.pushModal(M.ry.MainModal,{screen:M.kZ.NFTDetails,params:{networkId:null!=(t=e.networkId)?t:f.id,accountId:null!=(n=e.accountId)?n:d.id,walletId:k.id,collectionAddress:e.collectionAddress,itemId:e.itemId}})}),[d,u,f,k]),{flexBasis:m,numColumns:w}=useMumColumns(),A=(0,o.useCallback)((function({item:e}){return(0,h.jsx)(Ne,{nft:e,flexBasis:m,onPress:p,isAllNetworks:a},`${e.collectionAddress}-${e.itemId}`)}),[m,p,a]),{listViewProps:v,listViewRef:g,onLayout:T}=(0,ge.q)({inTabList:i}),I=(0,o.useMemo)((function(){return{pb:"$6",px:"$2.5"}}),[]);return!r&&n?(0,h.jsx)(ve.yu,{}):(0,o.createElement)(c.ListView,NFTListView_objectSpread(NFTListView_objectSpread({},v),{},{ref:g,renderScrollComponent:c.renderNestedScrollView,key:w,onLayout:T,contentContainerStyle:I,numColumns:w,data:l,renderItem:A,ListHeaderComponent:(0,h.jsx)(NFTListHeader,{filteredNfts:l}),ListEmptyComponent:s?(0,h.jsx)(y.wE,{}):(0,h.jsx)(y.eZ,{})}))}var Ce=(0,ne.V)();var Pe=(0,o.memo)(pe((function NFTListContainer(e){var t,n,{isFocused:i,isHeaderRefreshing:a,setIsHeaderRefreshing:s}=(0,c.useTabIsRefreshingFocused)(),{updateSearchKey:l}=useNFTListActions().current,[d,f]=(0,o.useState)({initialized:!1,isRefreshing:!1}),[y,m]=(0,o.useState)([]),{activeAccount:{account:w,network:v,wallet:g}}=(0,b.LH)({num:0}),{run:T}=(0,A.yk)((0,r.A)((function*(){if(w&&v&&!v.isAllNetworks){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:k.GV.NFT,accountId:w.id,networkId:v.id}),yield p.A.serviceNFT.abortFetchAccountNFTs();var e=yield p.A.serviceNFT.fetchAccountNFTs({accountId:w.id,networkId:v.id,saveToLocal:!0});return f({initialized:!0,isRefreshing:!1}),s(!1),m(e.data),u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:k.GV.NFT,accountId:w.id,networkId:v.id}),e.data}})),[w,v,s],{overrideIsFocused:function(e){return e&&i},debounced:re.EI,pollingInterval:re.Pi}),I=(0,o.useRef)(!1),j=(0,o.useCallback)((t=(0,r.A)((function*({accountId:e,networkId:t,allNetworkDataInit:n}){var r=yield p.A.serviceNFT.fetchAccountNFTs({accountId:e,networkId:t,isAllNetworks:!0,isManualRefresh:I.current,allNetworksAccountId:w?.id,allNetworksNetworkId:v?.id,saveToLocal:!0});return!n&&r.networkId===Ce.onekeyall&&r.isSameAllNetworksAccountData&&(m((function(e){return te()([...e,...r.data],(function(e){return`${e.collectionAddress}_${e.itemId}`}))})),f({initialized:!0,isRefreshing:!1})),I.current=!1,r})),function(e){return t.apply(this,arguments)}),[w?.id,v?.id]),S=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:k.GV.NFT,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),x=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:k.GV.NFT,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),O=(0,o.useCallback)((function(){return m([])}),[]),L=(0,o.useCallback)((n=(0,r.A)((function*({accountId:e,networkId:t}){var n=yield p.A.serviceNFT.getAccountLocalNFTs({accountId:e,networkId:t});return Q()(n)?null:n})),function(e){return n.apply(this,arguments)}),[]),N=(0,o.useCallback)((function({data:e}){var t=e.flat();Q()(t)||(m(t),f({initialized:!0,isRefreshing:!1}))}),[]),{run:C,result:P,isEmptyAccount:_}=useAllNetworkRequests({account:w,network:v,wallet:g,allNetworkRequests:j,allNetworkCacheRequests:L,allNetworkCacheData:N,clearAllNetworkData:O,isNFTRequests:!0,onStarted:x,onFinished:S}),R=(0,o.useCallback)((function(){I.current=!0,C()}),[C]);return(0,o.useEffect)((function(){if(P){var e=[];for(var t of P)e=e.concat(t.data);m(te()(e,(function(e){return`${e.collectionAddress}_${e.itemId}`})))}}),[P]),(0,o.useEffect)((function(){var e,t=(e=(0,r.A)((function*(e,t){var n=yield p.A.serviceNFT.getAccountLocalNFTs({accountId:e,networkId:t});Q()(n)?f({initialized:!1,isRefreshing:!0}):(m(n),f({initialized:!0,isRefreshing:!1})),l(""),p.A.serviceNFT.updateCurrentAccount({networkId:t,accountId:e})})),function initNFTsState(t,n){return e.apply(this,arguments)});w?.id&&v?.id&&g?.id&&t(w.id,v.id)}),[w?.id,v?.id,l,g?.id]),(0,o.useEffect)((function(){a&&T()}),[a,T]),(0,o.useEffect)((function(){v?.isAllNetworks&&_&&(m([]),f({initialized:!0,isRefreshing:!1}))}),[_,v?.isAllNetworks]),(0,o.useEffect)((function(){var fn=function(){i&&(v?.isAllNetworks?R():T())};return u.iL.on(u.Tu.AccountDataUpdate,fn),function(){u.iL.off(u.Tu.AccountDataUpdate,fn)}}),[R,i,v?.isAllNetworks,T]),(0,h.jsx)(NFTListView,{inTabList:!0,data:null!=y?y:[],isLoading:d.isRefreshing,initialized:d.initialized,isAllNetworks:v?.isAllNetworks})}))),_e=n(892819),Re=n(578104),Me=n(734818),$e=n(106049);var Ee=n(918120);function TokenListContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function TokenListContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TokenListContainer_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TokenListContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=(0,ne.V)();function TokenListContainer(e){var t,n,i,a,s,l,d,y,m,{isFocused:w,isHeaderRefreshing:v,setIsHeaderRefreshing:g}=(0,c.useTabIsRefreshingFocused)(),{activeAccount:{account:T,network:I,wallet:j,indexedAccount:S,isOthersWallet:x,deriveInfo:O,deriveType:L}}=(0,b.LH)({num:0}),[N,C]=(0,o.useState)(!1),P=(0,o.useRef)({keys:"",tokens:[],map:{}}),$=(0,o.useRef)({keys:"",tokens:[],map:{}}),{vaultSettings:E}=(0,Oe.b)({networkId:null!=(t=I?.id)?t:""}),{handleFiatCrypto:F,isSupported:V}=(0,H.TH)({accountId:null!=(n=T?.id)?n:"",networkId:null!=(i=I?.id)?i:"",fiatCryptoType:"buy"}),{handleOnReceive:W}=(0,B.m)({accountId:null!=(a=T?.id)?a:"",networkId:null!=(s=I?.id)?s:"",walletId:null!=(l=j?.id)?l:"",deriveInfo:O,deriveType:L}),{handleOnManageToken:U,manageTokenEnabled:K}=function useManageToken({accountId:e,networkId:t,walletId:n,isOthersWallet:r,indexedAccountId:i,deriveType:a}){var s=(0,_.A)();return{manageTokenEnabled:!0,handleOnManageToken:(0,o.useCallback)((function(){s.pushModal(M.ry.MainModal,{screen:M.jX.TokenManagerModal,params:{walletId:n,isOthersWallet:r,indexedAccountId:i,networkId:t,accountId:e,deriveType:a}})}),[s,n,r,i,t,e,a])}}({accountId:null!=(d=T?.id)?d:"",networkId:null!=(y=I?.id)?y:"",walletId:null!=(m=j?.id)?m:"",deriveType:L,indexedAccountId:S?.id,isOthersWallet:x}),q=(0,c.useMedia)(),X=(0,_.A)();(0,c.useOnRouterChange)((function(e){var t=e?.routes.find((function({name:e}){return e===M.WP.Modal}));t?.params?.screen===M.ry.SendModal&&t?.params?.params?.screen===M.j$.SendSelectToken||t?.params?.screen===M.ry.ReceiveModal&&t?.params?.params?.screen===M.MD.ReceiveSelectToken?C(!0):C(!1)}));var G,J,{refreshAllTokenList:Y,refreshAllTokenListMap:ee,refreshTokenList:te,refreshTokenListMap:ne,refreshRiskyTokenList:oe,refreshRiskyTokenListMap:ie,refreshSmallBalanceTokenList:ae,refreshSmallBalanceTokenListMap:se,refreshSmallBalanceTokensFiatValue:ce,updateTokenListState:le,updateSearchKey:ue}=(0,R.WE)().current,{updateAccountWorth:de,updateAccountOverviewState:fe}=(0,Z.Lu)().current,{run:ke}=(0,A.yk)((0,r.A)((function*(){try{var e,t,n,r;if(!T||!I)return;if(I.isAllNetworks)return;u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:k.GV.TOKENS,accountId:T.id,networkId:I.id}),yield p.A.serviceToken.abortFetchAccountTokens();var o=yield p.A.serviceToken.fetchAccountTokens({accountId:T.id,mergeTokens:!0,networkId:I.id,flag:"home-token-list",saveToLocal:!0}),i=new z.A(0);if(i=i.plus(null!=(e=o.tokens.fiatValue)?e:"0").plus(null!=(t=o.riskTokens.fiatValue)?t:"0").plus(null!=(n=o.smallBalanceTokens.fiatValue)?n:"0"),fe({isRefreshing:!1,initialized:!0}),de({accountId:T.id,initialized:!0,worth:{[f.A.buildAccountValueKey({accountId:T.id,networkId:I.id})]:i.toFixed()},createAtNetworkWorth:i.toFixed(),merge:!1}),te({keys:o.tokens.keys,tokens:o.tokens.data}),ne({tokens:o.tokens.map}),oe({keys:o.riskTokens.keys,riskyTokens:o.riskTokens.data}),ie({tokens:o.riskTokens.map}),ae({keys:o.smallBalanceTokens.keys,smallBalanceTokens:o.smallBalanceTokens.data}),se({tokens:o.smallBalanceTokens.map}),ce({value:null!=(r=o.smallBalanceTokens.fiatValue)?r:"0"}),o.allTokens){Y({keys:o.allTokens?.keys,tokens:o.allTokens?.data}),ee({tokens:o.allTokens.map});var a=o.allTokens.data;a&&a.length&&p.A.serviceToken.updateLocalTokens({networkId:I.id,tokens:a}),le({initialized:!0,isRefreshing:!1}),u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:k.GV.TOKENS,accountId:T.id,networkId:I.id})}}catch(e){var s,c;if(u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:k.GV.TOKENS,accountId:null!=(s=T?.id)?s:"",networkId:null!=(c=I?.id)?c:""}),!(e instanceof _e.k3))throw e}finally{g(!1)}})),[T,I,te,ne,oe,ie,ae,se,ce,Y,ee,le,g,fe,de],{overrideIsFocused:function(e){return e&&w||N},debounced:re.EI,pollingInterval:re.iD}),pe=(0,o.useRef)(!1),ye=(0,Re.dh)((function(){te({keys:P.current.keys,tokens:P.current.tokens,merge:!0,map:P.current.map,mergeDerive:!0,split:!0}),oe({keys:$.current.keys,riskyTokens:$.current.tokens,merge:!0,map:$.current.map,mergeDerive:!0}),P.current.tokens=[],P.current.keys="",P.current.map={},$.current.tokens=[],$.current.keys="",$.current.map={}}),1e3),me=(0,o.useCallback)((G=(0,r.A)((function*({accountId:e,networkId:t,allNetworkDataInit:n}){var r=yield p.A.serviceToken.fetchAccountTokens({networkId:t,accountId:e,flag:"home-token-list",isAllNetworks:!0,isManualRefresh:pe.current,mergeTokens:!0,allNetworksAccountId:T?.id,allNetworksNetworkId:I?.id,saveToLocal:!0});if(!n&&r.isSameAllNetworksAccountData){var o,i,a,s,c=new z.A(0),l=new z.A(0);c=c.plus(null!=(o=r.tokens.fiatValue)?o:"0").plus(null!=(i=r.riskTokens.fiatValue)?i:"0").plus(null!=(a=r.smallBalanceTokens.fiatValue)?a:"0"),le({initialized:!0,isRefreshing:!1}),fe({isRefreshing:!1,initialized:!0}),T?.id&&(!f.A.isOthersAccount({accountId:T.id})||f.A.isOthersAccount({accountId:T.id})&&T?.createAtNetwork&&T.createAtNetwork===t)&&(l=c),de({accountId:null!=(s=T?.id)?s:"",initialized:!0,worth:{[f.A.buildAccountValueKey({accountId:e,networkId:t})]:c.toFixed()},createAtNetworkWorth:l.toFixed(),merge:!0});var u=!!(yield p.A.serviceNetwork.getVaultSettings({networkId:t})).mergeDeriveAssetsEnabled;P.current.tokens=P.current.tokens.concat([...r.tokens.data,...r.smallBalanceTokens.data]),P.current.keys=`${P.current.keys}_${r.tokens.keys}`;var d=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},r.tokens.map),r.smallBalanceTokens.map);P.current.map=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},d),P.current.map),$.current.tokens=$.current.tokens.concat([...r.riskTokens.data]),$.current.keys=`${$.current.keys}_${r.riskTokens.keys}`,$.current.map=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},r.riskTokens.map),$.current.map),ne({tokens:d,merge:!0,mergeDerive:u}),se({tokens:d,merge:!0,mergeDerive:u}),ie({tokens:r.riskTokens.map,merge:!0,mergeDerive:u}),r.allTokens&&(ee({tokens:r.allTokens.map,merge:!0,mergeDerive:u}),Y({keys:r.allTokens.keys,tokens:r.allTokens.data,map:r.allTokens.map,merge:!0,mergeDerive:u})),ye()}return pe.current=!1,r})),function(e){return G.apply(this,arguments)}),[T?.createAtNetwork,T?.id,I?.id,Y,ee,ie,se,ne,fe,de,ye,le]),we=(0,o.useCallback)((function(){var e=(0,Me.H7)();ce({value:"0"}),Y({tokens:e.allTokens.data,keys:e.allTokens.keys}),ee({tokens:e.allTokens.map}),te({tokens:e.tokens.data,keys:e.tokens.keys}),ne({tokens:e.tokens.map}),ae({smallBalanceTokens:e.smallBalanceTokens.data,keys:e.smallBalanceTokens.keys}),se({tokens:e.smallBalanceTokens.map}),oe({riskyTokens:e.riskTokens.data,keys:e.riskTokens.keys}),ie({tokens:e.riskTokens.map})}),[Y,ee,oe,ie,ae,se,ce,te,ne]),he=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:k.GV.TOKENS,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),Ae=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:k.GV.TOKENS,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),be=(0,o.useCallback)((J=(0,r.A)((function*({accountId:e,networkId:t,xpub:n,accountAddress:r}){var o=yield p.A.serviceToken.getAccountLocalTokens({accountId:e,networkId:t,accountAddress:r,xpub:n}),{tokenList:i,smallBalanceTokenList:a,riskyTokenList:s}=o;return Q()(i)&&Q()(s)&&Q()(a)?null:TokenListContainer_objectSpread(TokenListContainer_objectSpread({},o),{},{tokenList:i,smallBalanceTokenList:a,riskyTokenList:s,accountId:e,networkId:t})})),function(e){return J.apply(this,arguments)}),[]),ve=(0,o.useCallback)((function({data:e,accountId:t,networkId:n}){var r,o,i,a=[],s=[],c={},l={};(e.forEach((function(e){a.push(...e.tokenList,...e.smallBalanceTokenList),s.push(...e.riskyTokenList),c=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},c),e.tokenListMap),l=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},l),{},{[f.A.buildAccountValueKey({accountId:e.accountId,networkId:e.networkId})]:e.tokenListValue})})),ne({tokens:c,merge:!0,mergeDerive:!0}),ie({tokens:c,merge:!0,mergeDerive:!0}),ee({tokens:c,merge:!0,mergeDerive:!0}),te({keys:`${t}_${n}_local_all`,tokens:a,merge:!0,map:c,mergeDerive:!0,split:!0}),oe({keys:`${t}_${n}_local_all`,riskyTokens:s,merge:!0,map:c,mergeDerive:!0}),Y({keys:`${t}_${n}_local_all`,tokens:[...a,...s],map:c,merge:!0,mergeDerive:!0}),Q()(a)&&Q()(s))||(de({accountId:null!=(r=T?.id)?r:"",initialized:!0,worth:l,createAtNetworkWorth:l[f.A.buildAccountValueKey({accountId:null!=(o=T?.id)?o:"",networkId:null!=(i=T?.createAtNetwork)?i:""})],updateAll:!0}),fe({isRefreshing:!1,initialized:!0}),le({initialized:!0,isRefreshing:!1}))}),[T?.createAtNetwork,T?.id,Y,ee,oe,ie,te,ne,fe,de,le]),{run:ge,result:Te}=useAllNetworkRequests({account:T,network:I,wallet:j,allNetworkRequests:me,allNetworkCacheRequests:be,allNetworkCacheData:ve,clearAllNetworkData:we,onStarted:Ae,onFinished:he,interval:200,shouldAlwaysFetch:N}),Ie=(0,o.useCallback)((0,r.A)((function*(){var e={tokens:[],keys:""},t={smallBalanceTokens:[],keys:""},n={riskyTokens:[],keys:""},r={},o={},i={},a={},s=new z.A(0),c=new z.A(0);if(Te){var l;for(var u of Te){var d,k,y,m,w,h,A=(yield p.A.serviceNetwork.getVaultSettings({networkId:null!=(d=u.networkId)?d:""})).mergeDeriveAssetsEnabled;e.tokens=(0,Me.JW)({sourceTokens:u.tokens.data,targetTokens:e.tokens,mergeDeriveAssets:A}),e.keys=`${e.keys}_${u.tokens.keys}`,r=(0,Me.bX)({sourceMap:u.tokens.map,targetMap:r,mergeDeriveAssets:A}),t.smallBalanceTokens=(0,Me.JW)({sourceTokens:u.smallBalanceTokens.data,targetTokens:t.smallBalanceTokens,mergeDeriveAssets:A}),t.keys=`${t.keys}_${u.smallBalanceTokens.keys}`,o=(0,Me.bX)({sourceMap:u.smallBalanceTokens.map,targetMap:o,mergeDeriveAssets:A}),n.riskyTokens=(0,Me.JW)({sourceTokens:u.riskTokens.data,targetTokens:n.riskyTokens,mergeDeriveAssets:A}),n.riskyTokens=n.riskyTokens.concat(u.riskTokens.data),n.keys=`${n.keys}_${u.riskTokens.keys}`,i=(0,Me.bX)({sourceMap:u.riskTokens.map,targetMap:i,mergeDeriveAssets:A});var b,v,g,I=new z.A(null!=(k=u.tokens.fiatValue)?k:"0").plus(null!=(y=u.riskTokens.fiatValue)?y:"0").plus(null!=(m=u.smallBalanceTokens.fiatValue)?m:"0");if(a=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},a),{},{[f.A.buildAccountValueKey({accountId:null!=(w=u.accountId)?w:"",networkId:null!=(h=u.networkId)?h:""})]:I.toFixed()}),T?.id&&(!f.A.isOthersAccount({accountId:T.id})||f.A.isOthersAccount({accountId:T.id})&&T?.createAtNetwork&&T.createAtNetwork===u.networkId))s=s.plus(null!=(b=u.tokens.fiatValue)?b:"0").plus(null!=(v=u.riskTokens.fiatValue)?v:"0").plus(null!=(g=u.smallBalanceTokens.fiatValue)?g:"0")}var j=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},r),o),S=(0,Me.LQ)({tokens:[...e.tokens,...t.smallBalanceTokens],map:j}),x=S.findIndex((function(e){var t;return new z.A(null!=(t=j[e.$key]?.fiatValue)?t:0).isZero()}));if(x>-1){var O=S.slice(0,x),L=S.slice(x);L=(0,Me.q5)({tokens:L}),S=[...O,...L]}e.tokens=S.slice(0,re.tr),t.smallBalanceTokens=S.slice(re.tr),c=t.smallBalanceTokens.reduce((function(e,t){var n;return e.plus(null!=(n=j[t.$key].fiatValue)?n:"0")}),new z.A(0)),n.riskyTokens=(0,Me.LQ)({tokens:n.riskyTokens,map:i}),de({accountId:null!=(l=T?.id)?l:"",initialized:!0,updateAll:!0,worth:a,createAtNetworkWorth:s.toFixed()}),te(e),ne({tokens:j}),ae(t),se({tokens:j}),ce({value:c.toFixed()}),oe(n),ie({tokens:i})}})),[T?.createAtNetwork,T?.id,Te,oe,ie,ae,se,ce,te,ne,de]);(0,o.useEffect)((function(){Ie()}),[Ie]),(0,o.useEffect)((function(){v&&ke()}),[v,ke]),(0,o.useEffect)((function(){var e,t=(e=(0,r.A)((function*(e,t){if(ue(""),p.A.serviceToken.updateCurrentAccount({networkId:t,accountId:e}),t===He.onekeyall)return le({initialized:!1,isRefreshing:!0}),void fe({initialized:!1,isRefreshing:!0});var n=yield p.A.serviceToken.getAccountLocalTokens({accountId:e,networkId:t}),{tokenList:r,smallBalanceTokenList:o,riskyTokenList:i,tokenListMap:a,tokenListValue:s}=n;Q()(r)&&Q()(o)&&Q()(i)?(le({initialized:!1,isRefreshing:!0}),fe({initialized:!1,isRefreshing:!0}),t!==He.onekeyall&&we()):(de({accountId:e,initialized:!0,worth:{[f.A.buildAccountValueKey({accountId:e,networkId:t})]:s},createAtNetworkWorth:s,merge:!1}),te({tokens:r,keys:`${e}_${t}_local`}),ne({tokens:a}),ae({smallBalanceTokens:o,keys:`${e}_${t}_local`}),se({tokens:a}),oe({riskyTokens:i,keys:`${e}_${t}_local`}),ie({tokens:a}),Y({keys:`${e}_${t}_local`,tokens:[...r,...o,...i]}),ee({tokens:a}),fe({isRefreshing:!1,initialized:!0}),le({initialized:!0,isRefreshing:!1}))})),function initTokenListState(t,n){return e.apply(this,arguments)});T?.id&&I?.id&&j?.id&&t(T.id,I.id)}),[T?.id,we,I?.id,Y,ee,oe,ie,ae,se,te,ne,fe,de,ue,le,j?.id]);var je=(0,o.useCallback)((function(e){var t,n;T&&I&&j&&O&&X.pushModal(M.ry.MainModal,{screen:M.kZ.TokenDetails,params:{accountId:null!=(t=e.accountId)?t:T.id,networkId:null!=(n=e.networkId)?n:I.id,walletId:j.id,deriveInfo:O,deriveType:L,tokenInfo:e,isAllNetworks:I.isAllNetworks}})}),[T,O,L,X,I,j]),Se=(0,o.useMemo)((function(){return!E?.disabledSendAction&&j?.type!==D.Hk}),[E?.disabledSendAction,j?.type]),xe=(0,o.useCallback)((function(){pe.current=!0,ge({alwaysSetState:!0})}),[ge]);return(0,A.yk)((0,r.A)((function*(){if(T&&I&&I.isAllNetworks){var e=yield p.A.serviceHistory.getAllNetworksPendingTxs({accountId:T.id,networkId:I.id});if(!Q()(e))(yield p.A.serviceHistory.fetchAccountHistory({accountId:T.id,networkId:I.id})).pendingTxsUpdated&&xe()}})),[T,xe,I],{overrideIsFocused:function(e){return e&&w},debounced:re.EI,pollingInterval:re.fu}),(0,o.useEffect)((function(){var refresh=function(){I?.isAllNetworks?xe():ke()},fn=function(){w&&refresh()};return u.iL.on(u.Tu.RefreshTokenList,refresh),u.iL.on(u.Tu.AccountDataUpdate,fn),function(){u.iL.off(u.Tu.RefreshTokenList,refresh),u.iL.off(u.Tu.AccountDataUpdate,fn)}}),[xe,w,I?.isAllNetworks,ke,ge]),(0,h.jsx)($e.x,TokenListContainer_objectSpread({withHeader:!0,withFooter:!0,withPrice:!0,inTabList:!0,hideValue:!0,withBuyAndReceive:Se,isBuyTokenSupported:V,onBuyToken:F,onReceiveToken:W,manageTokenEnabled:K,onManageToken:U,onPressToken:je,isAllNetworks:I?.isAllNetworks},q.gtLg&&{tableLayout:!0}))}var De=(0,o.memo)((function(e){var t,{activeAccount:{account:n}}=(0,b.LH)({num:0});return(0,h.jsx)(Ee.m,{accountId:null!=(t=n?.id)?t:"",children:(0,h.jsx)(TokenListContainer,TokenListContainer_objectSpread({showWalletActions:!0},e))})}));De.displayName="TokenListContainerWithProvider";var Fe=n(232471),Be=n(124155),Ve=n(616552);function TxHistoryContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var We=(0,o.memo)((0,Ve.UK)((function TxHistoryListContainer(e){var t,{isFocused:n,isHeaderRefreshing:i,setIsHeaderRefreshing:a}=(0,c.useTabIsRefreshingFocused)(),{updateSearchKey:s}=(0,Ve.n8)().current,[l,d]=(0,o.useState)([]),[f,y]=(0,o.useState)({initialized:!1,isRefreshing:!1}),m=(0,o.useRef)(!1),w=(0,c.useMedia)(),v=(0,_.A)(),{activeAccount:{account:T,network:I,wallet:j}}=(0,b.LH)({num:0}),S=(0,o.useCallback)((t=(0,r.A)((function*(e){if(T&&I){if(e.decodedTx.status===Fe.Y1.Pending&&e.isLocalCreated){var t=yield p.A.serviceHistory.getLocalHistoryTxById({accountId:e.decodedTx.accountId,networkId:e.decodedTx.networkId,historyId:e.id});if(!t||t.replacedNextId)return}v.pushModal(M.ry.MainModal,{screen:M.kZ.HistoryDetails,params:{networkId:e.decodedTx.networkId,accountId:e.decodedTx.accountId,historyTx:e,isAllNetworks:I.isAllNetworks}})}})),function(e){return t.apply(this,arguments)}),[T,v,I]),x=(0,o.useRef)(!1),{run:O}=(0,A.yk)((0,r.A)((function*(){if(T&&I){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:k.GV.HISTORY,accountId:T.id,networkId:I.id});var e=yield p.A.serviceHistory.fetchAccountHistory({accountId:T.id,networkId:I.id,isManualRefresh:x.current});y({initialized:!0,isRefreshing:!1}),a(!1),d(e.txs),u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:k.GV.HISTORY,accountId:T.id,networkId:I.id}),e.pendingTxsUpdated&&u.iL.emit(u.Tu.RefreshTokenList,void 0),x.current=!1}})),[T,I,a],{overrideIsFocused:function(e){return e&&n},debounced:re.EI,pollingInterval:re.fu});return(0,o.useEffect)((function(){var e,t=(e=(0,r.A)((function*(e,t){var n=yield p.A.serviceHistory.getAccountsLocalHistoryTxs({accountId:e,networkId:t});Q()(n)?y({initialized:!1,isRefreshing:!0}):(d(n),y({initialized:!0,isRefreshing:!1})),s(""),m.current=!1})),function initHistoryState(t,n){return e.apply(this,arguments)});T?.id&&I?.id&&j?.id&&t(T.id,I.id)}),[T?.id,I?.id,s,j?.id]),(0,o.useEffect)((function(){i&&O()}),[i,O]),(0,o.useEffect)((function(){var refresh=function(){n&&(x.current=!0,O())},clearCallback=function(){return d((function(e){return e.filter((function(e){return e.decodedTx.status!==Fe.Y1.Pending}))}))};return u.iL.on(u.Tu.ClearLocalHistoryPendingTxs,clearCallback),u.iL.on(u.Tu.AccountDataUpdate,refresh),function(){u.iL.off(u.Tu.ClearLocalHistoryPendingTxs,clearCallback),u.iL.off(u.Tu.AccountDataUpdate,refresh)}}),[n,O]),(0,o.useEffect)((function(){var reloadCallback=function(){return O({alwaysSetState:!0})},fn=function(){n&&O()};return u.iL.on(u.Tu.AccountDataUpdate,fn),u.iL.on(u.Tu.HistoryTxStatusChanged,reloadCallback),function(){u.iL.off(u.Tu.HistoryTxStatusChanged,reloadCallback),u.iL.off(u.Tu.AccountDataUpdate,fn)}}),[n,O]),(0,h.jsx)(Be.q,function TxHistoryContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TxHistoryContainer_ownKeys(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TxHistoryContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({showIcon:!0,inTabList:!0,hideValue:!0,data:null!=l?l:[],onPressHistory:S,showHeader:!0,isLoading:f.isRefreshing,initialized:f.initialized},w.gtLg&&{tableLayout:!0}))})));const Ue=function LNHardwareWalletAuth({children:e,accountId:t,networkId:n}){var a=(0,i.A)(),[s,l]=(0,o.useState)(!1),[u,f]=(0,o.useState)(!1),{result:k,run:y}=(0,A.yk)((0,r.A)((function*(){try{return yield p.A.serviceLightning.checkAuth({accountId:t,networkId:n}),!0}catch{return!1}finally{l(!0)}})),[n,t]),m=(0,o.useCallback)((0,r.A)((function*(){f(!0);try{yield p.A.serviceLightning.exchangeToken({networkId:n,accountId:t}),setTimeout((function(){y()}),200)}catch(e){c.Toast.error({title:a.formatMessage({id:d.ETranslations.ln_authorize_access_network_error})})}finally{f(!1)}})),[n,t,a,y]);return s?k?(0,h.jsx)(h.Fragment,{children:e}):(0,h.jsxs)(c.Stack,{testID:"LNHardwareAuth",w:"100%",h:"100%",children:[(0,h.jsx)(N.p,{children:(0,h.jsx)(c.Stack,{testID:"Wallet-Tab-Header",p:"$5",children:(0,h.jsx)(O,{mb:"$2.5"})})}),(0,h.jsx)(c.Stack,{flex:1,testID:"LNHardware",justifyContent:"center",alignItems:"center",children:(0,h.jsx)(c.Empty,{icon:"PasswordOutline",title:a.formatMessage({id:d.ETranslations.ln_authorize_access}),description:a.formatMessage({id:d.ETranslations.ln_authorize_access_desc}),buttonProps:{children:a.formatMessage({id:d.ETranslations.global_connect_hardware_wallet}),onPress:function(){m()},loading:u}})})]}):(0,h.jsx)(c.Stack,{w:"100%",h:"100%",alignItems:"center",justifyContent:"center",children:(0,h.jsx)(c.Spinner,{size:"large"})})};var ze=n(553083);const Ke=function WalletContentWithAuth({networkId:e,accountId:t,children:n}){return ze.Ay.isLightningNetworkByNetworkId(e)&&f.A.isHwAccount({accountId:t})?(0,h.jsx)(Ue,{networkId:e,accountId:t,children:n}):n};var qe;function HomePageView({onPressHide:e,sceneName:t}){var n,w,{screenWidth:g,pageWidth:T}=(0,L.A)();null==qe&&(qe=new a.A.Value(T)),(0,o.useEffect)((function(){qe&&a.A.timing(qe,{toValue:T,duration:400,easing:s.A.inOut(s.A.quad),useNativeDriver:!1}).start()}),[T]);var I=(0,i.A)(),{activeAccount:{account:j,accountName:S,network:x,deriveInfo:N,wallet:C,ready:P,device:_}}=(0,b.LH)({num:0}),[R,M]=(N?.labelKey?I.formatMessage({id:N?.labelKey}):n=N?.label,(0,o.useState)(!1)),$=(0,A.yk)((0,r.A)((function*(){var e;return x?p.A.serviceNetwork.getVaultSettings({networkId:null!=(e=x?.id)?e:""}):Promise.resolve(void 0)})),[x]).result,E=$?.NFTEnabled&&(0,l.cN)().includes(null!=(w=x?.id)?w:""),H=$?.validationRequired,D=$?.softwareAccountDisabled,F=$?.supportedDeviceTypes,B=$?.watchingAccountEnabled,V=(0,o.useMemo)((function(){return[{title:I.formatMessage({id:d.ETranslations.global_crypto}),page:(0,o.memo)(De,(function(){return!0}))},E?{title:I.formatMessage({id:d.ETranslations.global_nft}),page:(0,o.memo)(Pe,(function(){return!0}))}:null,{title:I.formatMessage({id:d.ETranslations.global_history}),page:(0,o.memo)(We,(function(){return!0}))}].filter(Boolean)}),[I,j?.id,x?.id,E]),W=(0,o.useCallback)((function(){u.iL.emit(u.Tu.AccountDataUpdate,void 0)}),[]),U=(0,o.useCallback)((function(){return(0,h.jsx)(c.Tab,{disableRefresh:!0,data:V,ListHeaderComponent:(0,h.jsx)(HomeHeaderContainer,{}),initialScrollIndex:0,initialHeaderHeight:220,contentItemWidth:qe,contentWidth:g,showsVerticalScrollIndicator:!1,onRefresh:W})}),[V,g,W]),z=(0,o.useCallback)((function(){var e,t,n,r,o;return D&&f.A.isHdWallet({walletId:null!=(e=C?.id)?e:""})||F&&_?.deviceType&&!F.includes(_?.deviceType)?(0,h.jsx)(HomeSupportedWallet,{supportedDeviceTypes:F,watchingAccountEnabled:B}):j?H?(0,h.jsx)(Ke,{networkId:null!=(r=x?.id)?r:"",accountId:null!=(o=j?.id)?o:"",children:(0,h.jsx)(h.Fragment,{children:U()})}):(0,h.jsx)(h.Fragment,{children:U()}):(0,h.jsxs)(c.YStack,{height:"100%",children:[(0,h.jsx)(O,{padding:"$5"}),(0,h.jsx)(c.Stack,{flex:1,justifyContent:"center",children:(0,h.jsx)(y.TP,{autoCreateAddress:!0,name:S,chain:null!=(t=x?.name)?t:"",type:null!=(n=N?.labelKey?I.formatMessage({id:N?.labelKey}):N?.label)?n:""})})]})}),[D,C?.id,F,_?.deviceType,j,H,U,B,S,x?.name,x?.id,N?.labelKey,N?.label,I]),K=(0,o.useCallback)((function(){if(!P)return(0,h.jsx)(m.i,{showHeaderRight:!0,sceneName:t});var e=(0,h.jsx)(c.Stack,{h:"100%",justifyContent:"center",children:(0,h.jsx)(y.Bl,{})});return C&&(e=z()),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(m.i,{showHeaderRight:!0,sceneName:t}),(0,h.jsxs)(c.Page.Body,{children:[t===k.Zs.home?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(UpdateReminder,{}),(0,h.jsx)(v.a,{})]}):null,e]})]})}),[P,C,t,z]);return(0,o.useMemo)((function(){return(0,h.jsx)(c.Page,{fullPage:!0,children:K()})}),[K])}}}]);