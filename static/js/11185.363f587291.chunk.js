"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[11185],{82506:(e,n,t)=>{t.d(n,{d:()=>useDebounce});var r=t(578104);function useDebounce(e,n,t){var[o]=(0,r.d7)(e,n,t);return o}},278484:(e,n,t)=>{t.d(n,{wI:()=>DAppAccountListItem,ZY:()=>DAppAccountListStandAloneItem,X1:()=>DAppAccountListStandAloneItemForHomeScene,VV:()=>WalletConnectAccountTriggerList});var r=t(460986),o=t.n(r),s=t(324586),c=t(586330),a=t(514041),i=t(908867),u=t(17617),l=t(490343),d=t(610421),p=t(325809),f=t(237532),g=t(24284),m=t(911998),_=t(162616),A=t(226952),h=t(334439),S=(t(663522),t(584186)),y=t(714191),b=t(82506);var x=t(831085);function ownKeys(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach((function(n){(0,s.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function DAppAccountListInitFromHome({num:e,shouldSyncFromHome:n}){var[,t]=(0,_.K7)(),r=(0,_.z$)();return(0,a.useEffect)((function(){return(0,c.A)((function*(){try{t((function(n){return _objectSpread(_objectSpread({},n),{},{[e]:{isLoading:!0}})})),yield S.A.wait(600),n&&(yield r.current.syncFromScene({from:{sceneName:y.Zs.home,sceneNum:0},num:e}))}finally{n&&(yield S.A.wait(300)),t((function(n){return _objectSpread(_objectSpread({},n),{},{[e]:{isLoading:!1}})}))}}))(),function(){t((function(n){return _objectSpread(_objectSpread({},n),{},{[e]:{isLoading:!1}})}))}}),[r,e,t,n]),null}function DAppAccountListItem({num:e,handleAccountChanged:n,readonly:t,networkReadonly:r,compressionUiMode:o,initFromHome:s,beforeShowTrigger:c,skeletonRenderDuration:i}){!function useHandleDiscoveryAccountChanged({num:e,handleAccountChanged:n}){var{activeAccount:t}=(0,_.LH)({num:e}),{selectedAccount:r}=(0,_.wz)({num:e}),o=(0,b.d)(t,200),s=(0,b.d)(r,200),c=(0,a.useRef)(t),i=(0,a.useRef)(r);(0,a.useEffect)((function(){c.current=t,i.current=r}),[t,r]),(0,a.useEffect)((function(){n&&(o.isOthersWallet&&o.account?.id===s.othersWalletAccountId||o.indexedAccount?.id===s.indexedAccountId)&&n({activeAccount:c.current,selectedAccount:i.current},e)}),[o,s,n,e])}({num:e,handleAccountChanged:n});var d=Boolean(s&&!t);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(l.YGroup,{bg:"$bg",borderRadius:"$3",borderColor:"$borderSubdued",borderWidth:u.A.hairlineWidth,separator:(0,x.jsx)(l.Divider,{}),disabled:t,children:[(0,x.jsx)(l.YGroup.Item,{children:(0,x.jsx)(p.jY,{num:e,beforeShowTrigger:c,disabled:r||t,loadingDuration:0})}),(0,x.jsx)(l.YGroup.Item,{children:(0,x.jsx)(f.Up,{num:e,compressionUiMode:o,beforeShowTrigger:c,loadingDuration:0})})]}),(0,x.jsx)(DAppAccountListInitFromHome,{num:e,shouldSyncFromHome:d})]})}function DAppAccountListStandAloneItem({readonly:e,handleAccountChanged:n,onConnectedAccountInfoChanged:t}){var r=(0,i.A)(),{serviceDApp:s,serviceNetwork:u}=d.A,{$sourceInfo:f}=(0,g.A)(),{result:_}=(0,m.yk)((0,c.A)((function*(){var e,n;if(!f?.origin||!f.scope)return{accountSelectorNum:null,networkIds:null};var t=(0,A.zg)(f.scope),r=t?(yield u.getNetworkIdsByImpls({impls:t})).networkIds:null,o=yield s.getConnectedAccountsInfo({origin:f.origin,scope:null!=(e=f.scope)?e:"",isWalletConnectRequest:f.isWalletConnectRequest});return Array.isArray(o)&&o.length>0&&"number"==typeof o[0]?.num?{accountSelectorNum:o[0].num,networkIds:r,existConnectedAccount:!0}:{accountSelectorNum:yield s.getAccountSelectorNum({origin:f.origin,scope:null!=(n=f.scope)?n:"",isWalletConnectRequest:f.isWalletConnectRequest}),networkIds:r,existConnectedAccount:!1}})),[f?.origin,f?.scope,f?.isWalletConnectRequest,s,u]);return(0,a.useEffect)((function(){o()(_?.accountSelectorNum)&&t&&t({num:_.accountSelectorNum,existConnectedAccount:_.existConnectedAccount})}),[_?.accountSelectorNum,_?.existConnectedAccount,t]),(0,x.jsxs)(l.YStack,{gap:"$2",testID:"DAppAccountListStandAloneItem",children:[(0,x.jsx)(l.SizableText,{size:"$headingMd",color:"$text",children:r.formatMessage({id:h.ETranslations.global_accounts})}),"number"==typeof _?.accountSelectorNum&&Array.isArray(_?.networkIds)?(0,x.jsx)(p.b8,{config:{sceneName:y.Zs.discover,sceneUrl:f?.origin},enabledNum:[_.accountSelectorNum],availableNetworksMap:{[_.accountSelectorNum]:{networkIds:_.networkIds}},children:(0,x.jsx)(DAppAccountListItem,{initFromHome:!_?.existConnectedAccount,num:_?.accountSelectorNum,handleAccountChanged:n,readonly:e})}):null]})}function DAppAccountListStandAloneItemForHomeScene(){var e=(0,i.A)();return(0,x.jsxs)(l.YStack,{gap:"$2",testID:"DAppAccountListStandAloneItem",children:[(0,x.jsx)(l.SizableText,{size:"$headingMd",color:"$text",children:e.formatMessage({id:h.ETranslations.global_accounts})}),(0,x.jsx)(p.b8,{config:{sceneName:y.Zs.home},enabledNum:[0],children:(0,x.jsx)(DAppAccountListItem,{initFromHome:!1,num:0,readonly:!0})})]})}function WalletConnectAccountTriggerList({sceneUrl:e,sessionAccountsInfo:n,handleAccountChanged:t}){var r=n.map((function(e){return e.accountSelectorNum})),o=n.reduce((function(e,n){var t=n.networkIds.filter(Boolean);return e[n.accountSelectorNum]={networkIds:t,defaultNetworkId:t[0]},e}),{});return(0,x.jsxs)(l.YStack,{gap:"$2",children:[(0,x.jsx)(l.SizableText,{size:"$headingMd",color:"$text",children:"Accounts"}),Array.isArray(n)&&n.length?(0,x.jsx)(p.b8,{config:{sceneName:y.Zs.discover,sceneUrl:e},enabledNum:r,availableNetworksMap:o,children:(0,x.jsx)(l.YStack,{gap:"$2",children:n.map((function(e){return(0,x.jsx)(l.Stack,{children:(0,x.jsx)(DAppAccountListItem,{initFromHome:!0,num:e.accountSelectorNum,handleAccountChanged:t})},e.accountSelectorNum)}))})}):null]})}},701378:(e,n,t)=>{t.d(n,{_:()=>DAppRequestedPermissionContent,N:()=>DAppSignMessageContent});var r=t(908867),o=t(17617),s=t(490343),c=t(334439),a=t(831085);function DAppRequestedPermissionContent({requestPermissions:e}){var n=(0,r.A)();return(0,a.jsxs)(s.YStack,{gap:"$2",children:[(0,a.jsx)(s.SizableText,{color:"$text",size:"$headingMd",children:n.formatMessage({id:c.ETranslations.dapp_connect_requested_permissions})}),(0,a.jsx)(s.YStack,{py:"$2.5",px:"$3",gap:"$3",minHeight:"$8",bg:"$bg",borderRadius:"$3",borderWidth:o.A.hairlineWidth,borderColor:"$borderSubdued",borderCurve:"continuous",children:(null!=e?e:[n.formatMessage({id:c.ETranslations.dapp_connect_view_your_balance_and_activity}),n.formatMessage({id:c.ETranslations.dapp_connect_send_approval_requests})]).map((function(e){return(0,a.jsxs)(s.XStack,{gap:"$3",children:[(0,a.jsx)(s.Icon,{name:"CheckLargeOutline",color:"$icon",size:"$5"}),(0,a.jsx)(s.SizableText,{color:"$text",size:"$bodyMd",children:e})]},e)}))})]})}var i=t(586330),u=t(514041),l=t(903454),d=t(911998),p=t(276059),f=t(161024),g=t(901048).Buffer;function DAppSignMessageContent({unsignedMessage:e}){var n=(0,r.A)(),[t,o]=(0,u.useState)(!1),m=(0,u.useMemo)((function(){var{message:n,type:t,payload:r}=e;switch(t){case f.nc.ECDSA:case f.nc.BIP322_SIMPLE:case f.$.ETH_SIGN:case f.nZ.SIMPLE_SIGN:return n;case f.$.PERSONAL_SIGN:case f.nZ.SIGN_MESSAGE:try{return l.toBuffer(n).toString("utf8")}catch(e){return n}case f.nZ.HEX_MESSAGE:return g.from(n,"hex").toString("utf8");case f.nF.SIGN_MESSAGE:var o;return null!=(o=r?.message)?o:n;case f.$.TYPED_DATA_V1:var s,c,a=null!=(s=JSON.parse(n))?s:{};if(a=null!=(c=a.message)?c:a,Array.isArray(a))a=a.reduce((function(e,n){return e[n.name]=n.value,e}),{});return JSON.stringify(a,null,2);case f.$.TYPED_DATA_V3:case f.$.TYPED_DATA_V4:try{var i,u,d=JSON.parse(n);return d=null!=(i=d?.message)?i:d,JSON.stringify("string"==typeof d?null!=(u=JSON.parse(d))?u:{}:d,null,2)}catch{return n}default:return n}}),[e]),_=(0,u.useCallback)((function(){var{message:r,type:i}=e;if(i===f.nc.ECDSA||i===f.nc.BIP322_SIMPLE||i===f.$.ETH_SIGN||i===f.nZ.SIMPLE_SIGN)return null;var u=r;if(i===f.$.TYPED_DATA_V1||i===f.$.TYPED_DATA_V3||i===f.$.TYPED_DATA_V4){try{u=JSON.parse(u)}catch(e){}u=JSON.stringify(u,null,2)}return(0,a.jsxs)(s.YStack,{gap:"$2",children:[(0,a.jsx)(s.Button,{variant:"secondary",onPress:function(){return o(!t)},children:t?n.formatMessage({id:c.ETranslations.dapp_connect_hide_full_message}):n.formatMessage({id:c.ETranslations.dapp_connect_view_full_message})}),t?(0,a.jsx)(s.TextAreaInput,{editable:!1,numberOfLines:11,value:u}):null]})}),[n,e,t]),A=(0,d.yk)((0,i.A)((function*(){return(0,p.Qw)({unsignedMessage:e})})),[e]);return(0,a.jsxs)(s.YStack,{justifyContent:"center",children:[(0,a.jsxs)(s.XStack,{alignItems:"center",justifyContent:"space-between",children:[(0,a.jsx)(s.SizableText,{color:"$text",size:"$headingMd",mb:"$2",children:n.formatMessage({id:c.ETranslations.dapp_connect_message})}),A.result?(0,a.jsx)(s.Badge,{badgeType:"info",badgeSize:"sm",children:A.result}):null]}),(0,a.jsxs)(s.YStack,{gap:"$2",children:[(0,a.jsx)(s.TextAreaInput,{value:m,editable:!1,numberOfLines:11}),_()]})]})}},980342:(e,n,t)=>{t.d(n,{A:()=>c,z:()=>useDappCloseHandler});var r=t(490343),o=t(42484),s=t(831085);function useDappCloseHandler(e,n){return function(t){t?.flag!==o.nd.Confirmed&&e.reject(),"function"==typeof n&&n(t)}}const c=function DappOpenModalPage({children:e,onClose:n,dappApprove:t}){var o=useDappCloseHandler(t,n);return(0,s.jsxs)(r.Page,{scrollEnabled:!0,onClose:o,children:[(0,s.jsx)(r.Page.Header,{headerShown:!1}),e]})}},311185:(e,n,t)=>{t.r(n),t.d(n,{default:()=>x});var r=t(586330),o=t(514041),s=t(654266),c=t(908867),a=t(490343),i=t(610421),u=t(498356),l=t(796895),d=t(24284),p=t(911998),f=t(980342),g=t(507140),m=t(334439),_=t(42484),A=t(278484),h=t(701378),S=t(864961),y=t(905710),b=t(831085);const x=function LnurlAuthModal(){var e,n,t,x,T=(0,c.A)(),j=(0,u.A)(),v=(0,s.lq)().params,{isSendFlow:w}=v,I=(0,d.A)(),{$sourceInfo:D}=I,{accountId:E,networkId:k,lnurlDetails:C}=w?v:I,M=(0,o.useMemo)((function(){if(C?.url)return new URL(C.url).origin}),[C?.url]),N=(0,l.A)({id:null!=(e=D?.id)?e:"",closeWindowAfterResolved:!0}),[$,P]=(0,o.useState)(!1),{showContinueOperate:O,continueOperate:L,setContinueOperate:Y,riskLevel:H,urlSecurityInfo:q}=(0,y.q)({origin:null!=M?M:""}),{result:F}=(0,p.yk)((0,r.A)((function*(){return"reigster"===C.action?{allowText:T.formatMessage({id:m.ETranslations.dapp_connect_allow_to_access_your_chain_register},{chain:"Lightning Network"}),title:T.formatMessage({id:m.ETranslations.dapp_connect_lnurl_register_request}),successText:T.formatMessage({id:m.ETranslations.dapp_connect_registration_successful})}:"link"===C.action?{allowText:T.formatMessage({id:m.ETranslations.dapp_connect_allow_to_access_your_chain_link},{chain:"Lightning Network"}),title:T.formatMessage({id:m.ETranslations.dapp_connect_lnurl_connect_request}),successText:T.formatMessage({id:m.ETranslations.dapp_connect_link_successful})}:"auth"===C.action?{allowText:T.formatMessage({id:m.ETranslations.dapp_connect_allow_to_access_your_chain_auth},{chain:"Lightning Network"}),title:T.formatMessage({id:m.ETranslations.dapp_connect_lnurl_approve_request}),successText:T.formatMessage({id:m.ETranslations.dapp_connect_authorization_successful})}:{allowText:T.formatMessage({id:m.ETranslations.dapp_connect_allow_to_access_your_chain_login},{chain:"Lightning Network"}),title:T.formatMessage({id:m.ETranslations.dapp_connect_lnurl_login_request}),successText:T.formatMessage({id:m.ETranslations.dapp_connect_login_successful})}})),[C?.action,T]),z=(0,o.useCallback)((function(){var e=[T.formatMessage({id:m.ETranslations.dapp_connect_request_for_lnurl_linking_key})];return"auth"===C.action&&(e=[T.formatMessage({id:m.ETranslations.dapp_connect_watch_your_account_balance_and_activity}),T.formatMessage({id:m.ETranslations.dapp_connect_request_for_lnurl_linking_key}),T.formatMessage({id:m.ETranslations.dapp_connect_request_invoices_and_lightning_information})]),(0,b.jsx)(h._,{requestPermissions:e})}),[C?.action,T]),R=(0,o.useCallback)((x=(0,r.A)((function*(e){if(C&&!$){P(!0);var{serviceLightning:n}=i.A;try{var t;yield n.lnurlAuth({accountId:E,networkId:k,lnurlDetail:C}),a.Toast.success({title:null!=(t=F?.successText)?t:""}),setTimeout((function(){w?j.popStack():N.resolve({close:function(){e?.({flag:_.nd.Confirmed})}})}),300)}catch(n){var r=n?.message;throw w||setTimeout((function(){N.resolve({close:function(){e?.({flag:_.nd.Confirmed})},result:{status:"ERROR",reason:r}})}),1500),new g.oZ({info:r,autoToast:!0})}finally{P(!1)}}})),function(e){return x.apply(this,arguments)}),[C,$,E,k,F,w,N,j]);return(0,b.jsx)(f.A,{dappApprove:N,children:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(a.Page.Header,{headerShown:!1}),(0,b.jsx)(a.Page.Body,{children:(0,b.jsxs)(S.HJ,{title:null!=(n=F?.title)?n:"",subtitle:null!=(t=F?.allowText)?t:"",origin:null!=M?M:"",urlSecurityInfo:q,children:[w?(0,b.jsx)(A.X1,{}):(0,b.jsx)(A.ZY,{readonly:!0}),z()]})}),(0,b.jsx)(a.Page.Footer,{children:(0,b.jsx)(S.OS,{continueOperate:L,setContinueOperate:function(e){Y(!!e)},onConfirm:R,onCancel:function(){w||N.reject()},confirmButtonProps:{loading:$,disabled:!L},showContinueOperateCheckbox:O,riskLevel:H})})]})})}},276059:(e,n,t)=>{t.d(n,{Vq:()=>isEthSignType,kW:()=>isPrimaryTypeOrderSign,PQ:()=>isPrimaryTypePermitSign,Qw:()=>parsePrimaryType});var r=t(161024),o=function(e){return e.Order="Order",e.OrderComponents="OrderComponents",e}({}),s=function(e){return e.Permit="Permit",e.PermitBatch="PermitBatch",e.PermitBatchTransferFrom="PermitBatchTransferFrom",e.PermitSingle="PermitSingle",e.PermitTransferFrom="PermitTransferFrom",e}({}),c=Object.values(o),a=Object.values(s),isEthSignType=function({unsignedMessage:e}){return e.type===r.$.ETH_SIGN},isPrimaryTypeSign=function(e,n){if(e.type!==r.$.TYPED_DATA_V3&&e.type!==r.$.TYPED_DATA_V4)return!1;var{message:t}=e;try{var o=JSON.parse(t);return void 0!==o.primaryType&&n.includes(o.primaryType)}catch{return!1}},isPrimaryTypePermitSign=function({unsignedMessage:e}){return isPrimaryTypeSign(e,a)},isPrimaryTypeOrderSign=function({unsignedMessage:e}){return isPrimaryTypeSign(e,c)},parsePrimaryType=function({unsignedMessage:e}){if(e.type!==r.$.TYPED_DATA_V3&&e.type!==r.$.TYPED_DATA_V4)return null;try{var{message:n}=e,t=JSON.parse(n);if(t.primaryType)return t.primaryType}catch{}return null}}}]);