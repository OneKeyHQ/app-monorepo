"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[86890],{183259:(e,r,t)=>{t.d(r,{U:()=>s});var a=t(514041),n=t(17617),i=t(490343),o=t(831085);var s=(0,a.memo)((function BasicDiscoveryIcon({uri:e,size:r,borderRadius:t="$2"}){return e?(0,o.jsxs)(i.Image,{size:r,borderRadius:t,borderWidth:n.A.hairlineWidth,borderColor:"$borderSubdued",borderCurve:"continuous",children:[(0,o.jsx)(i.Image.Source,{source:{uri:decodeURIComponent(e)}}),(0,o.jsx)(i.Image.Fallback,{children:(0,o.jsx)(i.Stack,{bg:"$bgStrong",ai:"center",jc:"center",width:"100%",height:"100%",children:(0,o.jsx)(i.Icon,{name:"GlobusOutline",width:"100%",height:"100%"})})}),(0,o.jsx)(i.Image.Loading,{children:(0,o.jsx)(i.Skeleton,{width:"100%",height:"100%"})})]}):(0,o.jsx)(i.Skeleton,{width:r,height:r,radius:"round"})}))},186890:(e,r,t)=>{t.r(r),t.d(r,{default:()=>j});var a=t(586330),n=t(514041),i=t(654266),o=t(908867),s=t(728046),l=t(17617),d=t(490343),u=t(610421),c=t(791088),h=t(498356),p=t(911998),b=t(657412),g=t(334439),m=t(948675),x=t(899035),f=t(392097),M=t(183259),y=t(564452),k=t(831085);function DappSearchModalSectionHeader({title:e,onMorePress:r}){var t=(0,o.A)();return(0,k.jsxs)(d.XStack,{px:"$5",pb:"$2",alignItems:"center",justifyContent:"space-between",children:[(0,k.jsx)(d.Heading,{size:"$headingMd",children:e}),(0,k.jsx)(d.Button,{variant:"tertiary",size:"medium",onPress:r,children:t.formatMessage({id:g.ETranslations.explore_see_all})})]})}var S="SEARCH_ITEM_ID",w=(0,k.jsx)(d.Image.Loading,{children:(0,k.jsx)(d.Skeleton,{width:"100%",height:"100%"})});const j=(0,y.k)((function SearchModal(){var e,r,t,y=(0,o.A)(),j=(0,h.A)(),v=(0,i.lq)(),{useCurrentWindow:I,tabId:D,url:$=""}=null!=(e=v.params)?e:{},[T,C]=(0,n.useState)($),{gtMd:A}=(0,d.useMedia)(),{handleOpenWebSite:P}=(0,b.yZ)().current,{serviceDiscovery:z}=u.A,{result:B,run:_}=(0,p.yk)((0,a.A)((function*(){return{bookmarkData:yield z.getBookmarkData({generateIcon:!0,sliceCount:8}),historyData:yield z.getHistoryData({generateIcon:!0,sliceCount:8,keyword:null!=T?T:void 0})}})),[z,T]),{result:L}=(0,p.yk)((0,a.A)((function*(){return yield z.searchDApp(T)})),[T,z]),W=(0,n.useRef)(!1);(0,i.xK)((function(){W.current&&(setTimeout((function(){_()}),300),W.current=!1)}));var[E,O]=(0,n.useState)([]);(0,n.useEffect)((function(){(0,a.A)((function*(){if(T){var e=yield u.A.serviceDiscovery.buildWebsiteIconUrl("https://google.com");O([{dappId:S,name:`${y.formatMessage({id:g.ETranslations.explore_search_placeholder})} "${T}"`,url:"",logo:e},...null!=L?L:[]])}else O([])}))()}),[T,L,y]);var U=Array.isArray(E)&&E.length>0,H=(null!=(r=B?.bookmarkData)?r:[]).length>0&&!U,R=(null!=(t=B?.historyData)?t:[]).length>0,N=(0,n.useCallback)((function(e){return e.map((function(e,r){return(0,k.jsx)(c.c,{avatarProps:{src:e.logo||e.originLogo,loading:w,fallbackProps:{bg:"$bgStrong",justifyContent:"center",alignItems:"center",children:(0,k.jsx)(d.Icon,{name:"GlobusOutline"})},borderWidth:l.A.hairlineWidth,borderColor:"$borderSubdued"},renderItemText:function(){return(0,k.jsx)(d.RichSizeableText,{linkList:{a:{url:void 0,cursor:"auto"}},numberOfLines:1,size:"$bodyLgMedium",flex:1,children:e?.keyword?e.name.replace(new RegExp(e.keyword,"ig"),`<a>${e.keyword}</a>`):e.name})},subtitleProps:{numberOfLines:1},onPress:function(){e.dappId===S?(P({switchToMultiTabBrowser:A,navigation:j,useCurrentWindow:I,tabId:D,webSite:{url:T,title:T}}),m.U.discovery.dapp.enterDapp({dappDomain:T,dappName:T,enterMethod:x.z.search})):(P({switchToMultiTabBrowser:A,navigation:j,useCurrentWindow:I,tabId:D,dApp:e}),m.U.discovery.dapp.enterDapp({dappDomain:e.name,dappName:e.url,enterMethod:x.z.search}))},testID:`dapp-search${r}`},r)}))}),[A,P,j,T,D,I]);return(0,k.jsxs)(d.Page,{safeAreaEnabled:!0,children:[(0,k.jsx)(d.Page.Header,{headerTitle:y.formatMessage({id:g.ETranslations.explore_search_placeholder})}),(0,k.jsxs)(d.Page.Body,{children:[(0,k.jsx)(d.Stack,{mx:"$4",children:(0,k.jsx)(d.SearchBar,{autoFocus:!0,zIndex:20,selectTextOnFocus:!0,value:T,onSearchTextChange:C,placeholder:y.formatMessage({id:g.ETranslations.browser_search_dapp_or_enter_url}),onSubmitEditing:function(){P({switchToMultiTabBrowser:A,navigation:j,useCurrentWindow:I,tabId:D,webSite:{url:T,title:T}}),m.U.discovery.dapp.enterDapp({dappDomain:T,dappName:T,enterMethod:x.z.addressBar})}})}),(0,k.jsxs)(d.ScrollView,{pt:"$2",pb:"$5",keyboardDismissMode:"none",keyboardShouldPersistTaps:"handled",onScrollBeginDrag:s.A.dismiss,children:[U?N(E):null,H?(0,k.jsxs)(d.Stack,{children:[(0,k.jsx)(DappSearchModalSectionHeader,{title:y.formatMessage({id:g.ETranslations.explore_bookmarks}),onMorePress:function(){W.current=!0,j.pushModal(f.ry.DiscoveryModal,{screen:f.v1.BookmarkListModal})}}),(0,k.jsx)(d.XStack,{children:B?.bookmarkData?.map((function(e,r){return(0,k.jsxs)(d.Stack,{flexBasis:"25%",alignItems:"center",py:"$2",$gtMd:{flexBasis:"16.66666667%"},onPress:function(){P({switchToMultiTabBrowser:A,navigation:j,useCurrentWindow:I,tabId:D,webSite:{url:e.url,title:e.title}}),m.U.discovery.dapp.enterDapp({dappDomain:e.url,dappName:e.title,enterMethod:x.z.bookmarkInSearch})},children:[(0,k.jsx)(M.U,{uri:e.logo,size:"$14",borderRadius:"$3"}),(0,k.jsx)(d.SizableText,{mt:"$2",px:"$2",size:"$bodyLgMedium",textAlign:"center",$gtMd:{size:"$bodyMdMedium"},numberOfLines:1,children:e.title})]},r)}))})]}):null,R?(0,k.jsxs)(d.Stack,{pt:"$5",children:[(0,k.jsx)(DappSearchModalSectionHeader,{title:y.formatMessage({id:g.ETranslations.explore_history}),onMorePress:function(){W.current=!0,j.pushModal(f.ry.DiscoveryModal,{screen:f.v1.HistoryListModal})}}),B?.historyData.map((function(e,r){return(0,k.jsx)(c.c,{avatarProps:{src:e.logo,loading:w,fallbackProps:{bg:"$bgStrong",justifyContent:"center",alignItems:"center",children:(0,k.jsx)(d.Icon,{name:"GlobusOutline"})},borderWidth:l.A.hairlineWidth,borderColor:"$borderSubdued"},title:e.title,titleMatch:e.titleMatch,titleProps:{numberOfLines:1},subtitle:e.url,subTitleMatch:e.urlMatch,subtitleProps:{numberOfLines:1},testID:`search-modal-${e.title.toLowerCase()}`,onPress:function(){P({switchToMultiTabBrowser:A,navigation:j,useCurrentWindow:I,tabId:D,webSite:{url:e.url,title:e.title}}),m.U.discovery.dapp.enterDapp({dappDomain:e.url,dappName:e.title,enterMethod:x.z.historyInSearch})}},r)}))]}):null]})]})]})}))}}]);